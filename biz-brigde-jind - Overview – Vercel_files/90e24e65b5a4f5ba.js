;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="21b0c3e1-f01f-cb4f-b0eb-dd3debbbb987")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,8986490,(e,t,a)=>{var i=e.r(8762952);t.exports=function(e){return e&&e.length?i(e):[]}},3281894,e=>{"use strict";var t=e.i(1146226),a=e.i(8248823),i=e.i(5338940),n=e.i(4004502),r=e.i(2504781),s=e.i(8161149),l=e.i(2064047),o=e.i(8835183),d=e.i(8923565),u=e.i(5468328),c=e.i(2155064),m=e.i(6198010),v=e.i(2065543),g=e.i(8986490),h=e.i(747275),f=e.i(4274392),p=e.i(902715),b=e.i(57106),x=e.i(5169864),y=e.i(2405338),j=e.i(9722978),S=e.i(7639215),w=e.i(5384518),N=e.i(7589011),k=e.i(6625292),C=e.i(3748432),T=e.i(6373608),I=e.i(1913530),A=e.i(2447497),F=e.i(1154769),B=e.i(3696332),P=e.i(838562);let $=(0,I.createFuzzySearch)({keys:["slug","description"]});function O(e){let{flagDefinition:a,flagEnv:i}=e,n=function e(t,a){var i;let n=t.environments[a];if("boolean"!==t.kind)return"on";let r=t.variants.find(e=>!1===e.value);return n.active?n.reuse?.active?e(t,n.reuse.environment):n.rules.length>0||(i=n.targets)&&Object.values(i).some(e=>Object.values(e).some(e=>Object.values(e).some(e=>e.length>0)))?"on":"variant"===n.fallthrough.type&&n.fallthrough.variantId===r?.id?"off":"on":"variant"===n.pausedOutcome.type&&n.pausedOutcome.variantId===r?.id?"off":"on"}(a,i);return(0,t.jsx)("div",{className:(0,j.clsx)("rounded-full w-2.5 h-2.5","on"===n?"bg-geist-cyan":"bg-gray-200")})}function E(e){let{flag:i,outcomes:n}=e,r=n.flatMap(e=>{switch(e.type){case"variant":return i.variants.find(t=>t.id===e.variantId)??[];case"split":return(0,g.default)([e.defaultVariantId,...Object.keys(e.weights).filter(t=>e.weights[t]>0)]).flatMap(e=>i.variants.find(t=>t.id===e)??[]);default:{let{type:t}=e;(0,a.exhaustivenessCheck)(t)}}}),s=(0,h.default)(r,"id").map(e=>e.label?(0,S.safeJsonStringify)(e.label).replace(/^"(?<s>.+)"$/g,"$<s>"):(0,S.safeJsonStringify)(e.value)).join(", ");return s.length>32?(0,t.jsxs)(u.Tooltip,{as:"span",text:`Possible values: ${s}`,children:[s.slice(0,32),"…"]}):s}function V(e){let{flag:a,flagEnv:i}=e;if(!(i in a.environments))return null;let n=a.environments[i];return(n.active&&n.reuse?.active&&(n=a.environments[n.reuse.environment]),n.active)?(0,t.jsx)(E,{flag:a,outcomes:[n.fallthrough,...n.rules.map(e=>e.outcome)]}):(0,t.jsx)(E,{flag:a,outcomes:[n.pausedOutcome]})}function z(e){let{flagDefinition:a,flagEnv:i,deploymentFlagsUrl:r,params:s,deferredSearch:o,from:d}=e,u=d?`?from=${d}`:"";return(0,t.jsxs)(l.Entity,{className:"flex min-h-[60px] list-none justify-center px-4",children:[(0,t.jsx)("div",{className:"w-6 place-items-center",children:(0,t.jsx)(O,{flagDefinition:a,flagEnv:i})}),(0,t.jsx)(b.Link,{className:"text-decoration-none flex flex-auto font-mono text-black no-underline","data-testid":(0,n.tid)("vercel-flags","browse","flag",a.slug),href:`/${s.teamSlug}/${s.project}/flag/${a.slug}${u}`,children:(0,t.jsxs)("span",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{children:(0,t.jsx)(A.Highlight,{text:a.slug,searchQuery:o})}),"archived"===a.state?(0,t.jsx)(B.ReferencedArchivedBadge,{slug:a.slug,deploymentFlagsUrl:r}):(0,t.jsx)(F.UnreferencedBadge,{slug:a.slug,deploymentFlagsUrl:r})]})}),(0,t.jsx)("div",{className:"ml-4 grow justify-self-end truncate text-right font-mono text-sm text-gray-800 hidden md:block",children:(0,t.jsx)(V,{flag:a,flagEnv:i})}),(0,t.jsx)("div",{className:"ml-4 min-w-20 text-right hidden md:block",children:(0,t.jsx)(w.KindBadge,{kind:a.kind})}),(0,t.jsx)("div",{className:"flex items-center ml-2",children:(0,t.jsx)(N.CreatorAvatar,{uid:a.createdBy,name:a.metadata?.creator?.name,size:24,showUsername:!1,className:"text-xs"})})]})}function R(e){let{params:a,searchParams:g,deploymentFlagsUrl:h,state:j,initialFlagsResponse:S}=e,{team:w}=(0,i.useTeam)(),[N,I]=(0,f.useQueryState)("env",(0,p.parseAsArrayOf)(p.parseAsString).withOptions({history:"push"}).withDefault(["production"])),A=N[0],[F,B]=(0,x.useState)(g.search??""),{permissions:O,isLoading:E}=(0,P.useFlagsPermissions)(),[V,R]=(0,x.useState)(F);(0,x.useEffect)(()=>{(0,x.startTransition)(()=>{R(F)})},[F]),(0,x.useEffect)(()=>{(0,x.startTransition)(()=>{let e=new URL(location.href);V?e.searchParams.set("search",V):e.searchParams.delete("search"),history.replaceState(null,"",e.toString())})},[V]);let D=(0,k.getFlagListUrl)(a.project,{teamId:a.teamSlug,state:j}),{data:K}=(0,y.default)(D,k.getFlagList,{refreshInterval:7e3,fallbackData:S}),M=(0,x.useMemo)(()=>{if(K&&0===K.flags.length)return;let e=K?.flags;if(e)return e.sort((e,t)=>(t.updatedAt||t.createdAt||0)-(e.updatedAt||e.createdAt||0))},[K]),U=(0,x.useMemo)(()=>Array.isArray(M)?0===V.trim().length?M:$(V,M):M,[M,V]),L=!U?.length&&M?.length,[_,J]=(0,T.useCreateFlagForm)(a);return(0,t.jsxs)("div",{className:"mx-auto w-full",children:[(0,t.jsxs)("div",{className:"flex w-full items-center justify-between gap-4 flex-row",children:[(0,t.jsx)(o.SearchInput,{id:"flag-search",onChange:e=>B(e.target.value),placeholder:"Search flags…",value:F,width:"100%"}),(0,t.jsx)("div",{className:"hidden flex-1 items-center md:flex",children:(0,t.jsxs)(d.Switch,{className:"w-full",children:[(0,t.jsx)(d.Switch.Control,{checked:"production"===A,"data-testid":(0,n.tid)("vercel-flags","browse","env.switch","production"),label:"Production",onChange:()=>{I(["production"])},value:"production"}),(0,t.jsx)(d.Switch.Control,{checked:"preview"===A,"data-testid":(0,n.tid)("vercel-flags","browse","env.switch","preview"),label:"Preview",onChange:()=>{I(["preview"])},value:"preview"}),(0,t.jsx)(d.Switch.Control,{checked:"development"===A,"data-testid":(0,n.tid)("vercel-flags","browse","env.switch","development"),label:"Development",onChange:()=>{I(["development"])},value:"development"})]})}),"active"===j?(0,t.jsx)(u.Tooltip,{disableTriggers:O.create,text:"You need additional permissions to create a flag.",children:(0,t.jsx)(r.Button,{"data-testid":(0,n.tid)("vercel-flags","create-form","trigger"),disabled:!w||!O.create||E,onClick:()=>_(),prefix:(0,t.jsx)(m.Plus,{}),type:"default",typeName:"button",children:"Create Flag"})}):null,J]}),(0,t.jsx)("div",{className:"mt-4 bg-white sm:rounded-md",children:U?(0,t.jsx)(l.Entity.List,{className:"shadow-border",children:U?.map((e,i)=>(0,t.jsx)(C.ConditionalNavigationMarker,{label:"FlagList",phase:"content",enabled:0===i,children:(0,t.jsx)(z,{flagDefinition:e,flagEnv:A,deploymentFlagsUrl:h,params:a,deferredSearch:V,from:e.state})},e.slug))??null},"list"):(0,t.jsx)(s.EmptyState.Root,{description:"archived"===j?"You have not archived any flags yet":(0,t.jsxs)("p",{children:["Create a feature flag or"," ",(0,t.jsx)(b.Link,{variant:"highlight",href:`/${a.teamSlug}/${a.project}/flags/onboarding`,children:"learn more"})," ","about how to get started with Vercel Flags"]}),icon:(0,t.jsx)(s.EmptyState.Icon,{icon:"archived"===j?(0,t.jsx)(c.Archive,{size:32}):(0,t.jsx)(v.ToggleOnAlt,{size:32})}),title:"archived"===j?"Archived Flags":"Flags"},"empty")}),L?(0,t.jsxs)("div",{className:"mt-5 rounded-md text-center",children:[(0,t.jsx)("span",{className:"text-copy-14 text-gray-700",children:"No results found for"})," ",'"',V,'"']}):null]})}e.s(["FlagList",()=>R,"FlagListItem",()=>z])},7639215,e=>{"use strict";function t(e,t,a){let i=JSON.stringify(e,t,a);return"string"==typeof i?i.replace(/</g,"\\u003c"):i}e.s(["safeJsonStringify",()=>t])},7589011,e=>{"use strict";var t=e.i(1146226),a=e.i(4585051),i=e.i(5468328);function n(e){let{uid:n,name:r,size:s=24,showUsername:l=!1,className:o}=e;if(!n)return null;let d=(0,t.jsx)(a.Avatar,{size:s,uid:n,title:r});return l&&r?(0,t.jsxs)("div",{className:`flex items-center gap-1 ${o||""}`,children:[d,l&&r&&(0,t.jsx)("span",{className:"text-gray-700 truncate max-w-[120px]",children:r})]}):(0,t.jsx)("div",{className:`flex ${o||""}`,children:r||r?(0,t.jsx)(i.Tooltip,{text:r||r,children:d}):d})}e.s(["CreatorAvatar",()=>n])},5384518,e=>{"use strict";var t=e.i(1146226),a=e.i(3306538);function i(e){let{kind:i}=e;return(0,t.jsx)(a.Badge,{variant:{string:"green-subtle",boolean:"blue-subtle",number:"purple-subtle"}[i],children:i.toUpperCase()})}e.s(["KindBadge",()=>i])},7870950,e=>{"use strict";var t=e.i(5169864),a=e.i(2405338),i=e.i(6625292);function n(e){let{data:n,...r}=(0,a.default)(e,i.getFlagsForDeployment,{refreshInterval:12e4,keepPreviousData:!0});return{data:(0,t.useMemo)(()=>new Map(n?.flags?.map(e=>[e.slug,e])),[n]),...r}}e.s(["useDeploymentFlags",()=>n])},1154769,e=>{"use strict";var t=e.i(1146226),a=e.i(3306538),i=e.i(5468328),n=e.i(7870950);function r(e){let{slug:r,deploymentFlagsUrl:s,className:l}=e,{data:o,error:d}=(0,n.useDeploymentFlags)(s);return o.has(r)||d||null===s?null:(0,t.jsx)(i.Tooltip,{className:l,text:"This feature flag is not referenced by your latest production deployment.",children:(0,t.jsx)(a.Badge,{className:"uppercase hidden sm:block",variant:"amber-subtle",children:"Unreferenced"})})}e.s(["UnreferencedBadge",()=>r])},3696332,e=>{"use strict";var t=e.i(1146226),a=e.i(3306538),i=e.i(5468328),n=e.i(7870950);function r(e){let{slug:r,deploymentFlagsUrl:s,className:l}=e,{data:o,error:d}=(0,n.useDeploymentFlags)(s);return!o.has(r)||d||null===s?null:(0,t.jsx)(i.Tooltip,{className:l,text:"This archived feature flag is still referenced by your latest production deployment.",children:(0,t.jsx)(a.Badge,{className:"uppercase hidden sm:block",variant:"red-subtle",children:"Referenced"})})}e.s(["ReferencedArchivedBadge",()=>r])},9385057,e=>{"use strict";let t=e=>crypto.getRandomValues(new Uint8Array(e)),a=function(e){let a,i,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:21;return i=-~(1.6*(a=(2<<Math.log(e.length-1)/Math.LN2)-1)*n/e.length),function(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n,s="";for(;;){let n=t(i),l=i;for(;l--;)if((s+=e[n[l]&a]||"").length===r)return s}}},i=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:21;return crypto.getRandomValues(new Uint8Array(e)).reduce((e,t)=>((t&=63)<36?e+=t.toString(36):t<62?e+=(t-26).toString(36).toUpperCase():t>62?e+="-":e+="_",e),"")};e.s(["customAlphabet",()=>a,"nanoid",()=>i],9385057)},838562,e=>{"use strict";var t=e.i(1717203),a=e.i(7557283);function i(e,i){let{can:n,isLoading:r}=(0,t.default)(e,i);return{permissions:{read:n(a.Action.Read,a.Resource.ProjectFlags),create:n(a.Action.Create,a.Resource.ProjectFlags),remove:n(a.Action.Delete,a.Resource.ProjectFlags),update:n(a.Action.Update,a.Resource.ProjectFlags)},isLoading:r}}e.s(["useFlagsPermissions",()=>i])},6689108,e=>{"use strict";var t=e.i(1146226),a=e.i(3306538),i=e.i(9722978);let n={production:{dot:"bg-blue-700",badge:"blue-subtle",label:"Production"},preview:{dot:"bg-purple-700",badge:"purple-subtle",label:"Preview"},development:{dot:"bg-amber-700",badge:"amber-subtle",label:"Development"}};function r(e){let{environment:a,className:r}=e,s=a in n?n[a]:{dot:"bg-gray-600"};return(0,t.jsx)("div",{className:(0,i.default)("size-2.5 rounded-full",s.dot,r)})}function s(e){let{environment:r,size:s="sm",className:l}=e,o=r in n?n[r].badge:"gray-subtle";return(0,t.jsx)(a.Badge,{size:s,variant:o,className:(0,i.default)("text-xs",l),children:r})}e.s(["EnvironmentBadge",()=>s,"EnvironmentDot",()=>r])},6625292,e=>{"use strict";var t=e.i(9171423),a=e.i(7629563),i=e.i(8042625),n=e.i(4244280),r=e.i(134877);function s(e){let{teamId:t,state:a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(0,i.encode)({teamId:t,state:a,withMetadata:!0});return`${(0,n.API_PROJECTS_VERSION)("v1")}/${e}/feature-flags/flags${r}`}async function l(e){try{return{flags:(await (0,t.fetchApi)(e,{throwOnHTTPError:!0,contentType:"json"})).data}}catch(e){throw(0,a.isInternalNextError)(e),e}}async function o(e){try{return await (0,t.fetchApi)(e,{throwOnHTTPError:!0,contentType:"json"})}catch(e){if((0,a.isInternalNextError)(e))throw e;if((0,r.isAPIError)(e)&&404===e.status)return;throw e}}async function d(e,a){let r=(0,i.encode)({teamId:e.teamSlug}),s=`${(0,n.API_PROJECTS_VERSION)("v1")}/${e.project}/feature-flags/settings${r}`;return(0,t.fetchApi)(s,{method:"PATCH",throwOnHTTPError:!0,headers:{"Content-Type":"application/json"},body:JSON.stringify(a),contentType:"json"})}async function u(e){return(0,t.fetchApi)(e,{throwOnHTTPError:!0,contentType:"json"})}e.s(["getFlagList",()=>l,"getFlagListUrl",()=>s,"getFlagsForDeployment",()=>o,"query",()=>u,"submitSettingsUpdate",()=>d])},6373608,e=>{"use strict";var t=e.i(1146226),a=e.i(5169864),i=e.i(4004502),n=e.i(8042625),r=e.i(277234),s=e.i(4244280),l=e.i(8128646),o=e.i(2969499);e.i(3512434);var d=e.i(9835407),u=e.i(6689108),c=e.i(3500331),m=e.i(9334091),v=e.i(8923565),g=e.i(5323212),h=e.i(1906681),f=e.i(4030453),p=e.i(455575),b=e.i(2504781),x=e.i(5468328),y=e.i(5806401),j=e.i(5610834),S=e.i(7722264),w=e.i(9385057),N=e.i(7957251),k=e.i(5883567),C=e.i(838562),T=e.i(409142),I=e.i(5338940);let A=d.z.object({key:d.z.string().min(1,"Key is required").regex(/^[a-zA-Z0-9_-]+$/,"Key may contain alphanumeric characters, _ and - only"),description:d.z.string().optional().default(""),options:d.z.array(d.z.object({label:d.z.string().optional(),value:d.z.union([d.z.string(),d.z.number(),d.z.boolean()]).refine(e=>"string"!=typeof e||e.trim().length>0,{message:"Value cannot be empty"})})).min(1,"At least one option is required").optional(),defaultValue:d.z.union([d.z.string(),d.z.number(),d.z.boolean()]).optional()});function F(e,t){let a=e.touched.has(t),i=e.errors.get(t);return e.submitAttempted||a?i:void 0}function B(e){return e.variantsByKind[e.kind]}function P(e){return e.environmentsByKind[e.kind]}function $(e,t){return Object.values(P(t)).some(t=>t.selectedVariantId===e)}function O(e){let t=new Map;return 0===e.slug.trim().length?t.set("slug",{message:"Missing value"}):/^[a-zA-Z0-9_-]+$/.test(e.slug.trim())||t.set("slug",{message:"Key may contain alphanumeric characters, _ and - only"}),e.kind||t.set("kind",{message:"Missing kind"}),B(e).forEach((a,i)=>{"boolean"!==e.kind&&("string"===e.kind?("string"!=typeof a.value||""===a.value.trim())&&t.set(`variants.${i}.value`,{message:"Value is required"}):"number"===e.kind&&("number"!=typeof a.value||Number.isNaN(a.value))&&t.set(`variants.${i}.value`,{message:"Valid number is required"}))}),t}function E(e){let{open:d,setOpen:T,team:I,params:E,data:V,onSuccess:z}=e;(0,a.useEffect)(()=>(0,l.enableMapSet)(),[]);let R=(0,p.useToasts)(),D=(0,j.useRouter)(),K=(0,j.useSearchParams)(),M=(0,a.useRef)(null),{permissions:U,isLoading:L}=(0,C.useFlagsPermissions)(),_=(0,a.useRef)({slug:null,description:null}),J=(0,a.useMemo)(()=>({slug:"",kind:"boolean",description:"",variantsByKind:{boolean:[{id:"var0",label:"Off",description:"not enabled",value:!1},{id:"var1",label:"On",description:"enabled",value:!0}],string:[{id:"str0",label:"",description:"",value:""},{id:"str1",label:"",description:"",value:""}],number:[{id:"num0",label:"",description:"",value:0},{id:"num1",label:"",description:"",value:1}]},environmentsByKind:{boolean:{development:{selectedVariantId:"var1"},preview:{selectedVariantId:"var0"},production:{selectedVariantId:"var0"}},string:{development:{selectedVariantId:"str0"},preview:{selectedVariantId:"str0"},production:{selectedVariantId:"str0"}},number:{development:{selectedVariantId:"num0"},preview:{selectedVariantId:"num0"},production:{selectedVariantId:"num0"}}}}),[]),H=(0,a.useMemo)(()=>{if(V){if("1"===V)return J;try{let e=JSON.parse(V),t=A.safeParse(e);if(!t.success)return console.warn("Invalid create param format:",t.error),J;let a=t.data,i=!a.options||0===a.options.length||a.options.every(e=>"boolean"==typeof e.value)?"boolean":a.options.every(e=>"string"==typeof e.value)?"string":a.options.every(e=>"number"==typeof e.value)?"number":"boolean",n={...J};if(a.options&&a.options.length>0){let e=a.options.map((e,t)=>({id:`var${t}`,label:e.label,description:"",value:e.value}));n.variantsByKind[i]=e;let t=e[0]?.id||n.variantsByKind[i][0]?.id;n.environmentsByKind[i]={development:{selectedVariantId:t},preview:{selectedVariantId:t},production:{selectedVariantId:t}}}return{...n,slug:a.key,kind:i,description:a.description}}catch(e){console.warn("Failed to parse create param:",e)}}return J},[V,J]),[q,Y]=(0,a.useState)({isDisabled:!1,isSubmitting:!1,submitAttempted:!1,values:H,errors:new Map,touched:new Set}),Q=(0,a.useMemo)(()=>{let e=e=>{Y(t=>{let a=(0,l.produce)(t,e);return{...a,errors:O(a.values)}})};return{formState:q,setFormState:Y,adjust:e,refs:_,handleChange:t=>{t.target.name&&e(e=>{(0,o.set)(e.values,t.target.name,t.target.value)})},handleBlur:t=>{t.target.name&&q.submitAttempted&&e(e=>{e.touched.add(t.target.name)})},handleRef:e=>{if(!e)return;let t="name"in e?e.name:e.dataset.name;t&&(_.current[t]=e)}}},[q]),{adjust:Z}=Q;(0,a.useEffect)(()=>{if(d&&M.current){let e=setTimeout(()=>{M.current?.focus()},100);return()=>clearTimeout(e)}},[d]);let G=(0,a.useCallback)(()=>{T(!1)},[T]),W=async e=>{e.preventDefault();let t=q.values,a=B(t);Z(e=>{e.submitAttempted=!0});let i=e=>{let a=P(t)[e].selectedVariantId;return{revision:0,active:!1,pausedOutcome:{type:"variant",variantId:a},fallthrough:{type:"variant",variantId:a},rules:[],reuse:{active:!1,environment:""}}},l={slug:t.slug.trim(),kind:t.kind,description:t.description,variants:a,environments:{production:i("production"),preview:i("preview"),development:i("development")}},o=O(t);if(o.size>0)return void Z(e=>{e.errors=o});Z(e=>{e.isSubmitting=!0,e.isDisabled=!0});try{await (0,r.fetchAPI)(`${(0,s.API_PROJECTS_VERSION)("v1")}/${E.project}/feature-flags/flags${(0,n.encode)({teamId:I?.id})}`,{method:"PUT",throwOnHTTPError:!0,body:l}),R.success("Flag created"),z?.(),T(!1);let e=new URLSearchParams,a=K?.get("env");a&&e.set("env",a),D.push(`/${E.teamSlug}/${E.project}/flag/${t.slug.trim()}?${e.toString()}`)}catch(e){if((0,S.isError)(e)){if(Z(e=>{e.isSubmitting=!1,e.isDisabled=!1}),e.message.includes("Flag already exists"))return void R.error("Could not save flag — Name is in use by an active or archived flag.");R.error(e.message);return}throw e}},X=(0,a.useMemo)(()=>q.values.variantsByKind[q.values.kind].every(e=>{if(e.label&&e.label.trim().length>0)return!0;switch(q.values.kind){case"boolean":return"boolean"==typeof e.value;case"string":return"string"==typeof e.value&&e.value.trim().length>0;case"number":return"number"==typeof e.value&&!Number.isNaN(e.value)}return!1}),[q.values]);return(0,t.jsxs)(y.Sheet,{open:d,onOpenChange:T,modal:!0,children:[(0,t.jsx)(y.SheetOverlay,{}),(0,t.jsx)(y.SheetContent,{side:"right",noOverlay:!0,className:"m-3 h-[calc(100%-1.5rem)] w-[calc(100%-1.5rem)] rounded-[1rem] bg-white p-0 lg:w-[512px] sm:max-w-[auto] flex flex-col",children:(0,t.jsxs)("div",{className:"h-full flex flex-col",children:[(0,t.jsxs)(y.SheetHeader,{className:"p-6 border-b flex-shrink-0",children:[(0,t.jsx)("div",{className:"flex items-center justify-between",children:(0,t.jsx)(y.SheetTitle,{children:"Create Feature Flag"})}),(0,t.jsx)(y.SheetDescription,{children:"Enter the details of your new feature flag."})]}),(0,t.jsx)("div",{className:"flex flex-col h-full flex-auto overflow-y-scroll",children:(0,t.jsx)("form",{id:(0,i.tid)("vercel-flags","create-form","form"),"data-testid":(0,i.tid)("vercel-flags","create-form","form"),onSubmit:W,className:"flex flex-col h-full",children:(0,t.jsx)("div",{className:"flex-1 overflow-y-auto p-6",children:(0,t.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,t.jsx)(c.Input,{"aria-labelledby":"Slug","data-testid":(0,i.tid)("vercel-flags","create-form","slug"),disabled:q.isSubmitting,label:"Slug",name:"slug",value:q.values.slug,onChange:Q.handleChange,onBlur:Q.handleBlur,ref:e=>{M.current=e,Q.handleRef(e)},error:F(q,"slug"),placeholder:"my-flag"}),(0,t.jsx)(m.Textarea,{"aria-labelledby":"Description","data-testid":(0,i.tid)("vercel-flags","create-form","description"),disabled:q.isSubmitting,label:"Description",name:"description",value:q.values.description,onChange:Q.handleChange,onBlur:Q.handleBlur,ref:Q.handleRef,placeholder:"Describe what this feature flag controls…",rows:3}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-label-13 text-gray-900",children:"Type"}),(0,t.jsx)("div",{className:"mt-2",children:(0,t.jsxs)(v.Switch,{name:"kind",children:[(0,t.jsx)(v.Switch.Control,{checked:"boolean"===q.values.kind,disabled:q.isSubmitting,label:"Boolean",value:"boolean",onChange:()=>{Z(e=>{e.values.kind="boolean"})}}),(0,t.jsx)(v.Switch.Control,{checked:"string"===q.values.kind,disabled:q.isSubmitting,label:"String",value:"string",onChange:()=>{Z(e=>{e.values.kind="string"})}}),(0,t.jsx)(v.Switch.Control,{checked:"number"===q.values.kind,disabled:q.isSubmitting,label:"Number",value:"number",onChange:()=>{Z(e=>{e.values.kind="number"})}})]})}),F(q,"kind")?(0,t.jsx)(f.Error,{className:"mt-2",children:F(q,"kind")?.message}):null]}),q.values.kind&&"boolean"!==q.values.kind&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-label-13 text-gray-900",children:"Variants"}),(0,t.jsx)("div",{className:"mt-3 space-y-3",children:B(q.values)?.map((e,a)=>(0,t.jsxs)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4 hover:border-gray-300 transition-colors",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:`variant-${e.id}-name`,className:"block text-xs font-medium text-gray-700 mb-1",children:"Name"}),(0,t.jsx)(c.Input,{id:`variant-${e.id}-name`,value:e.label??"",onChange:e=>{Z(t=>{t.values.variantsByKind[q.values.kind][a].label=e.target.value})},disabled:q.isSubmitting,error:F(q,`variants.${a}.label`)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:`variant-${e.id}-value`,className:"block text-xs font-medium text-gray-700 mb-1",children:"Value"}),(0,t.jsx)(c.Input,{id:`variant-${e.id}-value`,value:String(e.value),onChange:e=>{Z(t=>{t.values.variantsByKind[q.values.kind][a].value="number"===q.values.kind?Number.parseFloat(e.target.value)||0:e.target.value})},disabled:q.isSubmitting,typeName:"number"===q.values.kind?"number":"text",error:F(q,`variants.${a}.value`)})]})]}),B(q.values).length>2&&(0,t.jsx)("div",{className:"flex items-start justify-end mt-3",children:(0,t.jsx)(x.Tooltip,{text:!q.isSubmitting&&$(e.id,q.values)?"This variant can not be deleted as it is selected as an outcome for one of the environments":void 0,children:(0,t.jsx)(b.Button,{"aria-label":`Remove variant ${a+1}`,size:"small",type:"tertiary",disabled:q.isSubmitting||$(e.id,q.values),onClick:()=>{Z(e=>{e.values.variantsByKind[q.values.kind].splice(a,1)})},prefix:(0,t.jsx)(N.MinusCircle,{}),children:"Remove variant"})})})]},e.id))}),(0,t.jsx)(b.Button,{type:"tertiary",onClick:()=>{Z(e=>{e.values.variantsByKind[q.values.kind].push({id:(0,w.nanoid)(),label:"",description:"",value:"number"===q.values.kind?0:""})})},disabled:q.isSubmitting,typeName:"button",className:"mt-2",prefix:(0,t.jsx)(k.PlusCircle,{}),size:"small",children:"Add variant"})]}),B(q.values)&&B(q.values).length>0&&(0,t.jsxs)("div",{className:"pt-4 border-t border-gray-200",children:[(0,t.jsx)("p",{className:"text-label-13 text-gray-900",children:"Environments"}),X?(0,t.jsx)("div",{className:"mt-4 space-y-8",children:["production","preview","development"].map((e,a)=>{let i=P(q.values),n=i[e]?.selectedVariantId,r=B(q.values),s=r.reduce((e,t)=>e+(t.label||String(t.value)).length,0),l="boolean"!==q.values.kind&&s>24||r.length>8;return(0,t.jsxs)("div",{children:[a>0&&"boolean"===q.values.kind&&(0,t.jsx)("div",{className:"border-t border-gray-100 -mt-4 mb-6"}),"boolean"===q.values.kind?null:(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,t.jsx)(u.EnvironmentDot,{environment:e}),(0,t.jsx)("p",{className:"text-copy-14 font-medium capitalize",children:e})]}),"boolean"===q.values.kind?(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(u.EnvironmentDot,{environment:e}),(0,t.jsx)("p",{className:"text-copy-14 font-medium capitalize",children:e})]}),(0,t.jsx)(h.Toggle,{size:"medium",checked:n===r.find(e=>!0===e.value)?.id,disabled:q.isSubmitting,onChange:t=>{let a=t?r.find(e=>!0===e.value)?.id:r.find(e=>!1===e.value)?.id;a&&Z(t=>{t.values.environmentsByKind[q.values.kind][e].selectedVariantId=a})},children:n===r.find(e=>!0===e.value)?.id?"On":"Off"})]}):l?(0,t.jsx)(g.Select,{value:n,onChange:t=>{Z(a=>{a.values.environmentsByKind[q.values.kind][e].selectedVariantId=t.target.value})},disabled:q.isSubmitting,children:r.map(e=>(0,t.jsx)("option",{value:e.id,children:e.label||String(e.value)},e.id))}):(0,t.jsx)(v.Switch,{name:`environment-${e}`,children:r.map(a=>(0,t.jsx)(v.Switch.Control,{checked:n===a.id,disabled:q.isSubmitting,label:a.label||String(a.value),value:a.id,onChange:()=>{Z(t=>{t.values.environmentsByKind[q.values.kind][e].selectedVariantId=a.id})}},a.id))})]},e)})}):(0,t.jsx)("div",{className:"mt-2 text-gray-800 text-sm",children:"Configure variants above before configuring environments"})]})]})})})}),(0,t.jsx)(y.SheetFooter,{className:"flex-shrink-0 px-6 py-4 border-t border-gray-200",children:(0,t.jsxs)("div",{className:"flex gap-3 justify-end",children:[(0,t.jsx)(b.Button,{"data-testid":(0,i.tid)("vercel-flags","create-form","cancel"),disabled:q.isSubmitting,onClick:G,type:"secondary",children:"Cancel"}),(0,t.jsx)(x.Tooltip,{disableTriggers:U.create,text:"You need additional permissions to create a flag.",children:(0,t.jsx)(b.Button,{"data-testid":(0,i.tid)("vercel-flags","create-form","submit"),disabled:!U.create||L||q.isSubmitting,loading:q.isSubmitting,typeName:"submit",form:(0,i.tid)("vercel-flags","create-form","form"),children:"Create"})})]})})]})})]})}let V={create:{defaultValue:void 0}};e.s(["useCreateFlagForm",0,e=>{let{team:i}=(0,I.useTeam)(),{set:n,state:r}=(0,T.useSearchParamsState)(V),s=(0,a.useCallback)(e=>{let t=e?JSON.stringify({key:e.slug,description:e.description,options:e.options,defaultValue:e.defaultValue}):"1";(0,a.startTransition)(()=>{n({create:t})})},[n]),l=function(e){let t=e||void 0,[i,n]=(0,a.useState)(t);return t!==i&&t&&n(t),i}(r.create);return[s,(0,t.jsx)(E,{open:!!r.create,data:l,params:e,setOpen:e=>{e||(0,a.startTransition)(()=>{n({create:void 0})})},team:i??void 0,onSuccess:e.onSuccess},l)]}])}]);

//# debugId=21b0c3e1-f01f-cb4f-b0eb-dd3debbbb987
//# sourceMappingURL=d44f55f397bc5d22.js.map