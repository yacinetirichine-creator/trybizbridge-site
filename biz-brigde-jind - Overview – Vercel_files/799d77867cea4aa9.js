;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="7fa05f27-9af4-2de7-10ea-3cd6c80c13c9")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,1303150,e=>{"use strict";var t=e.i(1146226),s=e.i(5169864),n=e.i(9722978),l=e.i(57106),a=e.i(119294),r=e.i(6352514),i=e.i(1681029),o=e.i(4478191),d=e.i(8518548),u=e.i(6613731),c=e.i(5338940),m=e.i(6656921),h=e.i(1895466),p=e.i(2504781),g=e.i(5838627),x=e.i(9334091),y=e.i(5468328),f=e.i(5323212),j=e.i(3500331),b=e.i(4237893);function v(e){let{deployment:s,teamId:n}=e,{method:l,setMethod:a,pathname:r,setPathname:i,microViewTab:o,setMicroViewTab:d,requestTab:u,setRequestTab:c,responseTab:v,setResponseTab:C,requestBody:N,setRequestBody:k,responseHar:w,sendRequest:I,urlBase:E,requestHeaders:S,responseHeaders:B}=(0,m.useRequestBuilder)({deploymentId:s.id,deploymentUrl:`https://${s.url}`,teamId:n}),R=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(b.Tabs,{tabs:(0,h.makeTabs)(h.requestTabs),selected:u,setSelected:c,variant:"secondary",className:"my-1 shrink-0"}),"Body"===u?(0,t.jsx)(x.Textarea,{style:{fieldSizing:"content"},className:"flex grow font-mono h-full overflow-y-auto",value:N,onChange:e=>k(e.target.value)}):null,"Params"===u?(0,t.jsx)("div",{className:"text-muted-foreground p-4",children:"not yet implemented"}):null,"Headers"===u?(0,t.jsx)("div",{className:"text-muted-foreground p-4",children:(0,t.jsx)(g.CodeBlock,{className:"m-0 p-0",language:"json",hideLineNumbers:!0,children:JSON.stringify(S.reduce((e,t)=>{let{name:s,value:n}=t;return{...e,[s]:n}},{}),null,2)})}):null,"Snippets"===u?(0,t.jsx)("div",{className:"text-muted-foreground p-4",children:"not yet implemented"}):null]}),L=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(b.Tabs,{tabs:(0,h.makeTabs)(h.responseTabs),selected:v,setSelected:C,variant:"secondary",className:"my-1 shrink-0"}),(0,t.jsxs)("div",{className:"overflow-y-scroll",children:["Body"===v?(0,t.jsx)(g.CodeBlock,{className:"m-0 p-0",language:"json",hideLineNumbers:!0,children:JSON.stringify(w,null,2)}):null,"Headers"===v?(0,t.jsx)("div",{className:"text-muted-foreground p-4",children:(0,t.jsx)(g.CodeBlock,{className:"m-0 p-0",language:"json",hideLineNumbers:!0,children:JSON.stringify(B.reduce((e,t)=>{let{name:s,value:n}=t;return{...e,[s]:n}},{}),null,2)})}):null]})]});return(0,t.jsxs)("div",{className:"flex flex-col gap-1 w-full",children:[(0,t.jsxs)("div",{className:"flex flex-row",style:{borderBottom:"1px solid var(--ds-gray-400)"},children:[(0,t.jsx)(f.Select,{selectClassName:"px-2 w-[54px] rounded-none shadow-none",value:l,onChange:e=>a(e.target.value),size:"small",suffix:null,style:{borderRight:"1px solid var(--ds-gray-400)"},children:h.methods.map(e=>(0,t.jsx)("option",{value:e,children:e},e))}),(0,t.jsx)(j.Input,{"aria-label":"request builder",innerWrapperClassName:"w-full rounded-none shadow-none border-l-1",prefix:(0,t.jsx)(y.Tooltip,{text:`The request will be sent with the base path: ${E}`,children:"/"}),value:r,onChange:e=>{i(e.target.value)},size:"small"}),(0,t.jsx)(y.Tooltip,{text:"Send Request",children:(0,t.jsx)(p.Button,{style:{borderRadius:0},size:"small",onClick:I,children:"Send"})})]}),(0,t.jsxs)("div",{className:"px-3",children:[(0,t.jsx)(b.Tabs,{className:"shrink-0",tabs:(0,h.makeTabs)(h.microViewTabs),selected:o,setSelected:d,tabClassName:"py-2"}),(0,t.jsxs)("div",{className:"flex flex-col gap-1 mt-1 max-h-full",children:["Request"===o?R:null,"Response"===o?L:null]})]})]})}var C=e.i(7087273),N=e.i(9318197),k=e.i(4450569);let w=e=>{let{title:s,message:n,link:a,action:r="Learn More",onDismiss:i}=e;return(0,t.jsxs)(k.default,{style:{padding:"var(--geist-gap)",width:"100%",height:"100%",position:"absolute"},children:[(0,t.jsx)("span",{className:"text-copy-16",children:s}),(0,t.jsx)(N.Spacer,{y:1/3}),(0,t.jsx)(k.default,{className:"min-h-0 break-words",children:(0,t.jsx)(C.Scroller,{children:(0,t.jsx)("p",{className:"text-copy-16 m-0",children:n})})}),(0,t.jsx)(N.Spacer,{y:2/3}),(0,t.jsxs)(k.default,{row:!0,style:{justifyContent:"center",alignItems:"flex-end"},children:[(0,t.jsx)(p.Button,{onClick:i,size:"small",style:{flex:"1"},type:"secondary",children:"Dismiss"}),a?(0,t.jsx)(N.Spacer,{x:.5}):null,a?(0,t.jsx)(l.ButtonLink,{href:a,size:"small",style:{flex:"1"},children:r}):null]})]})};var I=e.i(6159310);let E=["https://vercel.com/","https://zeit.ink/","https://vercel.link/","https://err.sh/","https://github.com/zeit/","https://github.com/vercel/"];var S=e.i(762945),B=e.i(6226725),R=e.i(2425341);let L=e=>{let{title:s,status:n,link:l,actionButton:a,buttonText:r,message:i}=e,o="https://vercel.link/CVE-2025-66478"===l;return(0,t.jsxs)("div",{className:"w-full",children:[(0,t.jsx)("div",{className:"border-b border-solid border-gray-alpha-400 w-full p-3",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:["ERROR"===n?(0,t.jsx)("span",{className:"text-[var(--geist-error-light)]",children:(0,t.jsx)(S.Warning,{})}):null,"CANCELED"===n?(0,t.jsx)(B.CrossCircle,{color:"gray-900"}):null,"QUEUED"===n?(0,t.jsx)(R.Stopwatch,{color:"gray-900"}):null,(0,t.jsx)("h3",{className:"text-label-14 text-gray-1000 font-medium",children:s})]})}),(0,t.jsxs)("div",{className:"p-3 flex flex-col h-[calc(100%-45px)]",children:[(0,t.jsx)(C.Scroller,{children:(0,t.jsx)("p",{className:"text-copy-14 text-gray-900",children:i||"Your deployment has failed to build successfully. Please check out the logs for more details."})}),(0,t.jsx)("div",{className:"mt-auto",children:o&&l?(0,t.jsxs)("div",{className:"flex flex-row gap-2 *:flex-1",children:[(0,t.jsx)(D,{buttonText:r,link:l,status:n}),(0,t.jsx)(I.DashboardButtonLink,{route:"/[teamSlug]/[project]/fix/[fixType]",params:{fixType:"react2shell"},size:"small",children:"Upgrade"})]}):l||a?(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("div",{className:"flex flex-col gap-y-2",children:[l?(0,t.jsx)(D,{buttonText:r,link:l,status:n}):(0,t.jsx)(N.Spacer,{y:1/6}),a?(0,t.jsx)(t.Fragment,{children:a}):null]})}):null})]})]})},D=e=>{let{status:s,link:n,buttonText:a}=e;return"string"==typeof n&&E.some(e=>n.startsWith(e))?(0,t.jsx)(l.ButtonLink,{href:n,size:"small",type:"secondary",children:"Learn More"}):"QUEUED"===s&&n?(0,t.jsx)(l.ButtonLink,{href:n,size:"small",children:a||"Add Concurrent Builds"}):(0,t.jsx)(p.Button,{passthroughOnClick:e=>{e.preventDefault();let t=document.querySelector("[data-status=error]");t&&(t?.dataset.state!=="open"&&t.querySelector("button")?.click(),t.scrollIntoView({behavior:"smooth"}))},type:"secondary",children:"View Logs"})};var T=e.i(2957938),U=e.i(5255926),A=e.i(5610834),M=e.i(6280036),O=e.i(6677848),_=e.i(4597921);function P(e,t){switch(t.type){case"LIGHT_IMAGE_LOADING":return{...e,lightImage:"pending"};case"LIGHT_IMAGE_SUCCESS":return{...e,lightImage:"success"};case"LIGHT_IMAGE_FAILURE":return{...e,lightImage:"failure"};case"DARK_IMAGE_LOADING":return{...e,darkImage:"pending"};case"DARK_IMAGE_SUCCESS":return{...e,darkImage:"success"};case"DARK_IMAGE_FAILURE":return{...e,darkImage:"failure"};default:return e}}let F={lightImage:"pending",darkImage:"pending"};function $(e,t,s,n,l){let a=new URL(l?"/api/screenshot/v2":"/api/screenshot","production"!==T.default.env.VERCEL_ENV&&T.default.env.VERCEL_URL?`https://${T.default.env.VERCEL_URL}`:"https://vercel.com");return t?(a.searchParams.set("dark","dark"===e?"1":"0"),a.searchParams.set("deploymentId",t),s&&a.searchParams.set("teamId",s),n&&a.searchParams.set("withStatus","1"),`${a.pathname}${a.search}`):""}function z(e){let{srcLight:s,srcDark:n,onLoad:l,onError:a,alt:r}=e;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Q,{alt:r,className:"absolute block size-full dark:hidden",onError:()=>a("light"),onLoad:()=>l("light"),src:s}),(0,t.jsx)(Q,{alt:r,className:"absolute hidden size-full dark:block",onError:()=>a("dark"),onLoad:()=>l("dark"),src:n})]})}function Q(e){let{src:l,onLoad:a,renderScale:r=3,onError:i,className:o,alt:d}=e,u=(0,s.useRef)(null),c=(0,s.useRef)(null),[m,h]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{let e=u.current;if(!e)return;c.current||(c.current=new Image);let t=c.current,s=()=>{let s=e.getContext("2d");if(!s)return;let n=e.offsetWidth,l=e.offsetHeight,a=n*r,i=l*r;e.width=a,e.height=i,s.scale(r,r),s.clearRect(0,0,a,i);let o=Math.min(n/t.width,l/t.height),d=n/2-t.width/2*o;s.drawImage(t,d,0,t.width*o,t.height*o)};if(t.src===l)return;t.src=l,t.onload=()=>{a(),h(!0),s()},t.onerror=()=>{i()};let n=()=>{s()};return window.addEventListener("resize",n),n(),()=>{window.removeEventListener("resize",n)}},[l,r]),(0,t.jsx)("canvas",{"aria-hidden":"true","aria-label":d,className:(0,n.clsx)(o,"size-full",{"animate-blurIn":m}),ref:u,role:"img",style:{width:"100%",height:"100%"}})}let G=s.default.memo(e=>{let{deployment:l,placeholder:a,noBorderRadius:r=!1,withReachable:i=!1,withImageWrapper:o=!0,onReady:d,height:u=400,width:c=640,onScreenshotFailed:m=()=>null}=e,h="string"==typeof l?.url?l.url:"",p="string"==typeof l?.id?l.id:void 0,g=c?{"--width":(0,O.px)(c)}:{},{teamSlug:x=""}=(0,A.useParams)()??{},y=(0,_.useServerFlag)("enable-screenshot-v2",!1),f=(0,s.useMemo)(()=>$("dark",p,x,i,y),[p,x,i,y]),j=(0,s.useMemo)(()=>$("light",p,x,i,y),[p,x,i,y]),[b,v]=(0,s.useReducer)(P,F),{resolvedTheme:C}=(0,M.useTheme)(),N=(0,s.useCallback)(e=>{void 0===e?(v({type:"LIGHT_IMAGE_SUCCESS"}),v({type:"DARK_IMAGE_SUCCESS"})):v({type:"dark"===e?"DARK_IMAGE_SUCCESS":"LIGHT_IMAGE_SUCCESS"}),d?.(!0)},[d]),k=(0,s.useCallback)(e=>{f&&j&&(void 0===e?(v({type:"LIGHT_IMAGE_FAILURE"}),v({type:"DARK_IMAGE_FAILURE"}),d?.(!1)):("dark"===e?f:j)&&(v({type:"dark"===e?"DARK_IMAGE_FAILURE":"LIGHT_IMAGE_FAILURE"}),d?.(!1)))},[d,f,j]),w="dark"===C?"failure"===b.darkImage:"failure"===b.lightImage,I=a||("dark"===C?"pending"===b.darkImage:"pending"===b.lightImage);if(w||!I&&!l)return m();let E=(0,t.jsx)(z,{alt:`Preview Screenshot of ${h}`,onError:k,onLoad:N,srcDark:f,srcLight:j});return(0,t.jsx)(U.Skeleton,{show:I,squared:r,style:{width:"100%",height:"100%"},children:o?(0,t.jsx)("div",{className:(0,n.clsx)("relative aspect-[var(--width,640)/var(--height,400)] size-full",{"rounded-none":r}),style:u?{"--height":(0,O.px)(u),...g}:{},children:E}):E})});var q=e.i(7917902),V=e.i(6060673),H=e.i(5129431),W=e.i(6625227),K=e.i(5072965),Y=e.i(6891161),J=e.i(455575),Z=e.i(277234),X=e.i(4244280),ee=e.i(1717203),et=e.i(7557283),es=e.i(7837522),en=e.i(7780974);function el(e){let n=(0,A.useRouter)(),[a,r]=(0,s.useState)(!1),i=(0,J.useToasts)(),{track:o}=(0,es.useTrackActivity)(),{can:d}=(0,ee.default)(),u=d(et.Action.Update,et.Resource.BuildMachine),c=(0,s.useCallback)(async()=>{if(e.deploymentId&&e.teamId&&e.projectName){r(!0),o(en.VercelActivityAction.DeploymentOverviewEnhancedBuildUpgrade,{});{let t=new URLSearchParams;t.append("teamId",e.teamId),200===(await (0,Z.fetchAPI)(`${(0,X.API_PROJECTS_VERSION)("v9")}/${e.projectName}?${t.toString()}`,{method:"PATCH",body:JSON.stringify({resourceConfig:{elasticConcurrencyEnabled:!0,buildMachineType:e.buildMachineType}}),throwOnHTTPError:!1,returnStatus:!0})).status?i.success(`Enabled ${e.buildMachineTypeLabel}`):(i.error("Something went wrong"),r(!1),e.onClose())}{let t=new URLSearchParams;t.append("teamId",e.teamId),t.append("forceNew","1"),t.append("withCache","1");let s=`${(0,X.API_DEPLOYMENTS)("v13")}?${t.toString()}`,l=await (0,Z.fetchAPI)(s,{method:"POST",body:JSON.stringify({deploymentId:e.deploymentId,meta:{action:"redeploy",buildMachineUpgradeReason:e.upgradeReasonCode,buildMachineAfterUpgrade:e.buildMachineType},name:e.projectName}),throwOnHTTPError:!1,returnStatus:!0});if(200===l.status&&l.body.inspectorUrl){e.onSuccess?.();let t=new URL(l.body.inspectorUrl);n.push(t.pathname)}else i.error("Something went wrong")}r(!1)}},[e,i,n,o]);return(0,t.jsxs)(Y.Modal.Modal,{active:e.active,onClickOutside:e.onClose,width:"500px",children:[(0,t.jsxs)(Y.Modal.Body,{children:[(0,t.jsx)(Y.Modal.Header,{children:(0,t.jsx)(Y.Modal.Title,{children:(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-2 flex-initial",children:["Enable ",e.buildMachineTypeLabel]})})}),(0,t.jsxs)("div",{className:"flex flex-col items-center justify-start gap-2 flex-initial",children:[(0,t.jsxs)("p",{className:"text-copy-14",children:["Overcome memory constraints by activating On-demand Concurrency with"," ",e.buildMachineTypeLabel,"."]}),e.teamId&&e.projectName?(0,t.jsxs)("p",{className:"text-copy-14",children:["Adjust this setting anytime via your project's"," ",(0,t.jsx)(l.Link,{as:`/${e.teamId}/${encodeURIComponent(e.projectName)}/settings/build-and-deployment#build-machine`,href:"/[teamSlug]/[project]/settings/build-and-deployment",target:"_blank",variant:"highlight",children:"On-Demand Concurrent Builds"})," ","options."]}):null,(0,t.jsxs)("p",{className:"text-copy-14",children:['By clicking "Confirm & Redeploy" you agree to be charged for On-demand Concurrency.'," ",(0,t.jsx)(l.Link,{href:"/docs/deployments/managing-builds#build-machine-types",target:"_blank",variant:"highlight",children:"Learn more"})]})]})]}),(0,t.jsxs)(Y.Modal.Actions,{children:[(0,t.jsx)(Y.Modal.Action,{loading:!1,onClick:e.onClose,type:"secondary",children:"Close"}),(0,t.jsx)(y.Tooltip,{text:u?void 0:`You don't have permission to Enable ${e.buildMachineTypeLabel}.`,children:(0,t.jsx)(Y.Modal.Action,{disabled:a||!u,loading:a,onClick:c,children:"Confirm & Redeploy"})})]})]})}function ea(e){let{deploy:n,projectName:l,team:a}=e,{errorMessage:r="Your deployment has failed to build successfully. Please check out the logs for more details.",errorLink:i=""}=n,o=(0,A.useRouter)(),d=(0,A.useSearchParams)(),u=(0,V.useProject)(l),c=!!d?.has("enabledEnhancedBuilds"),m=(0,s.useMemo)(()=>u.isLoading||!u.data?null:void 0===u.data.resourceConfig||!1===u.data.resourceConfig.elasticConcurrencyEnabled||void 0===u.data.resourceConfig.buildMachineType?"enhanced":"enhanced"===u.data.resourceConfig.buildMachineType?"turbo":null,[u]),h=(0,s.useCallback)(()=>{let e=new URLSearchParams(d?.toString());e.set("enabledEnhancedBuilds","1"),o.replace(`?${e.toString()}`)},[d,o]),g=(0,s.useCallback)(()=>{if(!d?.has("enabledEnhancedBuilds"))return;let e=new URLSearchParams(d?.toString());e.delete("enabledEnhancedBuilds"),o.replace(`?${e.toString()}`)},[d,o]);if(m){let e="out-of-memory"===n.oomReport,s="Your deployment's build step did not complete within the maximum of 45min"===r,i=`${m[0].toUpperCase()+m.slice(1)} Builds`,o=(0,K.createTrackingAttributes)({id:"enable-enhanced-builds-modal-opened",upgradeTarget:m??"",plan:a?.billing?.plan??""});if(e||s){let r,d,u;if(e)r="Build Failed (out of memory)",d=`Your build failed because it exceeded the amount of memory available. Enable ${i} to increase machine size and available memory.`,u=n.oomReport||"out-of-memory";else if(s)r="Build Failed (timed out)",d=`Your build exceeded the 45 minute limit. Enable ${i} to increase machine size and reduce build times.`,u="build-timed-out";else throw Error("This should never happen, satisfy typescript");return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(L,{title:r,message:d,status:"ERROR",actionButton:(0,t.jsxs)(p.Button,{className:"w-full",onClick:h,size:"small",type:"default",...o,children:["Enable ",i]})}),(0,t.jsx)(el,{active:c,buildMachineType:m,buildMachineTypeLabel:i,deploymentId:n.id||null,onClose:g,upgradeReasonCode:u,projectName:l??null,teamId:a.slug})]})}}return(0,t.jsx)(L,{link:i,message:r,status:"ERROR",title:"Build Failed"})}e.i(6483798);var er=e.i(8287059),ei=e.i(9041876);function eo(e){let{team:n,projectName:l}=e,a=(0,V.useProject)(l),r=(0,s.useMemo)(()=>!a.isLoading&&a.data&&n?{enhancedBuilds:(0,ei.isUpgradedBuildMachine)(a.data,n),onDemandBuilds:a.data.resourceConfig?.elasticConcurrencyEnabled??!1}:null,[a,n]);return r&&n&&l?n?.billing?.plan==="hobby"?(0,t.jsx)(ed,{team:n}):r.onDemandBuilds&&r.enhancedBuilds?(0,t.jsx)(ec,{}):r.enhancedBuilds?(0,t.jsx)(eu,{upgradeMessage:"Enable On-Demand Concurrent Builds to skip all queueing and build instantly.",projectName:l,team:n,settings:r}):(0,t.jsx)(eu,{upgradeMessage:"Switch to Enhanced Build Machines for faster builds with more CPU and memory.",projectName:l,team:n,settings:r}):(0,t.jsx)(ec,{})}function ed(e){let s,{team:n}=e,a=(0,er.useOpenUpgradeModal)();return(0,t.jsx)(L,{message:"Upgrade to Pro for faster builds with more CPU and memory.",status:"BUILDING",title:"Building…",actionButton:(s=(0,K.createTrackingAttributes)({section:"deployment-status",onDemandBuildsEnabled:"0",id:"faster-builds",plan:n?.billing?.plan??""}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(l.ButtonLink,{href:"/docs/deployments/managing-builds#on-demand-concurrent-builds",target:"_blank",className:"w-full",size:"small",type:"secondary",children:"Read Docs"}),(0,t.jsx)(p.Button,{className:"w-full",size:"small",type:"default",onClick:()=>{a({teamHint:n.id,source:"deployment-building-status"})},...s,children:"Get Faster Builds with Pro"})]}))})}function eu(e){let s,{projectName:n,team:a,upgradeMessage:r,settings:i}=e;return(0,t.jsx)(L,{message:r,status:"BUILDING",title:"Building…",actionButton:(s=(0,K.createTrackingAttributes)({section:"deployment-status",onDemandBuildsEnabled:i.onDemandBuilds?"1":"0",id:"faster-builds",plan:a?.billing?.plan??""}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(l.ButtonLink,{href:"/docs/deployments/managing-builds#on-demand-concurrent-builds",target:"_blank",className:"w-full",size:"small",type:"secondary",children:"Read Docs"}),(0,t.jsx)(l.ButtonLink,{href:`/${a.slug}/${encodeURIComponent(n)}/settings/build-and-deployment#build-machine`,className:"w-full",size:"small",type:"default",...s,children:"Get Faster Builds"})]}))})}function ec(){return(0,t.jsx)("p",{className:"m-auto text-center text-sm text-gray-600",children:"Building..."})}var em=e.i(8366444),eh=e.i(380513),ep=e.i(5023172),eg=e.i(542164);let ex=new Map;window.addEventListener("storage",e=>{e.key&&(null===e.newValue?ex.delete(e.key):ex.set(e.key,e.newValue))});class ey{key;defaultValue;constructor(e,t){this.key=e,this.defaultValue=t,this.init()}init(){if(!ex.has(this.key))try{ex.set(this.key,window.localStorage?.getItem(this.key))}catch(e){}}reset(){this.set(this.defaultValue)}get(){let e=ex.get(this.key);if(!e)return this.defaultValue;try{return JSON.parse(e)}catch(e){return this.defaultValue}}set(e){try{let t=JSON.stringify(e);window.localStorage?.setItem(this.key,t),ex.set(this.key,t)}catch(e){}}remove(){try{window.localStorage?.removeItem(this.key),ex.delete(this.key)}catch(e){}}}function ef(e,t){let s=t?.name||e.url;return!s||(0,eg.default)(s)?e.url:s}function ej(){let e=(0,A.useSearchParams)();return(0,s.useMemo)(()=>{let t=e?.get("fakeDeploymentStatus")??null,s=e?.get("fakeBillingPlan")??null;return{status:t?.toUpperCase(),plan:s?.toLowerCase()}},[e])}let eb=["nitro","express","fastapi","hono","xmcp"],ev=new Map([["enterprise-non-unbundled","Contact sales to enable On-Demand Concurrent Builds"],["pro-non-active","Upgrade to Pro to enable On-Demand Concurrent Builds"],["no-permission","Only project admins and team owners can trigger builds on-demand"]]);function eC(e){let{deploy:n,projectName:a,team:r,user:i,isInSystemBuildsQueue:o,isInConcurrentBuildsQueue:d,compact:u}=e,{data:c}=(0,eh.useFeatureFlag)("enable-team-deployments-page"),m=n.target?et.Resource.Deployment:et.Resource.DeploymentPreview,{can:h}=(0,ee.default)(),p=h(et.Action.Update,m),[g,x]=(0,s.useState)(null),y="string"==typeof n.id?n.id:void 0,{enabled:f,disabledReason:j}=(0,em.useOnDemandConcurrentBuilds)(r,p),b=f||j&&ev.has(j),v=j?ev.get(j):void 0,[C,N]=(0,s.useState)(f),k=b?(0,t.jsx)(eI,{enabled:C,onClick:()=>x(y??null),reasonWhyStartBuildingNowIsDisabled:v}):null,w=ej();if(o)return(0,t.jsx)("p",{className:"m-auto text-center text-sm text-gray-600",children:"Initializing..."});let I="Deployments",E=c?(0,t.jsx)(l.Link,{href:`/${r.slug}/~/deployments?status=building%2Cqueued`,underline:!0,children:I}):I;if(d){let e=w.plan?w.plan:r.billing?.plan;if("enterprise"===e)return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(eN,{team:r,user:i,deployments:E,projectName:a,startBuildNowButton:k}),(0,t.jsx)(ep.StartBuildingNowModal,{active:!!g,deploymentId:g,onClose:()=>{x(null)},onSuccess:()=>{N(!1)},projectName:a??null,teamId:r.slug})]});if("pro"===e)return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(ek,{team:r,deployments:E,projectName:a,startBuildNowButton:k}),(0,t.jsx)(ep.StartBuildingNowModal,{active:!!g,deploymentId:g,onClose:()=>{x(null)},onSuccess:()=>{N(!1)},projectName:a??null,teamId:r.slug})]});if("hobby"===e)return(0,t.jsx)(ew,{team:r,deployments:E})}return u?(0,t.jsx)("p",{className:"m-auto text-center text-sm text-gray-600",children:"Deployment Queued"}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(L,{message:(0,t.jsxs)(t.Fragment,{children:["The build will start once other"," ",a?(0,t.jsx)(l.Link,{href:`/${r.slug}/${a}/deployments?status=building%2Cqueued`,underline:!0,children:I}):I," ","for this branch have finished."," ",(0,t.jsx)(l.Link,{href:"/docs/builds/build-queues#git-branch-queue",underline:!0,children:"Learn more."})]}),actionButton:k,status:"QUEUED",title:"Deployment Queued"}),(0,t.jsx)(ep.StartBuildingNowModal,{active:!!g,deploymentId:g,onClose:()=>{x(null)},onSuccess:()=>{N(!1)},projectName:a??null,teamId:r.slug})]})}function eN(e){let{team:s,user:n,deployments:a,projectName:r,startBuildNowButton:i}=e,o=new URLSearchParams({content:"I'd like to add extra concurrent builds to my contract."});return n?.email&&o.set("email",n.email),(0,t.jsx)(L,{actionButton:i,status:"QUEUED",title:"Deployment Queued",message:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-1 flex-initial",children:[(0,t.jsxs)("div",{children:["The build will start once your other ",a," have finished."]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(l.Link,{href:`/contact/sales?${o.toString()}`,underline:!0,children:"Contact Sales"})," ","to add concurrent build slots or use"," ",(0,t.jsx)(l.Link,{as:`/${s.slug}/${encodeURIComponent(r??"")}/settings/build-and-deployment`,href:"/[teamSlug]/[project]/settings/build-and-deployment",target:"_blank",underline:!0,children:"On-Demand Concurrent Builds"})," ","to avoid the queue."]})]})})}function ek(e){let{team:s,deployments:n,projectName:a,startBuildNowButton:r}=e,i=(s?.billing?.invoiceItems?.concurrentBuilds?.quantity??1)>1,o=s.billing?.planIteration!=="plus"||i?(0,t.jsxs)(t.Fragment,{children:["The build will start once your other ",n," have finished. Add"," ",(0,t.jsx)(l.Link,{as:`/${s.slug}/~/settings/build-and-deployment#concurrent-builds`,href:"/[teamSlug]/~/settings/build-and-deployment#concurrent-builds",target:"_blank",underline:!0,children:"concurrent build slots"})," ","or use"," ",(0,t.jsx)(l.Link,{as:`/${s.slug}/${encodeURIComponent(a??"")}/settings/build-and-deployment`,href:"/[teamSlug]/[project]/settings/build-and-deployment",target:"_blank",underline:!0,children:"On-Demand Concurrent Builds"})," ","to avoid the queue."]}):(0,t.jsxs)(t.Fragment,{children:["The build will start once your other ",n," have finished. Use"," ",(0,t.jsx)(l.Link,{as:`/${s.slug}/${encodeURIComponent(a??"")}/settings/build-and-deployment`,href:"/[teamSlug]/[project]/settings/build-and-deployment",target:"_blank",underline:!0,children:"On-Demand Concurrent Builds"})," ","to avoid the queue."]});return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(L,{message:o,actionButton:r,status:"QUEUED",title:"Deployment Queued"})})}function ew(e){let{deployments:s,team:n}=e,l=(0,er.useOpenUpgradeModal)();return(0,t.jsx)(L,{message:(0,t.jsxs)(t.Fragment,{children:["The build will start once your other ",s," have finished. Pro teams can use On-Demand Concurrent Builds to avoid the queue."]}),status:"QUEUED",title:"Another build is in progress",actionButton:(0,t.jsx)(p.Button,{onClick:()=>{l({teamHint:n.id,source:"concurrent-builds-queue"})},size:"small",type:"default",children:"Upgrade to Pro"})})}function eI(e){let{onClick:s,enabled:n,reasonWhyStartBuildingNowIsDisabled:l}=e;return void 0!==l?(0,t.jsx)(y.Tooltip,{position:"right",style:{alignItems:"center",flex:"1",justifyContent:"center",width:"100%"},text:l,children:(0,t.jsx)(p.Button,{disabled:!0,size:"small",style:{alignItems:"center",flex:"1",justifyContent:"center"},children:"Start Building Now"})}):(0,t.jsx)(p.Button,{disabled:!n,onClick:s,size:"small",type:"default",children:"Start Building Now"})}let eE=e=>{let{deploy:s,projectName:n}=e,l=(0,V.useProject)(n),{data:a}=(0,W.default)(s.id),{modal:r,open:i}=(0,H.default)(l.data),o=(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsx)("p",{children:"An unexpected error happened when running this build. This issue is likely temporary."}),(0,t.jsx)("p",{children:"Please try to redeploy in a few minutes."})]})});return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(L,{message:o,status:"ERROR",title:"Build Failed",actionButton:(0,t.jsx)(p.Button,{className:"w-full",disabled:!a,onClick:()=>{a&&i(a)},size:"small",type:"default",children:"Redeploy"})}),r]})};function eS(e){let{deploy:s,showError:n,isInConcurrentBuildsQueue:l,isInSystemBuildsQueue:a,compact:r,projectName:i}=e,{status:o,errorMessage:d,errorLink:u=""}=s,c=o,m=ej();m?.status&&(c=m.status);let{user:h,team:p}=(0,q.useAccount)();return p?"ERROR"===c?n?"temporary_failure"===s.errorCode?(0,t.jsx)(eE,{deploy:s,projectName:i}):(0,t.jsx)(ea,{deploy:s,team:p,projectName:i}):(0,t.jsx)("p",{className:"m-auto text-center text-sm text-red-600",children:"Deployment Failed"}):"FROZEN"===c||"FAILED"===c?(0,t.jsx)("p",{className:"m-auto text-center text-sm text-gray-600",children:"No Screenshot Available"}):"NO_PRODUCTION"===c?(0,t.jsx)(y.Tooltip,{className:"m-auto text-center",delay:!1,text:"To deploy to production, push to the Repository Default branch.",children:(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"No Production Deployment"})}):"CANCELED"===c?n&&d?(0,t.jsx)(L,{link:u,message:d||"Deployment canceled.",status:c,title:"Build Canceled"}):(0,t.jsx)("p",{className:"m-auto text-center text-sm text-gray-600",children:"Deployment Canceled"}):"QUEUED"===c?(0,t.jsx)(eC,{deploy:s,projectName:i,isInConcurrentBuildsQueue:l,isInSystemBuildsQueue:a,compact:r,user:h,team:p}):(0,t.jsx)(eo,{team:p,projectName:i}):(0,t.jsx)("p",{className:"m-auto text-center text-sm text-gray-600",children:"Loading…"})}function eB(e){let{deployment:m,ignoreAliasWarning:h=!0,placeholder:p,toolbarVia:g,customHref:x,compact:y,...f}=e,{showError:j=!1,link:b=!0,empty:C=!1,noHighlight:N,noBorder:k,noBorderRadius:I,useDeploymentUrl:E=!1,onClick:S}=f,B=null!=m&&"project"in m?m.project?.name:void 0,{domain:R}=(0,d.useBestProductionDomain)(B),D=R||f.projectDomain||null,T=(0,_.useServerFlag)("request-builder",!1),[U,M]=function(e){let t=(0,s.useMemo)(()=>e?new ey(`show-deployment-warning:${e.uid||e.id}`,!0):null,[e]),[n,l]=(0,s.useState)(()=>{let e=t?.get();return"boolean"!=typeof e||e});return[n,e=>{t?.set(e),l(e)}]}(m),{onClick:O,...P}=(0,u.useWrappedToolbarAuthLinkHandler)({via:g??"project-screenshot",deployment:b?m:void 0}),{team:F}=(0,c.useTeam)(),$=function(e){if(!e||!("microfrontends"in e)||!e.microfrontends)return!1;let t=e.microfrontends;return!t.isDefaultApp&&!t.defaultRoute}(m),z=`/${F?.slug}/${B}/settings/microfrontends#default-route`,Q=(()=>{let e=(0,A.useParams)(),{data:t}=(0,V.useProject)(e?.project);return!!t&&"framework"in t&&!!t.framework&&!!eb.includes(t?.framework)})(),q=(0,s.useMemo)(()=>{if(!m)return C?{status:"NO_PRODUCTION"}:null;let e=E?m.url:ef(m,D),t=m.readyStateReason||m.errorMessage;return m.readyStateReason?.startsWith("The deployment failed to build.")&&m.errorMessage&&(t=m.errorMessage),{id:m.uid||m.id,url:e,target:m.target,status:m.readyState,errorCode:m.errorCode,errorMessage:t,errorLink:m.errorLink,aliasWarning:m.aliasWarning,oomReport:m.oomReport}},[E,m,C,D]),H=!h&&U&&q?.status==="READY"&&q?.aliasWarning?.code==="deprecated_now_sh",W=q&&"READY"!==q.status,K=q?.status==="ERROR"||m?.aliasError,Y=(0,s.useCallback)(()=>(0,t.jsx)(eS,{deploy:{...q,status:"FAILED"},isInConcurrentBuildsQueue:m?.isInConcurrentBuildsQueue,isInSystemBuildsQueue:m?.isInSystemBuildsQueue,projectName:B,showError:j}),[q,j,B,m?.isInConcurrentBuildsQueue,m?.isInSystemBuildsQueue]),J=(0,s.useMemo)(()=>m?.aliasError?(0,t.jsx)(L,{message:m.aliasError.message,status:"ERROR",title:"Domain Error"}):H?(0,t.jsx)(w,{link:q.aliasWarning.link,message:q.aliasWarning.message,onDismiss:()=>M(!1),title:"Warning"}):W?(0,t.jsx)(eS,{compact:y,deploy:q,isInConcurrentBuildsQueue:m?.isInConcurrentBuildsQueue,isInSystemBuildsQueue:m?.isInSystemBuildsQueue,projectName:B,showError:j}):$?(0,t.jsxs)("div",{className:"flex flex-col gap-2 p-6",children:[(0,t.jsx)("p",{className:"text-heading-16",children:"Default Route Missing"}),(0,t.jsxs)("p",{className:"text-copy-14 text-[var(--geist-secondary)]",children:[(0,t.jsx)(l.Link,{href:z,underline:!0,children:"Set the default route"})," ","for this microfrontend to screenshot the correct path. The default route is used anywhere that the microfrontend domain is referenced for this project."," ",(0,t.jsx)(l.Link,{external:!0,href:"/docs/microfrontends/managing-microfrontends#set-a-default-route",tab:!0,type:"highlight",children:"Learn More"})]})]}):Q&&T?(0,t.jsx)(v,{deployment:m,teamId:F?.id}):b&&m?.url?(0,t.jsx)(l.Link,{"aria-label":"Visit Deployment",href:x||(0,o.withDefaultRoute)((0,i.domainToUrl)(E?m.url:ef(m,D)),m.defaultRoute),...P,onClick:e=>{S?.(e),O?.(e),a.analytics.track(r.AnalyticsEvent.DEPLOYMENT_OVERVIEW_CLICKED_SCREENSHOT,{projectId:m.projectId||D?.projectId,deploymentId:m.id,deploymentTarget:m.target})},style:{width:"100%"},tab:!0,children:(0,t.jsx)(G,{deployment:q,onScreenshotFailed:Y,placeholder:p,withReachable:!0,...f})}):(0,t.jsx)(G,{deployment:q,onScreenshotFailed:()=>(0,t.jsx)(eS,{deploy:{...q,status:"FAILED"},isInConcurrentBuildsQueue:m?.isInConcurrentBuildsQueue,isInSystemBuildsQueue:m?.isInSystemBuildsQueue,projectName:B,showError:j}),placeholder:p,withReachable:!0,...f}),[q,m,b,D,f,M,W,H,j,E,Y,p,B,S]);return(0,t.jsx)("div",{className:(0,n.clsx)("geist-ratio","size-full p-0","border border-solid border-[var(--ds-gray-400)]","rounded-[var(--geist-radius)]","flex flex-none justify-center","overflow-hidden","aspect-[640/400]",{"w-screen max-w-full":W,"bg-[var(--ds-background-200)]":q?.status==="CANCELED"||q?.status==="QUEUED"||q?.status==="FROZEN"||q?.status==="FAILED",group:!N,"border-[var(--geist-error-light)]":K,"border-[var(--ds-amber-400)]":H,"min-w-[108px]":q?.status==="NO_PRODUCTION","border-0":k,"rounded-none":I}),style:{"--ratio":"62.5%"},children:J})}e.s(["DeploymentPreview",()=>eB],1303150)}]);

//# debugId=7fa05f27-9af4-2de7-10ea-3cd6c80c13c9
//# sourceMappingURL=263b4a039d5ad17f.js.map