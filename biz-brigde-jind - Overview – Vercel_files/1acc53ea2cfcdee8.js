;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="e8fa8a72-526b-e1d4-ad93-363d3d4f53dd")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,8052179,(e,t,r)=>{"use strict";var a=Object.defineProperty,o=Object.getOwnPropertyDescriptor,s=Object.getOwnPropertyNames,i=Object.prototype.hasOwnProperty,n={},l={SYMBOL_FOR_REQ_CONTEXT:()=>d,getContext:()=>u};for(var c in l)a(n,c,{get:l[c],enumerable:!0});t.exports=((e,t,r,n)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let l of s(t))i.call(e,l)||l===r||a(e,l,{get:()=>t[l],enumerable:!(n=o(t,l))||n.enumerable});return e})(a({},"__esModule",{value:!0}),n);let d=Symbol.for("@vercel/request-context");function u(){let e=globalThis;return e[d]?.get?.()??{}}},505248,(e,t,r)=>{"use strict";var a=Object.defineProperty,o=Object.getOwnPropertyDescriptor,s=Object.getOwnPropertyNames,i=Object.prototype.hasOwnProperty,n={},l={getContext:()=>d.getContext,getVercelOidcToken:()=>u,getVercelOidcTokenSync:()=>p};for(var c in l)a(n,c,{get:l[c],enumerable:!0});t.exports=((e,t,r,n)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let l of s(t))i.call(e,l)||l===r||a(e,l,{get:()=>t[l],enumerable:!(n=o(t,l))||n.enumerable});return e})(a({},"__esModule",{value:!0}),n);var d=e.r(8052179);async function u(){return""}function p(){return""}},9854108,3358287,e=>{"use strict";var t,r,a,o,s,i,n,l,c,d,u,p,h,g,m,y,f,v,b,I,E,w,T,A,_,S,k,x,R,M,C,j,P,O,N,D,F,K,Z,L,V=e.i(5169864),U=e.i(2174061),B=e.i(4418577),$=e.i(2957938),J=e.i(4710717);e.i(9439603);var H=e.i(7636829),q=e.i(5207889);e.i(3512434);var G=e.i(1961272);function z(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.reduce((e,t)=>({...e,...null!=t?t:{}}),{})}function Y(e){return Object.fromEntries([...e.headers])}var W=function(){let{prefix:e,size:t=16,alphabet:r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:a="-"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=()=>{let e=r.length,a=Array(t);for(let o=0;o<t;o++)a[o]=r[Math.random()*e|0];return a.join("")};if(null==e)return o;if(r.includes(a))throw new B.InvalidArgumentError({argument:"separator",message:`The separator "${a}" must not be part of the alphabet "${r}".`});return()=>`${e}${a}${o()}`},Q=W();function X(e){return(e instanceof Error||e instanceof DOMException)&&("AbortError"===e.name||"ResponseAborted"===e.name||"TimeoutError"===e.name)}var ee=["fetch failed","failed to fetch"];function et(e){let{error:t,url:r,requestBodyValues:a}=e;if(X(t))return t;if(t instanceof TypeError&&ee.includes(t.message.toLowerCase())){let e=t.cause;if(null!=e)return new B.APICallError({message:`Cannot connect to API: ${e.message}`,cause:e,url:r,requestBodyValues:a,isRetryable:!0})}return t}function er(){var e,t,r;let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:globalThis;return a.window?"runtime/browser":(null==(e=a.navigator)?void 0:e.userAgent)?`runtime/${a.navigator.userAgent.toLowerCase()}`:(null==(r=null==(t=a.process)?void 0:t.versions)?void 0:r.node)?`runtime/node.js/${a.process.version.substring(0)}`:a.EdgeRuntime?"runtime/vercel-edge":"runtime/unknown"}function ea(e){for(var t=arguments.length,r=Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];let o=new Headers(Object.fromEntries(Object.entries(null!=e?e:{}).filter(e=>{let[t,r]=e;return null!=r}))),s=o.get("user-agent")||"";return o.set("user-agent",[s,...r].filter(Boolean).join(" ")),Object.fromEntries(o)}var eo="3.0.12",es=async e=>{let{url:t,headers:r={},successfulResponseHandler:a,failedResponseHandler:o,abortSignal:s,fetch:i=globalThis.fetch}=e;try{let e=await i(t,{method:"GET",headers:ea(r,`ai-sdk/provider-utils/${eo}`,er()),signal:s}),n=Y(e);if(!e.ok){let r;try{r=await o({response:e,url:t,requestBodyValues:{}})}catch(r){if(X(r)||B.APICallError.isInstance(r))throw r;throw new B.APICallError({message:"Failed to process error response",cause:r,statusCode:e.status,url:t,responseHeaders:n,requestBodyValues:{}})}throw r.value}try{return await a({response:e,url:t,requestBodyValues:{}})}catch(r){if(r instanceof Error&&(X(r)||B.APICallError.isInstance(r)))throw r;throw new B.APICallError({message:"Failed to process successful response",cause:r,statusCode:e.status,url:t,responseHeaders:n,requestBodyValues:{}})}}catch(e){throw et({error:e,url:t,requestBodyValues:{}})}};function ei(e){let{settingValue:t,environmentVariableName:r}=e;return"string"==typeof t?t:null!=t||void 0===$.default?void 0:null!=(t=$.default.env[r])&&"string"==typeof t?t:void 0}var en=/"__proto__"\s*:/,el=/"constructor"\s*:/;function ec(e){let{stackTraceLimit:t}=Error;Error.stackTraceLimit=0;try{let t;return t=JSON.parse(e),null===t||"object"!=typeof t||!1===en.test(e)&&!1===el.test(e)?t:function(e){let t=[e];for(;t.length;){let e=t;for(let r of(t=[],e)){if(Object.prototype.hasOwnProperty.call(r,"__proto__")||Object.prototype.hasOwnProperty.call(r,"constructor")&&Object.prototype.hasOwnProperty.call(r.constructor,"prototype"))throw SyntaxError("Object contains forbidden prototype property");for(let e in r){let a=r[e];a&&"object"==typeof a&&t.push(a)}}}return e}(t)}finally{Error.stackTraceLimit=t}}var ed=Symbol.for("vercel.ai.validator");function eu(e){let t;return()=>(null==t&&(t=e()),t)}async function ep(e){let{value:t,schema:r}=e,a=await eh({value:t,schema:r});if(!a.success)throw B.TypeValidationError.wrap({value:t,cause:a.error});return a.value}async function eh(e){var t;let{value:r,schema:a}=e,o="object"==typeof a&&null!==a&&ed in a&&!0===a[ed]&&"validate"in a?a:"function"==typeof a?a():(t=a,{[ed]:!0,validate:async e=>{let r=await t["~standard"].validate(e);return null==r.issues?{success:!0,value:r.value}:{success:!1,error:new B.TypeValidationError({value:e,cause:r.issues})}}});try{if(null==o.validate)return{success:!0,value:r,rawValue:r};let e=await o.validate(r);if(e.success)return{success:!0,value:e.value,rawValue:r};return{success:!1,error:B.TypeValidationError.wrap({value:r,cause:e.error}),rawValue:r}}catch(e){return{success:!1,error:B.TypeValidationError.wrap({value:r,cause:e}),rawValue:r}}}async function eg(e){let{text:t,schema:r}=e;try{let e=ec(t);if(null==r)return e;return ep({value:e,schema:r})}catch(e){if(B.JSONParseError.isInstance(e)||B.TypeValidationError.isInstance(e))throw e;throw new B.JSONParseError({text:t,cause:e})}}async function em(e){let{text:t,schema:r}=e;try{let e=ec(t);if(null==r)return{success:!0,value:e,rawValue:e};return await eh({value:e,schema:r})}catch(e){return{success:!1,error:B.JSONParseError.isInstance(e)?e:new B.JSONParseError({text:t,cause:e}),rawValue:void 0}}}function ey(e){let{stream:t,schema:r}=e;return t.pipeThrough(new TextDecoderStream).pipeThrough(new J.EventSourceParserStream).pipeThrough(new TransformStream({async transform(e,t){let{data:a}=e;"[DONE]"!==a&&t.enqueue(await em({text:a,schema:r}))}}))}var ef=async e=>{let{url:t,headers:r,body:a,failedResponseHandler:o,successfulResponseHandler:s,abortSignal:i,fetch:n}=e;return ev({url:t,headers:{"Content-Type":"application/json",...r},body:{content:JSON.stringify(a),values:a},failedResponseHandler:o,successfulResponseHandler:s,abortSignal:i,fetch:n})},ev=async e=>{let{url:t,headers:r={},body:a,successfulResponseHandler:o,failedResponseHandler:s,abortSignal:i,fetch:n=globalThis.fetch}=e;try{let e=await n(t,{method:"POST",headers:ea(r,`ai-sdk/provider-utils/${eo}`,er()),body:a.content,signal:i}),l=Y(e);if(!e.ok){let r;try{r=await s({response:e,url:t,requestBodyValues:a.values})}catch(r){if(X(r)||B.APICallError.isInstance(r))throw r;throw new B.APICallError({message:"Failed to process error response",cause:r,statusCode:e.status,url:t,responseHeaders:l,requestBodyValues:a.values})}throw r.value}try{return await o({response:e,url:t,requestBodyValues:a.values})}catch(r){if(r instanceof Error&&(X(r)||B.APICallError.isInstance(r)))throw r;throw new B.APICallError({message:"Failed to process successful response",cause:r,statusCode:e.status,url:t,responseHeaders:l,requestBodyValues:a.values})}}catch(e){throw et({error:e,url:t,requestBodyValues:a.values})}};async function eb(e){return"function"==typeof e&&(e=e()),Promise.resolve(e)}var eI=e=>{let{errorSchema:t,errorToMessage:r,isRetryable:a}=e;return async e=>{let{response:o,url:s,requestBodyValues:i}=e,n=await o.text(),l=Y(o);if(""===n.trim())return{responseHeaders:l,value:new B.APICallError({message:o.statusText,url:s,requestBodyValues:i,statusCode:o.status,responseHeaders:l,responseBody:n,isRetryable:null==a?void 0:a(o)})};try{let e=await eg({text:n,schema:t});return{responseHeaders:l,value:new B.APICallError({message:r(e),url:s,requestBodyValues:i,statusCode:o.status,responseHeaders:l,responseBody:n,data:e,isRetryable:null==a?void 0:a(o,e)})}}catch(e){return{responseHeaders:l,value:new B.APICallError({message:o.statusText,url:s,requestBodyValues:i,statusCode:o.status,responseHeaders:l,responseBody:n,isRetryable:null==a?void 0:a(o)})}}}},eE=e=>async t=>{let{response:r,url:a,requestBodyValues:o}=t,s=await r.text(),i=await em({text:s,schema:e}),n=Y(r);if(!i.success)throw new B.APICallError({message:"Invalid JSON response",cause:i.error,statusCode:r.status,responseHeaders:n,responseBody:s,url:a,requestBodyValues:o});return{responseHeaders:n,value:i.value,rawValue:i.rawValue}},ew=Symbol("Let zodToJsonSchema decide on which parser to use"),eT={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",strictUnions:!1,definitions:{},errorMessages:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"};function eA(e,t){return eJ(e.type._def,t)}var e_=void 0,eS=/^[cC][^\s-]{8,}$/,ek=/^[0-9a-z]+$/,ex=/^[0-9A-HJKMNP-TV-Z]{26}$/,eR=/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,eM=()=>(void 0===e_&&(e_=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),e_),eC=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ej=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,eP=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,eO=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,eN=/^[a-zA-Z0-9_-]{21}$/,eD=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/;function eF(e,t){let r={type:"string"};if(e.checks)for(let a of e.checks)switch(a.kind){case"min":r.minLength="number"==typeof r.minLength?Math.max(r.minLength,a.value):a.value;break;case"max":r.maxLength="number"==typeof r.maxLength?Math.min(r.maxLength,a.value):a.value;break;case"email":switch(t.emailStrategy){case"format:email":eL(r,"email",a.message,t);break;case"format:idn-email":eL(r,"idn-email",a.message,t);break;case"pattern:zod":eV(r,eR,a.message,t)}break;case"url":eL(r,"uri",a.message,t);break;case"uuid":eL(r,"uuid",a.message,t);break;case"regex":eV(r,a.regex,a.message,t);break;case"cuid":eV(r,eS,a.message,t);break;case"cuid2":eV(r,ek,a.message,t);break;case"startsWith":eV(r,RegExp(`^${eK(a.value,t)}`),a.message,t);break;case"endsWith":eV(r,RegExp(`${eK(a.value,t)}$`),a.message,t);break;case"datetime":eL(r,"date-time",a.message,t);break;case"date":eL(r,"date",a.message,t);break;case"time":eL(r,"time",a.message,t);break;case"duration":eL(r,"duration",a.message,t);break;case"length":r.minLength="number"==typeof r.minLength?Math.max(r.minLength,a.value):a.value,r.maxLength="number"==typeof r.maxLength?Math.min(r.maxLength,a.value):a.value;break;case"includes":eV(r,RegExp(eK(a.value,t)),a.message,t);break;case"ip":"v6"!==a.version&&eL(r,"ipv4",a.message,t),"v4"!==a.version&&eL(r,"ipv6",a.message,t);break;case"base64url":eV(r,eO,a.message,t);break;case"jwt":eV(r,eD,a.message,t);break;case"cidr":"v6"!==a.version&&eV(r,eC,a.message,t),"v4"!==a.version&&eV(r,ej,a.message,t);break;case"emoji":eV(r,eM(),a.message,t);break;case"ulid":eV(r,ex,a.message,t);break;case"base64":switch(t.base64Strategy){case"format:binary":eL(r,"binary",a.message,t);break;case"contentEncoding:base64":r.contentEncoding="base64";break;case"pattern:zod":eV(r,eP,a.message,t)}break;case"nanoid":eV(r,eN,a.message,t)}return r}function eK(e,t){return"escape"===t.patternStrategy?function(e){let t="";for(let r=0;r<e.length;r++)eZ.has(e[r])||(t+="\\"),t+=e[r];return t}(e):e}var eZ=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function eL(e,t,r,a){var o;e.format||(null==(o=e.anyOf)?void 0:o.some(e=>e.format))?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format}),delete e.format),e.anyOf.push({format:t,...r&&a.errorMessages&&{errorMessage:{format:r}}})):e.format=t}function eV(e,t,r,a){var o;e.pattern||(null==(o=e.allOf)?void 0:o.some(e=>e.pattern))?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern}),delete e.pattern),e.allOf.push({pattern:eU(t,a),...r&&a.errorMessages&&{errorMessage:{pattern:r}}})):e.pattern=eU(t,a)}function eU(e,t){var r;if(!t.applyRegexFlags||!e.flags)return e.source;let a={i:e.flags.includes("i"),m:e.flags.includes("m"),s:e.flags.includes("s")},o=a.i?e.source.toLowerCase():e.source,s="",i=!1,n=!1,l=!1;for(let e=0;e<o.length;e++){if(i){s+=o[e],i=!1;continue}if(a.i){if(n){if(o[e].match(/[a-z]/)){l?(s+=o[e],s+=`${o[e-2]}-${o[e]}`.toUpperCase(),l=!1):"-"===o[e+1]&&(null==(r=o[e+2])?void 0:r.match(/[a-z]/))?(s+=o[e],l=!0):s+=`${o[e]}${o[e].toUpperCase()}`;continue}}else if(o[e].match(/[a-z]/)){s+=`[${o[e]}${o[e].toUpperCase()}]`;continue}}if(a.m){if("^"===o[e]){s+=`(^|(?<=[\r
]))`;continue}else if("$"===o[e]){s+=`($|(?=[\r
]))`;continue}}if(a.s&&"."===o[e]){s+=n?`${o[e]}\r
`:`[${o[e]}\r
]`;continue}s+=o[e],"\\"===o[e]?i=!0:n&&"]"===o[e]?n=!1:n||"["!==o[e]||(n=!0)}try{new RegExp(s)}catch(r){return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),e.source}return s}function eB(e,t){var r,a,o,s,i,n;let l={type:"object",additionalProperties:null!=(r=eJ(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]}))?r:t.allowedAdditionalProperties};if((null==(a=e.keyType)?void 0:a._def.typeName)===G.ZodFirstPartyTypeKind.ZodString&&(null==(o=e.keyType._def.checks)?void 0:o.length)){let{type:r,...a}=eF(e.keyType._def,t);return{...l,propertyNames:a}}if((null==(s=e.keyType)?void 0:s._def.typeName)===G.ZodFirstPartyTypeKind.ZodEnum)return{...l,propertyNames:{enum:e.keyType._def.values}};if((null==(i=e.keyType)?void 0:i._def.typeName)===G.ZodFirstPartyTypeKind.ZodBranded&&e.keyType._def.type._def.typeName===G.ZodFirstPartyTypeKind.ZodString&&(null==(n=e.keyType._def.type._def.checks)?void 0:n.length)){let{type:r,...a}=eA(e.keyType._def,t);return{...l,propertyNames:a}}return l}var e$={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function eJ(e,t){var r;let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=t.seen.get(e);if(t.override){let s=null==(r=t.override)?void 0:r.call(t,e,t,o,a);if(s!==ew)return s}if(o&&!a){let e=eH(o,t);if(void 0!==e)return e}let s={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,s);let i=((e,t,r)=>{var a,o,s,i,n,l;switch(t){case G.ZodFirstPartyTypeKind.ZodString:return eF(e,r);case G.ZodFirstPartyTypeKind.ZodNumber:let c={type:"number"};if(!e.checks)return c;for(let t of e.checks)switch(t.kind){case"int":c.type="integer";break;case"min":t.inclusive?c.minimum=t.value:c.exclusiveMinimum=t.value;break;case"max":t.inclusive?c.maximum=t.value:c.exclusiveMaximum=t.value;break;case"multipleOf":c.multipleOf=t.value}return c;case G.ZodFirstPartyTypeKind.ZodObject:return function(e,t){let r={type:"object",properties:{}},a=[],o=e.shape();for(let e in o){let s=o[e];if(void 0===s||void 0===s._def)continue;let i=function(e){try{return e.isOptional()}catch(e){return!0}}(s),n=eJ(s._def,{...t,currentPath:[...t.currentPath,"properties",e],propertyPath:[...t.currentPath,"properties",e]});void 0!==n&&(r.properties[e]=n,i||a.push(e))}a.length&&(r.required=a);let s=function(e,t){if("ZodNever"!==e.catchall._def.typeName)return eJ(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]});switch(e.unknownKeys){case"passthrough":return t.allowedAdditionalProperties;case"strict":return t.rejectedAdditionalProperties;case"strip":return"strict"===t.removeAdditionalStrategy?t.allowedAdditionalProperties:t.rejectedAdditionalProperties}}(e,t);return void 0!==s&&(r.additionalProperties=s),r}(e,r);case G.ZodFirstPartyTypeKind.ZodBigInt:let d={type:"integer",format:"int64"};if(!e.checks)return d;for(let t of e.checks)switch(t.kind){case"min":t.inclusive?d.minimum=t.value:d.exclusiveMinimum=t.value;break;case"max":t.inclusive?d.maximum=t.value:d.exclusiveMaximum=t.value;break;case"multipleOf":d.multipleOf=t.value}return d;case G.ZodFirstPartyTypeKind.ZodBoolean:return{type:"boolean"};case G.ZodFirstPartyTypeKind.ZodDate:return function e(t,r,a){let o=null!=a?a:r.dateStrategy;if(Array.isArray(o))return{anyOf:o.map((a,o)=>e(t,r,a))};switch(o){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":var s=t;let i={type:"integer",format:"unix-time"};for(let e of s.checks)switch(e.kind){case"min":i.minimum=e.value;break;case"max":i.maximum=e.value}return i}}(e,r);case G.ZodFirstPartyTypeKind.ZodUndefined:return{not:{}};case G.ZodFirstPartyTypeKind.ZodNull:return{type:"null"};case G.ZodFirstPartyTypeKind.ZodArray:let u;return u={type:"array"},(null==(s=e.type)?void 0:s._def)&&(null==(n=null==(i=e.type)?void 0:i._def)?void 0:n.typeName)!==G.ZodFirstPartyTypeKind.ZodAny&&(u.items=eJ(e.type._def,{...r,currentPath:[...r.currentPath,"items"]})),e.minLength&&(u.minItems=e.minLength.value),e.maxLength&&(u.maxItems=e.maxLength.value),e.exactLength&&(u.minItems=e.exactLength.value,u.maxItems=e.exactLength.value),u;case G.ZodFirstPartyTypeKind.ZodUnion:case G.ZodFirstPartyTypeKind.ZodDiscriminatedUnion:let p,h=e.options instanceof Map?Array.from(e.options.values()):e.options;if(h.every(e=>e._def.typeName in e$&&(!e._def.checks||!e._def.checks.length))){let e=h.reduce((e,t)=>{let r=e$[t._def.typeName];return r&&!e.includes(r)?[...e,r]:e},[]);return{type:e.length>1?e:e[0]}}if(h.every(e=>"ZodLiteral"===e._def.typeName&&!e.description)){let e=h.reduce((e,t)=>{let r=typeof t._def.value;switch(r){case"string":case"number":case"boolean":return[...e,r];case"bigint":return[...e,"integer"];case"object":if(null===t._def.value)return[...e,"null"];default:return e}},[]);if(e.length===h.length){let t=e.filter((e,t,r)=>r.indexOf(e)===t);return{type:t.length>1?t:t[0],enum:h.reduce((e,t)=>e.includes(t._def.value)?e:[...e,t._def.value],[])}}}else if(h.every(e=>"ZodEnum"===e._def.typeName))return{type:"string",enum:h.reduce((e,t)=>[...e,...t._def.values.filter(t=>!e.includes(t))],[])};return a=e,o=r,(p=(a.options instanceof Map?Array.from(a.options.values()):a.options).map((e,t)=>eJ(e._def,{...o,currentPath:[...o.currentPath,"anyOf",`${t}`]})).filter(e=>!!e&&(!o.strictUnions||"object"==typeof e&&Object.keys(e).length>0))).length?{anyOf:p}:void 0;case G.ZodFirstPartyTypeKind.ZodIntersection:let g,m;return g=[eJ(e.left._def,{...r,currentPath:[...r.currentPath,"allOf","0"]}),eJ(e.right._def,{...r,currentPath:[...r.currentPath,"allOf","1"]})].filter(e=>!!e),m=[],g.forEach(e=>{if((!("type"in e)||"string"!==e.type)&&"allOf"in e)m.push(...e.allOf);else{let t=e;if("additionalProperties"in e&&!1===e.additionalProperties){let{additionalProperties:r,...a}=e;t=a}m.push(t)}}),m.length?{allOf:m}:void 0;case G.ZodFirstPartyTypeKind.ZodTuple:return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((e,t)=>eJ(e._def,{...r,currentPath:[...r.currentPath,"items",`${t}`]})).reduce((e,t)=>void 0===t?e:[...e,t],[]),additionalItems:eJ(e.rest._def,{...r,currentPath:[...r.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((e,t)=>eJ(e._def,{...r,currentPath:[...r.currentPath,"items",`${t}`]})).reduce((e,t)=>void 0===t?e:[...e,t],[])};case G.ZodFirstPartyTypeKind.ZodRecord:return eB(e,r);case G.ZodFirstPartyTypeKind.ZodLiteral:let y;return"bigint"!=(y=typeof e.value)&&"number"!==y&&"boolean"!==y&&"string"!==y?{type:Array.isArray(e.value)?"array":"object"}:{type:"bigint"===y?"integer":y,const:e.value};case G.ZodFirstPartyTypeKind.ZodEnum:return{type:"string",enum:Array.from(e.values)};case G.ZodFirstPartyTypeKind.ZodNativeEnum:let f,v,b;return f=e.values,{type:1===(b=Array.from(new Set((v=Object.keys(e.values).filter(e=>"number"!=typeof f[f[e]]).map(e=>f[e])).map(e=>typeof e)))).length?"string"===b[0]?"string":"number":["string","number"],enum:v};case G.ZodFirstPartyTypeKind.ZodNullable:if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return{type:[e$[e.innerType._def.typeName],"null"]};let I=eJ(e.innerType._def,{...r,currentPath:[...r.currentPath,"anyOf","0"]});return I&&{anyOf:[I,{type:"null"}]};case G.ZodFirstPartyTypeKind.ZodOptional:if(r.currentPath.toString()===(null==(l=r.propertyPath)?void 0:l.toString()))return eJ(e.innerType._def,r);let E=eJ(e.innerType._def,{...r,currentPath:[...r.currentPath,"anyOf","1"]});return E?{anyOf:[{not:{}},E]}:{};case G.ZodFirstPartyTypeKind.ZodMap:if("record"===r.mapStrategy)return eB(e,r);return{type:"array",maxItems:125,items:{type:"array",items:[eJ(e.keyType._def,{...r,currentPath:[...r.currentPath,"items","items","0"]})||{},eJ(e.valueType._def,{...r,currentPath:[...r.currentPath,"items","items","1"]})||{}],minItems:2,maxItems:2}};case G.ZodFirstPartyTypeKind.ZodSet:let w;return w={type:"array",uniqueItems:!0,items:eJ(e.valueType._def,{...r,currentPath:[...r.currentPath,"items"]})},e.minSize&&(w.minItems=e.minSize.value),e.maxSize&&(w.maxItems=e.maxSize.value),w;case G.ZodFirstPartyTypeKind.ZodLazy:return()=>e.getter()._def;case G.ZodFirstPartyTypeKind.ZodPromise:return eJ(e.type._def,r);case G.ZodFirstPartyTypeKind.ZodNaN:case G.ZodFirstPartyTypeKind.ZodNever:return{not:{}};case G.ZodFirstPartyTypeKind.ZodEffects:return"input"===r.effectStrategy?eJ(e.schema._def,r):{};case G.ZodFirstPartyTypeKind.ZodAny:case G.ZodFirstPartyTypeKind.ZodUnknown:return{};case G.ZodFirstPartyTypeKind.ZodDefault:return{...eJ(e.innerType._def,r),default:e.defaultValue()};case G.ZodFirstPartyTypeKind.ZodBranded:return eA(e,r);case G.ZodFirstPartyTypeKind.ZodReadonly:case G.ZodFirstPartyTypeKind.ZodCatch:return eJ(e.innerType._def,r);case G.ZodFirstPartyTypeKind.ZodPipeline:if("input"===r.pipeStrategy)return eJ(e.in._def,r);if("output"===r.pipeStrategy)return eJ(e.out._def,r);let T=eJ(e.in._def,{...r,currentPath:[...r.currentPath,"allOf","0"]}),A=eJ(e.out._def,{...r,currentPath:[...r.currentPath,"allOf",T?"1":"0"]});return{allOf:[T,A].filter(e=>void 0!==e)};case G.ZodFirstPartyTypeKind.ZodFunction:case G.ZodFirstPartyTypeKind.ZodVoid:case G.ZodFirstPartyTypeKind.ZodSymbol:default:return}})(e,e.typeName,t),n="function"==typeof i?eJ(i(),t):i;if(n&&eq(e,t,n),t.postProcess){let r=t.postProcess(n,e,t);return s.jsonSchema=n,r}return s.jsonSchema=n,n}var eH=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"relative":return{$ref:((e,t)=>{let r=0;for(;r<e.length&&r<t.length&&e[r]===t[r];r++);return[(e.length-r).toString(),...t.slice(r)].join("/")})(t.currentPath,e.path)};case"none":case"seen":if(e.path.length<t.currentPath.length&&e.path.every((e,r)=>t.currentPath[r]===e))return console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),{};return"seen"===t.$refStrategy?{}:void 0}},eq=(e,t,r)=>(e.description&&(r.description=e.description),r);function eG(e,t){var r,a;let o;if("_zod"in e){let a;return a=null!=(r=null==t?void 0:t.useReferences)&&r,eY(()=>q.toJSONSchema(e,{target:"draft-7",io:"output",reused:a?"ref":"inline"}),{validate:async t=>{let r=await H.safeParseAsync(e,t);return r.success?{success:!0,value:r.data}:{success:!1,error:r.error}}})}return o=null!=(a=null==t?void 0:t.useReferences)&&a,eY(()=>((e,t)=>{var r;let a,o,s=(o=void 0!==(a="string"==typeof t?{...eT,name:t}:{...eT,...t}).name?[...a.basePath,a.definitionPath,a.name]:a.basePath,{...a,currentPath:o,propertyPath:void 0,seen:new Map(Object.entries(a.definitions).map(e=>{let[t,r]=e;return[r._def,{def:r._def,path:[...a.basePath,a.definitionPath,t],jsonSchema:void 0}]}))}),i="object"==typeof t&&t.definitions?Object.entries(t.definitions).reduce((e,t)=>{var r;let[a,o]=t;return{...e,[a]:null!=(r=eJ(o._def,{...s,currentPath:[...s.basePath,s.definitionPath,a]},!0))?r:{}}},{}):void 0,n="string"==typeof t?t:(null==t?void 0:t.nameStrategy)==="title"||null==t?void 0:t.name,l=null!=(r=eJ(e._def,void 0===n?s:{...s,currentPath:[...s.basePath,s.definitionPath,n]},!1))?r:{},c="object"==typeof t&&void 0!==t.name&&"title"===t.nameStrategy?t.name:void 0;void 0!==c&&(l.title=c);let d=void 0===n?i?{...l,[s.definitionPath]:i}:l:{$ref:[..."relative"===s.$refStrategy?[]:s.basePath,s.definitionPath,n].join("/"),[s.definitionPath]:{...i,[n]:l}};return d.$schema="http://json-schema.org/draft-07/schema#",d})(e,{$refStrategy:o?"root":"none"}),{validate:async t=>{let r=await e.safeParseAsync(t);return r.success?{success:!0,value:r.data}:{success:!1,error:r.error}}})}var ez=Symbol.for("vercel.ai.schema");function eY(e){let{validate:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{[ez]:!0,_type:void 0,[ed]:!0,get jsonSchema(){return"function"==typeof e&&(e=e()),e},validate:t}}var{btoa:eW,atob:eQ}=globalThis;e.i(408667);var eX=q,e0=e.i(505248),e1=Symbol.for("vercel.ai.gateway.error"),e2=class e extends(r=Error,t=e1,r){constructor({message:e,statusCode:r=500,cause:a}){super(e),this[t]=!0,this.statusCode=r,this.cause=a}static isInstance(t){return e.hasMarker(t)}static hasMarker(e){return"object"==typeof e&&null!==e&&e1 in e&&!0===e[e1]}},e4="GatewayAuthenticationError",e9=Symbol.for(`vercel.ai.gateway.error.${e4}`),e5=class e extends(o=e2,a=e9,o){constructor({message:e="Authentication failed",statusCode:t=401,cause:r}={}){super({message:e,statusCode:t,cause:r}),this[a]=!0,this.name=e4,this.type="authentication_error"}static isInstance(e){return e2.hasMarker(e)&&e9 in e}static createContextualError(t){let{apiKeyProvided:r,oidcTokenProvided:a,message:o="Authentication failed",statusCode:s=401,cause:i}=t;return new e({message:r?`AI Gateway authentication failed: Invalid API key.

Create a new API key: https://vercel.com/d?to=%2F%5Bteam%5D%2F%7E%2Fai%2Fapi-keys

Provide via 'apiKey' option or 'AI_GATEWAY_API_KEY' environment variable.`:a?`AI Gateway authentication failed: Invalid OIDC token.

Run 'npx vercel link' to link your project, then 'vc env pull' to fetch the token.

Alternatively, use an API key: https://vercel.com/d?to=%2F%5Bteam%5D%2F%7E%2Fai%2Fapi-keys`:`AI Gateway authentication failed: No authentication provided.

Option 1 - API key:
Create an API key: https://vercel.com/d?to=%2F%5Bteam%5D%2F%7E%2Fai%2Fapi-keys
Provide via 'apiKey' option or 'AI_GATEWAY_API_KEY' environment variable.

Option 2 - OIDC token:
Run 'npx vercel link' to link your project, then 'vc env pull' to fetch the token.`,statusCode:s,cause:i})}},e6="GatewayInvalidRequestError",e8=Symbol.for(`vercel.ai.gateway.error.${e6}`),e7=class extends(i=e2,s=e8,i){constructor({message:e="Invalid request",statusCode:t=400,cause:r}={}){super({message:e,statusCode:t,cause:r}),this[s]=!0,this.name=e6,this.type="invalid_request_error"}static isInstance(e){return e2.hasMarker(e)&&e8 in e}},e3="GatewayRateLimitError",te=Symbol.for(`vercel.ai.gateway.error.${e3}`),tt=class extends(l=e2,n=te,l){constructor({message:e="Rate limit exceeded",statusCode:t=429,cause:r}={}){super({message:e,statusCode:t,cause:r}),this[n]=!0,this.name=e3,this.type="rate_limit_exceeded"}static isInstance(e){return e2.hasMarker(e)&&te in e}},tr="GatewayModelNotFoundError",ta=Symbol.for(`vercel.ai.gateway.error.${tr}`),to=eu(()=>eG(eX.object({modelId:eX.string()}))),ts=class extends(d=e2,c=ta,d){constructor({message:e="Model not found",statusCode:t=404,modelId:r,cause:a}={}){super({message:e,statusCode:t,cause:a}),this[c]=!0,this.name=tr,this.type="model_not_found",this.modelId=r}static isInstance(e){return e2.hasMarker(e)&&ta in e}},ti="GatewayInternalServerError",tn=Symbol.for(`vercel.ai.gateway.error.${ti}`),tl=class extends(p=e2,u=tn,p){constructor({message:e="Internal server error",statusCode:t=500,cause:r}={}){super({message:e,statusCode:t,cause:r}),this[u]=!0,this.name=ti,this.type="internal_server_error"}static isInstance(e){return e2.hasMarker(e)&&tn in e}},tc="GatewayResponseError",td=Symbol.for(`vercel.ai.gateway.error.${tc}`),tu=class extends(g=e2,h=td,g){constructor({message:e="Invalid response from Gateway",statusCode:t=502,response:r,validationError:a,cause:o}={}){super({message:e,statusCode:t,cause:o}),this[h]=!0,this.name=tc,this.type="response_error",this.response=r,this.validationError=a}static isInstance(e){return e2.hasMarker(e)&&td in e}};async function tp(e){let{response:t,statusCode:r,defaultMessage:a="Gateway request failed",cause:o,authMethod:s}=e,i=await eh({value:t,schema:th});if(!i.success)return new tu({message:`Invalid error response format: ${a}`,statusCode:r,response:t,validationError:i.error,cause:o});let n=i.value,l=n.error.type,c=n.error.message;switch(l){case"authentication_error":return e5.createContextualError({apiKeyProvided:"api-key"===s,oidcTokenProvided:"oidc"===s,statusCode:r,cause:o});case"invalid_request_error":return new e7({message:c,statusCode:r,cause:o});case"rate_limit_exceeded":return new tt({message:c,statusCode:r,cause:o});case"model_not_found":{let e=await eh({value:n.error.param,schema:to});return new ts({message:c,statusCode:r,modelId:e.success?e.value.modelId:void 0,cause:o})}default:return new tl({message:c,statusCode:r,cause:o})}}var th=eu(()=>eG(eX.object({error:eX.object({message:eX.string(),type:eX.string().nullish(),param:eX.unknown().nullish(),code:eX.union([eX.string(),eX.number()]).nullish()})})));function tg(e,t){var r;return e2.isInstance(e)?e:B.APICallError.isInstance(e)?tp({response:function(e){if(void 0!==e.data)return e.data;if(null!=e.responseBody)try{return JSON.parse(e.responseBody)}catch(t){return e.responseBody}return{}}(e),statusCode:null!=(r=e.statusCode)?r:500,defaultMessage:"Gateway request failed",cause:e,authMethod:t}):tp({response:{},statusCode:500,defaultMessage:e instanceof Error?`Gateway request failed: ${e.message}`:"Unknown Gateway error",cause:e,authMethod:t})}var tm="ai-gateway-auth-method";async function ty(e){let t=await eh({value:e[tm],schema:tf});return t.success?t.value:void 0}var tf=eu(()=>eG(eX.union([eX.literal("api-key"),eX.literal("oidc")]))),tv=class{constructor(e){this.config=e}async getAvailableModels(){try{let{value:e}=await es({url:`${this.config.baseURL}/config`,headers:await eb(this.config.headers()),successfulResponseHandler:eE(tb),failedResponseHandler:eI({errorSchema:eX.any(),errorToMessage:e=>e}),fetch:this.config.fetch});return e}catch(e){throw await tg(e)}}async getCredits(){try{let e=new URL(this.config.baseURL),{value:t}=await es({url:`${e.origin}/v1/credits`,headers:await eb(this.config.headers()),successfulResponseHandler:eE(tI),failedResponseHandler:eI({errorSchema:eX.any(),errorToMessage:e=>e}),fetch:this.config.fetch});return t}catch(e){throw await tg(e)}}},tb=eu(()=>eG(eX.object({models:eX.array(eX.object({id:eX.string(),name:eX.string(),description:eX.string().nullish(),pricing:eX.object({input:eX.string(),output:eX.string(),input_cache_read:eX.string().nullish(),input_cache_write:eX.string().nullish()}).transform(e=>{let{input:t,output:r,input_cache_read:a,input_cache_write:o}=e;return{input:t,output:r,...a?{cachedInputTokens:a}:{},...o?{cacheCreationInputTokens:o}:{}}}).nullish(),specification:eX.object({specificationVersion:eX.literal("v2"),provider:eX.string(),modelId:eX.string()}),modelType:eX.enum(["language","embedding","image"]).nullish()}))}))),tI=eu(()=>eG(eX.object({balance:eX.string(),total_used:eX.string()}).transform(e=>{let{balance:t,total_used:r}=e;return{balance:t,totalUsed:r}}))),tE=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v2",this.supportedUrls={"*/*":[/.*/]}}get provider(){return this.config.provider}async getArgs(e){let{abortSignal:t,...r}=e;return{args:this.maybeEncodeFileParts(r),warnings:[]}}async doGenerate(e){let{args:t,warnings:r}=await this.getArgs(e),{abortSignal:a}=e,o=await eb(this.config.headers());try{let{responseHeaders:s,value:i,rawValue:n}=await ef({url:this.getUrl(),headers:z(o,e.headers,this.getModelConfigHeaders(this.modelId,!1),await eb(this.config.o11yHeaders)),body:t,successfulResponseHandler:eE(eX.any()),failedResponseHandler:eI({errorSchema:eX.any(),errorToMessage:e=>e}),...a&&{abortSignal:a},fetch:this.config.fetch});return{...i,request:{body:t},response:{headers:s,body:n},warnings:r}}catch(e){throw await tg(e,await ty(o))}}async doStream(e){let{args:t,warnings:r}=await this.getArgs(e),{abortSignal:a}=e,o=await eb(this.config.headers());try{let s,{value:i,responseHeaders:n}=await ef({url:this.getUrl(),headers:z(o,e.headers,this.getModelConfigHeaders(this.modelId,!0),await eb(this.config.o11yHeaders)),body:t,successfulResponseHandler:(s=eX.any(),async e=>{let{response:t}=e,r=Y(t);if(null==t.body)throw new B.EmptyResponseBodyError({});return{responseHeaders:r,value:ey({stream:t.body,schema:s})}}),failedResponseHandler:eI({errorSchema:eX.any(),errorToMessage:e=>e}),...a&&{abortSignal:a},fetch:this.config.fetch});return{stream:i.pipeThrough(new TransformStream({start(e){r.length>0&&e.enqueue({type:"stream-start",warnings:r})},transform(t,r){if(t.success){let a=t.value;("raw"!==a.type||e.includeRawChunks)&&("response-metadata"===a.type&&a.timestamp&&"string"==typeof a.timestamp&&(a.timestamp=new Date(a.timestamp)),r.enqueue(a))}else r.error(t.error)}})),request:{body:t},response:{headers:n}}}catch(e){throw await tg(e,await ty(o))}}isFilePart(e){return e&&"object"==typeof e&&"type"in e&&"file"===e.type}maybeEncodeFileParts(e){for(let t of e.prompt)for(let e of t.content)if(this.isFilePart(e)&&e.data instanceof Uint8Array){let t=Uint8Array.from(e.data),r=U.Buffer.from(t).toString("base64");e.data=new URL(`data:${e.mediaType||"application/octet-stream"};base64,${r}`)}return e}getUrl(){return`${this.config.baseURL}/language-model`}getModelConfigHeaders(e,t){return{"ai-language-model-specification-version":"2","ai-language-model-id":e,"ai-language-model-streaming":String(t)}}},tw=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v2",this.maxEmbeddingsPerCall=2048,this.supportsParallelCalls=!0}get provider(){return this.config.provider}async doEmbed(e){var t;let{values:r,headers:a,abortSignal:o,providerOptions:s}=e,i=await eb(this.config.headers());try{let{responseHeaders:e,value:n,rawValue:l}=await ef({url:this.getUrl(),headers:z(i,null!=a?a:{},this.getModelConfigHeaders(),await eb(this.config.o11yHeaders)),body:{input:1===r.length?r[0]:r,...s?{providerOptions:s}:{}},successfulResponseHandler:eE(tT),failedResponseHandler:eI({errorSchema:eX.any(),errorToMessage:e=>e}),...o&&{abortSignal:o},fetch:this.config.fetch});return{embeddings:n.embeddings,usage:null!=(t=n.usage)?t:void 0,providerMetadata:n.providerMetadata,response:{headers:e,body:l}}}catch(e){throw await tg(e,await ty(i))}}getUrl(){return`${this.config.baseURL}/embedding-model`}getModelConfigHeaders(){return{"ai-embedding-model-specification-version":"2","ai-model-id":this.modelId}}},tT=eu(()=>eG(eX.object({embeddings:eX.array(eX.array(eX.number())),usage:eX.object({tokens:eX.number()}).nullish(),providerMetadata:eX.record(eX.string(),eX.record(eX.string(),eX.unknown())).optional()})));async function tA(){var e;return null==(e=(0,e0.getContext)().headers)?void 0:e["x-vercel-id"]}async function t_(e){let t=ei({settingValue:e.apiKey,environmentVariableName:"AI_GATEWAY_API_KEY"});if(t)return{token:t,authMethod:"api-key"};try{return{token:await (0,e0.getVercelOidcToken)(),authMethod:"oidc"}}catch(e){return null}}!function(){var e,t,r;let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=null,s=null,i=null!=(e=a.metadataCacheRefreshMillis)?e:3e5,n=0,l=null!=(t=null==(r=a.baseURL)?void 0:r.replace(/\/$/,""))?t:"https://ai-gateway.vercel.sh/v1/ai",c=async()=>{let e=await t_(a);if(e)return ea({Authorization:`Bearer ${e.token}`,"ai-gateway-protocol-version":"0.0.1",[tm]:e.authMethod,...a.headers},"ai-sdk/gateway/2.0.0");throw e5.createContextualError({apiKeyProvided:!1,oidcTokenProvided:!1,statusCode:401})},d=()=>{let e=ei({settingValue:void 0,environmentVariableName:"VERCEL_DEPLOYMENT_ID"}),t=ei({settingValue:void 0,environmentVariableName:"VERCEL_ENV"}),r=ei({settingValue:void 0,environmentVariableName:"VERCEL_REGION"});return async()=>{let a=await tA();return{...e&&{"ai-o11y-deployment-id":e},...t&&{"ai-o11y-environment":t},...r&&{"ai-o11y-region":r},...a&&{"ai-o11y-request-id":a}}}},u=e=>new tE(e,{provider:"gateway",baseURL:l,headers:c,fetch:a.fetch,o11yHeaders:d()}),p=async()=>new tv({baseURL:l,headers:c,fetch:a.fetch}).getCredits().catch(async e=>{throw await tg(e,await ty(await c()))}),h=function(e){if(new.target)throw Error("The Gateway Provider model function cannot be called with the new keyword.");return u(e)};h.getAvailableModels=async()=>{var e,t,r;let d=null!=(r=null==(t=null==(e=a._internal)?void 0:e.currentDate)?void 0:t.call(e).getTime())?r:Date.now();return(!o||d-n>i)&&(n=d,o=new tv({baseURL:l,headers:c,fetch:a.fetch}).getAvailableModels().then(e=>(s=e,e)).catch(async e=>{throw await tg(e,await ty(await c()))})),s?Promise.resolve(s):o},h.getCredits=p,h.imageModel=e=>{throw new B.NoSuchModelError({modelId:e,modelType:"imageModel"})},h.languageModel=u,h.textEmbeddingModel=e=>new tw(e,{provider:"gateway",baseURL:l,headers:c,fetch:a.fetch,o11yHeaders:d()})}();var tS=B,eX=q;e.i(4048866),e.i(6370374);var tk=Object.defineProperty,tx=Symbol.for("vercel.ai.error.AI_NoOutputSpecifiedError");tS.AISDKError;Symbol.for("vercel.ai.error.AI_InvalidArgumentError");tS.AISDKError;Symbol.for("vercel.ai.error.AI_InvalidStreamPartError");tS.AISDKError;Symbol.for("vercel.ai.error.AI_InvalidToolInputError");tS.AISDKError;Symbol.for("vercel.ai.error.AI_MCPClientError");tS.AISDKError;Symbol.for("vercel.ai.error.AI_NoImageGeneratedError");tS.AISDKError;var tR="AI_NoObjectGeneratedError",tM=`vercel.ai.error.${tR}`,tC=Symbol.for(tM),tj=class extends tS.AISDKError{constructor({message:e="No object generated.",cause:t,text:r,response:a,usage:o,finishReason:s}){super({name:tR,message:e,cause:t}),this[m]=!0,this.text=r,this.response=a,this.usage=o,this.finishReason=s}static isInstance(e){return tS.AISDKError.hasMarker(e,tM)}};m=tC;Symbol.for("vercel.ai.error.AI_NoOutputGeneratedError");tS.AISDKError,tS.AISDKError;Symbol.for("vercel.ai.error.AI_NoSuchToolError");tS.AISDKError;Symbol.for("vercel.ai.error.AI_ToolCallRepairError");tS.AISDKError,tS.AISDKError;Symbol.for("vercel.ai.error.AI_InvalidDataContentError");tS.AISDKError;Symbol.for("vercel.ai.error.AI_InvalidMessageRoleError");tS.AISDKError;Symbol.for("vercel.ai.error.AI_MessageConversionError");tS.AISDKError;Symbol.for("vercel.ai.error.AI_DownloadError");tS.AISDKError;Symbol.for("vercel.ai.error.AI_RetryError");tS.AISDKError;var tP="5.0.76",tO=eX.union([eX.string(),eX.instanceof(Uint8Array),eX.instanceof(ArrayBuffer),eX.custom(e=>{var t,r;return null!=(r=null==(t=globalThis.Buffer)?void 0:t.isBuffer(e))&&r},{message:"Must be a Buffer"})]),tN=eX.lazy(()=>eX.union([eX.null(),eX.string(),eX.number(),eX.boolean(),eX.record(eX.string(),tN),eX.array(tN)])),tD=eX.record(eX.string(),eX.record(eX.string(),tN)),tF=eX.object({type:eX.literal("text"),text:eX.string(),providerOptions:tD.optional()}),tK=eX.object({type:eX.literal("image"),image:eX.union([tO,eX.instanceof(URL)]),mediaType:eX.string().optional(),providerOptions:tD.optional()}),tZ=eX.object({type:eX.literal("file"),data:eX.union([tO,eX.instanceof(URL)]),filename:eX.string().optional(),mediaType:eX.string(),providerOptions:tD.optional()}),tL=eX.object({type:eX.literal("reasoning"),text:eX.string(),providerOptions:tD.optional()}),tV=eX.object({type:eX.literal("tool-call"),toolCallId:eX.string(),toolName:eX.string(),input:eX.unknown(),providerOptions:tD.optional(),providerExecuted:eX.boolean().optional()}),tU=eX.discriminatedUnion("type",[eX.object({type:eX.literal("text"),value:eX.string()}),eX.object({type:eX.literal("json"),value:tN}),eX.object({type:eX.literal("error-text"),value:eX.string()}),eX.object({type:eX.literal("error-json"),value:tN}),eX.object({type:eX.literal("content"),value:eX.array(eX.union([eX.object({type:eX.literal("text"),text:eX.string()}),eX.object({type:eX.literal("media"),data:eX.string(),mediaType:eX.string()})]))})]),tB=eX.object({type:eX.literal("tool-result"),toolCallId:eX.string(),toolName:eX.string(),output:tU,providerOptions:tD.optional()}),t$=eX.object({role:eX.literal("system"),content:eX.string(),providerOptions:tD.optional()}),tJ=eX.object({role:eX.literal("user"),content:eX.union([eX.string(),eX.array(eX.union([tF,tK,tZ]))]),providerOptions:tD.optional()}),tH=eX.object({role:eX.literal("assistant"),content:eX.union([eX.string(),eX.array(eX.union([tF,tZ,tL,tV,tB]))]),providerOptions:tD.optional()}),tq=eX.object({role:eX.literal("tool"),content:eX.array(tB),providerOptions:tD.optional()});eX.union([t$,tJ,tH,tq]),W({prefix:"aitxt",size:24}),TransformStream;var tG=eu(()=>eG(eX.union([eX.strictObject({type:eX.literal("text-start"),id:eX.string(),providerMetadata:tD.optional()}),eX.strictObject({type:eX.literal("text-delta"),id:eX.string(),delta:eX.string(),providerMetadata:tD.optional()}),eX.strictObject({type:eX.literal("text-end"),id:eX.string(),providerMetadata:tD.optional()}),eX.strictObject({type:eX.literal("error"),errorText:eX.string()}),eX.strictObject({type:eX.literal("tool-input-start"),toolCallId:eX.string(),toolName:eX.string(),providerExecuted:eX.boolean().optional(),dynamic:eX.boolean().optional()}),eX.strictObject({type:eX.literal("tool-input-delta"),toolCallId:eX.string(),inputTextDelta:eX.string()}),eX.strictObject({type:eX.literal("tool-input-available"),toolCallId:eX.string(),toolName:eX.string(),input:eX.unknown(),providerExecuted:eX.boolean().optional(),providerMetadata:tD.optional(),dynamic:eX.boolean().optional()}),eX.strictObject({type:eX.literal("tool-input-error"),toolCallId:eX.string(),toolName:eX.string(),input:eX.unknown(),providerExecuted:eX.boolean().optional(),providerMetadata:tD.optional(),dynamic:eX.boolean().optional(),errorText:eX.string()}),eX.strictObject({type:eX.literal("tool-output-available"),toolCallId:eX.string(),output:eX.unknown(),providerExecuted:eX.boolean().optional(),dynamic:eX.boolean().optional(),preliminary:eX.boolean().optional()}),eX.strictObject({type:eX.literal("tool-output-error"),toolCallId:eX.string(),errorText:eX.string(),providerExecuted:eX.boolean().optional(),dynamic:eX.boolean().optional()}),eX.strictObject({type:eX.literal("reasoning-start"),id:eX.string(),providerMetadata:tD.optional()}),eX.strictObject({type:eX.literal("reasoning-delta"),id:eX.string(),delta:eX.string(),providerMetadata:tD.optional()}),eX.strictObject({type:eX.literal("reasoning-end"),id:eX.string(),providerMetadata:tD.optional()}),eX.strictObject({type:eX.literal("source-url"),sourceId:eX.string(),url:eX.string(),title:eX.string().optional(),providerMetadata:tD.optional()}),eX.strictObject({type:eX.literal("source-document"),sourceId:eX.string(),mediaType:eX.string(),title:eX.string(),filename:eX.string().optional(),providerMetadata:tD.optional()}),eX.strictObject({type:eX.literal("file"),url:eX.string(),mediaType:eX.string(),providerMetadata:tD.optional()}),eX.strictObject({type:eX.custom(e=>"string"==typeof e&&e.startsWith("data-"),{message:'Type must start with "data-"'}),id:eX.string().optional(),data:eX.unknown(),transient:eX.boolean().optional()}),eX.strictObject({type:eX.literal("start-step")}),eX.strictObject({type:eX.literal("finish-step")}),eX.strictObject({type:eX.literal("start"),messageId:eX.string().optional(),messageMetadata:eX.unknown().optional()}),eX.strictObject({type:eX.literal("finish"),messageMetadata:eX.unknown().optional()}),eX.strictObject({type:eX.literal("abort")}),eX.strictObject({type:eX.literal("message-metadata"),messageMetadata:eX.unknown()})])));async function tz(e){if(void 0===e)return{value:void 0,state:"undefined-input"};let t=await em({text:e});return t.success?{value:t.value,state:"successful-parse"}:(t=await em({text:function(e){let t=["ROOT"],r=-1,a=null;function o(e,o,s){switch(e){case'"':r=o,t.pop(),t.push(s),t.push("INSIDE_STRING");break;case"f":case"t":case"n":r=o,a=o,t.pop(),t.push(s),t.push("INSIDE_LITERAL");break;case"-":t.pop(),t.push(s),t.push("INSIDE_NUMBER");break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":r=o,t.pop(),t.push(s),t.push("INSIDE_NUMBER");break;case"{":r=o,t.pop(),t.push(s),t.push("INSIDE_OBJECT_START");break;case"[":r=o,t.pop(),t.push(s),t.push("INSIDE_ARRAY_START")}}function s(e,a){switch(e){case",":t.pop(),t.push("INSIDE_OBJECT_AFTER_COMMA");break;case"}":r=a,t.pop()}}function i(e,a){switch(e){case",":t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break;case"]":r=a,t.pop()}}for(let n=0;n<e.length;n++){let l=e[n];switch(t[t.length-1]){case"ROOT":o(l,n,"FINISH");break;case"INSIDE_OBJECT_START":switch(l){case'"':t.pop(),t.push("INSIDE_OBJECT_KEY");break;case"}":r=n,t.pop()}break;case"INSIDE_OBJECT_AFTER_COMMA":'"'===l&&(t.pop(),t.push("INSIDE_OBJECT_KEY"));break;case"INSIDE_OBJECT_KEY":'"'===l&&(t.pop(),t.push("INSIDE_OBJECT_AFTER_KEY"));break;case"INSIDE_OBJECT_AFTER_KEY":":"===l&&(t.pop(),t.push("INSIDE_OBJECT_BEFORE_VALUE"));break;case"INSIDE_OBJECT_BEFORE_VALUE":o(l,n,"INSIDE_OBJECT_AFTER_VALUE");break;case"INSIDE_OBJECT_AFTER_VALUE":s(l,n);break;case"INSIDE_STRING":switch(l){case'"':t.pop(),r=n;break;case"\\":t.push("INSIDE_STRING_ESCAPE");break;default:r=n}break;case"INSIDE_ARRAY_START":"]"===l?(r=n,t.pop()):(r=n,o(l,n,"INSIDE_ARRAY_AFTER_VALUE"));break;case"INSIDE_ARRAY_AFTER_VALUE":switch(l){case",":t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break;case"]":r=n,t.pop();break;default:r=n}break;case"INSIDE_ARRAY_AFTER_COMMA":o(l,n,"INSIDE_ARRAY_AFTER_VALUE");break;case"INSIDE_STRING_ESCAPE":t.pop(),r=n;break;case"INSIDE_NUMBER":switch(l){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":r=n;break;case"e":case"E":case"-":case".":break;case",":t.pop(),"INSIDE_ARRAY_AFTER_VALUE"===t[t.length-1]&&i(l,n),"INSIDE_OBJECT_AFTER_VALUE"===t[t.length-1]&&s(l,n);break;case"}":t.pop(),"INSIDE_OBJECT_AFTER_VALUE"===t[t.length-1]&&s(l,n);break;case"]":t.pop(),"INSIDE_ARRAY_AFTER_VALUE"===t[t.length-1]&&i(l,n);break;default:t.pop()}break;case"INSIDE_LITERAL":{let o=e.substring(a,n+1);"false".startsWith(o)||"true".startsWith(o)||"null".startsWith(o)?r=n:(t.pop(),"INSIDE_OBJECT_AFTER_VALUE"===t[t.length-1]?s(l,n):"INSIDE_ARRAY_AFTER_VALUE"===t[t.length-1]&&i(l,n))}}}let n=e.slice(0,r+1);for(let r=t.length-1;r>=0;r--)switch(t[r]){case"INSIDE_STRING":n+='"';break;case"INSIDE_OBJECT_KEY":case"INSIDE_OBJECT_AFTER_KEY":case"INSIDE_OBJECT_AFTER_COMMA":case"INSIDE_OBJECT_START":case"INSIDE_OBJECT_BEFORE_VALUE":case"INSIDE_OBJECT_AFTER_VALUE":n+="}";break;case"INSIDE_ARRAY_START":case"INSIDE_ARRAY_AFTER_COMMA":case"INSIDE_ARRAY_AFTER_VALUE":n+="]";break;case"INSIDE_LITERAL":{let t=e.substring(a,e.length);"true".startsWith(t)?n+="true".slice(t.length):"false".startsWith(t)?n+="false".slice(t.length):"null".startsWith(t)&&(n+="null".slice(t.length))}}return n}(e)})).success?{value:t.value,state:"repaired-parse"}:{value:void 0,state:"failed-parse"}}function tY(e){return e.type.startsWith("tool-")}function tW(e){return tY(e)||"dynamic-tool"===e.type}function tQ(e){return e.type.split("-").slice(1).join("-")}async function tX(e){let{stream:t,onError:r}=e,a=t.getReader();try{for(;;){let{done:e}=await a.read();if(e)break}}catch(e){null==r||r(e)}finally{a.releaseLock()}}W({prefix:"aitxt",size:24}),W({prefix:"aiobj",size:24});var t0=class{constructor(){this.queue=[],this.isProcessing=!1}async processQueue(){if(!this.isProcessing){for(this.isProcessing=!0;this.queue.length>0;)await this.queue[0](),this.queue.shift();this.isProcessing=!1}}async run(e){return new Promise((t,r)=>{this.queue.push(async()=>{try{await e(),t()}catch(e){r(e)}}),this.processQueue()})}};W({prefix:"aiobj",size:24});var t1={},t2={object:()=>t5,text:()=>t9};for(var t4 in t2)tk(t1,t4,{get:t2[t4],enumerable:!0});var t9=()=>({type:"text",responseFormat:{type:"text"},async parsePartial(e){let{text:t}=e;return{partial:t}},async parseOutput(e){let{text:t}=e;return t}}),t5=e=>{let{schema:t}=e,r=null==t?eY({properties:{},additionalProperties:!1}):"object"==typeof t&&null!==t&&ez in t&&!0===t[ez]&&"jsonSchema"in t&&"validate"in t?t:"function"==typeof t?t():eG(t);return{type:"object",responseFormat:{type:"json",schema:r.jsonSchema},async parsePartial(e){let{text:t}=e,r=await tz(t);switch(r.state){case"failed-parse":case"undefined-input":return;case"repaired-parse":case"successful-parse":return{partial:r.value};default:{let e=r.state;throw Error(`Unsupported parse state: ${e}`)}}},async parseOutput(e,t){let{text:a}=e,o=await em({text:a});if(!o.success)throw new tj({message:"No object generated: could not parse the response.",cause:o.error,text:a,response:t.response,usage:t.usage,finishReason:t.finishReason});let s=await eh({value:o.value,schema:r});if(!s.success)throw new tj({message:"No object generated: response did not match schema.",cause:s.error,text:a,response:t.response,usage:t.usage,finishReason:t.finishReason});return s.value}}},t6=Symbol.for("vercel.ai.error.AI_NoSuchProviderError");tS.NoSuchModelError;var t8=eX.looseObject({name:eX.string(),version:eX.string()}),t7=eX.looseObject({_meta:eX.optional(eX.object({}).loose())}),t3=eX.object({method:eX.string(),params:eX.optional(t7)}),re=eX.looseObject({experimental:eX.optional(eX.object({}).loose()),logging:eX.optional(eX.object({}).loose()),prompts:eX.optional(eX.looseObject({listChanged:eX.optional(eX.boolean())})),resources:eX.optional(eX.looseObject({subscribe:eX.optional(eX.boolean()),listChanged:eX.optional(eX.boolean())})),tools:eX.optional(eX.looseObject({listChanged:eX.optional(eX.boolean())}))});t7.extend({protocolVersion:eX.string(),capabilities:re,serverInfo:t8,instructions:eX.optional(eX.string())});var rt=t7.extend({nextCursor:eX.optional(eX.string())}),rr=eX.object({name:eX.string(),description:eX.optional(eX.string()),inputSchema:eX.object({type:eX.literal("object"),properties:eX.optional(eX.object({}).loose())}).loose()}).loose();rt.extend({tools:eX.array(rr)});var ra=eX.object({type:eX.literal("text"),text:eX.string()}).loose(),ro=eX.object({type:eX.literal("image"),data:eX.base64(),mimeType:eX.string()}).loose(),rs=eX.object({uri:eX.string(),mimeType:eX.optional(eX.string())}).loose(),ri=rs.extend({text:eX.string()}),rn=rs.extend({blob:eX.base64()}),rl=eX.object({type:eX.literal("resource"),resource:eX.union([ri,rn])}).loose();t7.extend({content:eX.array(eX.union([ra,ro,rl])),isError:eX.boolean().default(!1).optional()}).or(t7.extend({toolResult:eX.unknown()}));var rc=eX.object({jsonrpc:eX.literal("2.0"),id:eX.union([eX.string(),eX.number().int()])}).merge(t3).strict(),rd=eX.object({jsonrpc:eX.literal("2.0"),id:eX.union([eX.string(),eX.number().int()]),result:t7}).strict(),ru=eX.object({jsonrpc:eX.literal("2.0"),id:eX.union([eX.string(),eX.number().int()]),error:eX.object({code:eX.number().int(),message:eX.string(),data:eX.optional(eX.unknown())})}).strict(),rp=eX.object({jsonrpc:eX.literal("2.0")}).merge(eX.object({method:eX.string(),params:eX.optional(t7)})).strict();async function rh(e){if(null==e)return[];if(!globalThis.FileList||!(e instanceof globalThis.FileList))throw Error("FileList is not supported in the current environment");return Promise.all(Array.from(e).map(async e=>{let{name:t,type:r}=e;return{type:"file",mediaType:r,filename:t,url:await new Promise((t,r)=>{let a=new FileReader;a.onload=e=>{var r;t(null==(r=e.target)?void 0:r.result)},a.onerror=e=>r(e),a.readAsDataURL(e)})}}))}eX.union([rc,rp,rd,ru]),tS.AISDKError;var rg=class{constructor({api:e="/api/chat",credentials:t,headers:r,body:a,fetch:o,prepareSendMessagesRequest:s,prepareReconnectToStreamRequest:i}){this.api=e,this.credentials=t,this.headers=r,this.body=a,this.fetch=o,this.prepareSendMessagesRequest=s,this.prepareReconnectToStreamRequest=i}async sendMessages(e){var t,r,a,o,s;let{abortSignal:i,...n}=e,l=await eb(this.body),c=await eb(this.headers),d=await eb(this.credentials),u=await (null==(t=this.prepareSendMessagesRequest)?void 0:t.call(this,{api:this.api,id:n.chatId,messages:n.messages,body:{...l,...n.body},headers:{...c,...n.headers},credentials:d,requestMetadata:n.metadata,trigger:n.trigger,messageId:n.messageId})),p=null!=(r=null==u?void 0:u.api)?r:this.api,h=(null==u?void 0:u.headers)!==void 0?u.headers:{...c,...n.headers},g=(null==u?void 0:u.body)!==void 0?u.body:{...l,...n.body,id:n.chatId,messages:n.messages,trigger:n.trigger,messageId:n.messageId},m=null!=(a=null==u?void 0:u.credentials)?a:d,y=null!=(o=this.fetch)?o:globalThis.fetch,f=await y(p,{method:"POST",headers:ea({"Content-Type":"application/json",...h},`ai-sdk/${tP}`,er()),body:JSON.stringify(g),credentials:m,signal:i});if(!f.ok)throw Error(null!=(s=await f.text())?s:"Failed to fetch the chat response.");if(!f.body)throw Error("The response body is empty.");return this.processResponseStream(f.body)}async reconnectToStream(e){var t,r,a,o,s;let i=await eb(this.body),n=await eb(this.headers),l=await eb(this.credentials),c=await (null==(t=this.prepareReconnectToStreamRequest)?void 0:t.call(this,{api:this.api,id:e.chatId,body:{...i,...e.body},headers:{...n,...e.headers},credentials:l,requestMetadata:e.metadata})),d=null!=(r=null==c?void 0:c.api)?r:`${this.api}/${e.chatId}/stream`,u=(null==c?void 0:c.headers)!==void 0?c.headers:{...n,...e.headers},p=null!=(a=null==c?void 0:c.credentials)?a:l,h=null!=(o=this.fetch)?o:globalThis.fetch,g=await h(d,{method:"GET",headers:ea(u,`ai-sdk/${tP}`,er()),credentials:p});if(204===g.status)return null;if(!g.ok)throw Error(null!=(s=await g.text())?s:"Failed to fetch the chat response.");if(!g.body)throw Error("The response body is empty.");return this.processResponseStream(g.body)}},rm=class extends rg{constructor(e={}){super(e)}processResponseStream(e){return ey({stream:e,schema:tG}).pipeThrough(new TransformStream({async transform(e,t){if(!e.success)throw e.error;t.enqueue(e.value)}}))}},ry=class{constructor({generateId:e=Q,id:t=e(),transport:r=new rm,messageMetadataSchema:a,dataPartSchemas:o,state:s,onError:i,onToolCall:n,onFinish:l,onData:c,sendAutomaticallyWhen:d}){var u=this;this.activeResponse=void 0,this.jobExecutor=new t0,this.sendMessage=async(e,t)=>{var r,a,o,s;let i;if(null==e)return void await this.makeRequest({trigger:"submit-message",messageId:null==(r=this.lastMessage)?void 0:r.id,...t});if(i="text"in e||"files"in e?{parts:[...Array.isArray(e.files)?e.files:await rh(e.files),..."text"in e&&null!=e.text?[{type:"text",text:e.text}]:[]]}:e,null!=e.messageId){let t=this.state.messages.findIndex(t=>t.id===e.messageId);if(-1===t)throw Error(`message with id ${e.messageId} not found`);if("user"!==this.state.messages[t].role)throw Error(`message with id ${e.messageId} is not a user message`);this.state.messages=this.state.messages.slice(0,t+1),this.state.replaceMessage(t,{...i,id:e.messageId,role:null!=(a=i.role)?a:"user",metadata:e.metadata})}else this.state.pushMessage({...i,id:null!=(o=i.id)?o:this.generateId(),role:null!=(s=i.role)?s:"user",metadata:e.metadata});await this.makeRequest({trigger:"submit-message",messageId:e.messageId,...t})},this.regenerate=async function(){let{messageId:e,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=null==e?u.state.messages.length-1:u.state.messages.findIndex(t=>t.id===e);if(-1===r)throw Error(`message ${e} not found`);u.state.messages=u.state.messages.slice(0,"assistant"===u.messages[r].role?r:r+1),await u.makeRequest({trigger:"regenerate-message",messageId:e,...t})},this.resumeStream=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};await u.makeRequest({trigger:"resume-stream",...e})},this.clearError=()=>{"error"===this.status&&(this.state.error=void 0,this.setStatus({status:"ready"}))},this.addToolResult=async e=>{let{state:t="output-available",tool:r,toolCallId:a,output:o,errorText:s}=e;return this.jobExecutor.run(async()=>{var e,r;let i=this.state.messages,n=i[i.length-1];this.state.replaceMessage(i.length-1,{...n,parts:n.parts.map(e=>tW(e)&&e.toolCallId===a?{...e,state:t,output:o,errorText:s}:e)}),this.activeResponse&&(this.activeResponse.state.message.parts=this.activeResponse.state.message.parts.map(e=>tW(e)&&e.toolCallId===a?{...e,state:t,output:o,errorText:s}:e)),"streaming"!==this.status&&"submitted"!==this.status&&(null==(e=this.sendAutomaticallyWhen)?void 0:e.call(this,{messages:this.state.messages}))&&this.makeRequest({trigger:"submit-message",messageId:null==(r=this.lastMessage)?void 0:r.id})})},this.stop=async()=>{var e;("streaming"===this.status||"submitted"===this.status)&&(null==(e=this.activeResponse)?void 0:e.abortController)&&this.activeResponse.abortController.abort()},this.id=t,this.transport=r,this.generateId=e,this.messageMetadataSchema=a,this.dataPartSchemas=o,this.state=s,this.onError=i,this.onToolCall=n,this.onFinish=l,this.onData=c,this.sendAutomaticallyWhen=d}get status(){return this.state.status}setStatus(e){let{status:t,error:r}=e;this.status!==t&&(this.state.status=t,this.state.error=r)}get error(){return this.state.error}get messages(){return this.state.messages}get lastMessage(){return this.state.messages[this.state.messages.length-1]}set messages(e){this.state.messages=e}async makeRequest(e){var t,r,a;let{trigger:o,metadata:s,headers:i,body:n,messageId:l}=e;this.setStatus({status:"submitted",error:void 0});let c=this.lastMessage,d=!1,u=!1,p=!1;try{let e,t={state:function(e){let{lastMessage:t,messageId:r}=e;return{message:(null==t?void 0:t.role)==="assistant"?t:{id:r,metadata:void 0,role:"assistant",parts:[]},activeTextParts:{},activeReasoningParts:{},partialToolCalls:{}}}({lastMessage:this.state.snapshot(c),messageId:this.generateId()}),abortController:new AbortController};if(t.abortController.signal.addEventListener("abort",()=>{d=!0}),this.activeResponse=t,"resume-stream"===o){let t=await this.transport.reconnectToStream({chatId:this.id,metadata:s,headers:i,body:n});if(null==t)return void this.setStatus({status:"ready"});e=t}else e=await this.transport.sendMessages({chatId:this.id,messages:this.state.messages,abortSignal:t.abortController.signal,metadata:s,headers:i,body:n,trigger:o,messageId:l});let r=e=>this.jobExecutor.run(()=>e({state:t.state,write:()=>{var e;this.setStatus({status:"streaming"}),t.state.message.id===(null==(e=this.lastMessage)?void 0:e.id)?this.state.replaceMessage(this.state.messages.length-1,t.state.message):this.state.pushMessage(t.state.message)}}));await tX({stream:function(e){let{stream:t,messageMetadataSchema:r,dataPartSchemas:a,runUpdateMessageJob:o,onError:s,onToolCall:i,onData:n}=e;return t.pipeThrough(new TransformStream({async transform(e,t){await o(async o=>{var l,c,d,u;let{state:p,write:h}=o;function g(e){let t=p.message.parts.filter(tY).find(t=>t.toolCallId===e);if(null==t)throw Error("tool-output-error must be preceded by a tool-input-available");return t}function m(e){let t=p.message.parts.filter(e=>"dynamic-tool"===e.type).find(t=>t.toolCallId===e);if(null==t)throw Error("tool-output-error must be preceded by a tool-input-available");return t}function y(e){var t;let r=p.message.parts.find(t=>tY(t)&&t.toolCallId===e.toolCallId);null!=r?(r.state=e.state,r.input=e.input,r.output=e.output,r.errorText=e.errorText,r.rawInput=e.rawInput,r.preliminary=e.preliminary,r.providerExecuted=null!=(t=e.providerExecuted)?t:r.providerExecuted,null!=e.providerMetadata&&"input-available"===r.state&&(r.callProviderMetadata=e.providerMetadata)):p.message.parts.push({type:`tool-${e.toolName}`,toolCallId:e.toolCallId,state:e.state,input:e.input,output:e.output,rawInput:e.rawInput,errorText:e.errorText,providerExecuted:e.providerExecuted,preliminary:e.preliminary,...null!=e.providerMetadata?{callProviderMetadata:e.providerMetadata}:{}})}function f(e){var t;let r=p.message.parts.find(t=>"dynamic-tool"===t.type&&t.toolCallId===e.toolCallId);null!=r?(r.state=e.state,r.toolName=e.toolName,r.input=e.input,r.output=e.output,r.errorText=e.errorText,r.rawInput=null!=(t=e.rawInput)?t:r.rawInput,r.preliminary=e.preliminary,null!=e.providerMetadata&&"input-available"===r.state&&(r.callProviderMetadata=e.providerMetadata)):p.message.parts.push({type:"dynamic-tool",toolName:e.toolName,toolCallId:e.toolCallId,state:e.state,input:e.input,output:e.output,errorText:e.errorText,preliminary:e.preliminary,...null!=e.providerMetadata?{callProviderMetadata:e.providerMetadata}:{}})}async function v(e){if(null!=e){let t=null!=p.message.metadata?function e(t,r){if(void 0===t&&void 0===r)return;if(void 0===t)return r;if(void 0===r)return t;let a={...t};for(let o in r)if(Object.prototype.hasOwnProperty.call(r,o)){let s=r[o];if(void 0===s)continue;let i=o in t?t[o]:void 0,n=null!==s&&"object"==typeof s&&!Array.isArray(s)&&!(s instanceof Date)&&!(s instanceof RegExp),l=null!=i&&"object"==typeof i&&!Array.isArray(i)&&!(i instanceof Date)&&!(i instanceof RegExp);n&&l?a[o]=e(i,s):a[o]=s}return a}(p.message.metadata,e):e;null!=r&&await ep({value:t,schema:r}),p.message.metadata=t}}switch(e.type){case"text-start":{let t={type:"text",text:"",providerMetadata:e.providerMetadata,state:"streaming"};p.activeTextParts[e.id]=t,p.message.parts.push(t),h();break}case"text-delta":{let t=p.activeTextParts[e.id];t.text+=e.delta,t.providerMetadata=null!=(l=e.providerMetadata)?l:t.providerMetadata,h();break}case"text-end":{let t=p.activeTextParts[e.id];t.state="done",t.providerMetadata=null!=(c=e.providerMetadata)?c:t.providerMetadata,delete p.activeTextParts[e.id],h();break}case"reasoning-start":{let t={type:"reasoning",text:"",providerMetadata:e.providerMetadata,state:"streaming"};p.activeReasoningParts[e.id]=t,p.message.parts.push(t),h();break}case"reasoning-delta":{let t=p.activeReasoningParts[e.id];t.text+=e.delta,t.providerMetadata=null!=(d=e.providerMetadata)?d:t.providerMetadata,h();break}case"reasoning-end":{let t=p.activeReasoningParts[e.id];t.providerMetadata=null!=(u=e.providerMetadata)?u:t.providerMetadata,t.state="done",delete p.activeReasoningParts[e.id],h();break}case"file":p.message.parts.push({type:"file",mediaType:e.mediaType,url:e.url}),h();break;case"source-url":p.message.parts.push({type:"source-url",sourceId:e.sourceId,url:e.url,title:e.title,providerMetadata:e.providerMetadata}),h();break;case"source-document":p.message.parts.push({type:"source-document",sourceId:e.sourceId,mediaType:e.mediaType,title:e.title,filename:e.filename,providerMetadata:e.providerMetadata}),h();break;case"tool-input-start":{let t=p.message.parts.filter(tY);p.partialToolCalls[e.toolCallId]={text:"",toolName:e.toolName,index:t.length,dynamic:e.dynamic},e.dynamic?f({toolCallId:e.toolCallId,toolName:e.toolName,state:"input-streaming",input:void 0}):y({toolCallId:e.toolCallId,toolName:e.toolName,state:"input-streaming",input:void 0,providerExecuted:e.providerExecuted}),h();break}case"tool-input-delta":{let t=p.partialToolCalls[e.toolCallId];t.text+=e.inputTextDelta;let{value:r}=await tz(t.text);t.dynamic?f({toolCallId:e.toolCallId,toolName:t.toolName,state:"input-streaming",input:r}):y({toolCallId:e.toolCallId,toolName:t.toolName,state:"input-streaming",input:r}),h();break}case"tool-input-available":e.dynamic?f({toolCallId:e.toolCallId,toolName:e.toolName,state:"input-available",input:e.input,providerMetadata:e.providerMetadata}):y({toolCallId:e.toolCallId,toolName:e.toolName,state:"input-available",input:e.input,providerExecuted:e.providerExecuted,providerMetadata:e.providerMetadata}),h(),i&&!e.providerExecuted&&await i({toolCall:e});break;case"tool-input-error":e.dynamic?f({toolCallId:e.toolCallId,toolName:e.toolName,state:"output-error",input:e.input,errorText:e.errorText,providerMetadata:e.providerMetadata}):y({toolCallId:e.toolCallId,toolName:e.toolName,state:"output-error",input:void 0,rawInput:e.input,errorText:e.errorText,providerExecuted:e.providerExecuted,providerMetadata:e.providerMetadata}),h();break;case"tool-output-available":if(e.dynamic){let t=m(e.toolCallId);f({toolCallId:e.toolCallId,toolName:t.toolName,state:"output-available",input:t.input,output:e.output,preliminary:e.preliminary})}else{let t=g(e.toolCallId);y({toolCallId:e.toolCallId,toolName:tQ(t),state:"output-available",input:t.input,output:e.output,providerExecuted:e.providerExecuted,preliminary:e.preliminary})}h();break;case"tool-output-error":if(e.dynamic){let t=m(e.toolCallId);f({toolCallId:e.toolCallId,toolName:t.toolName,state:"output-error",input:t.input,errorText:e.errorText})}else{let t=g(e.toolCallId);y({toolCallId:e.toolCallId,toolName:tQ(t),state:"output-error",input:t.input,rawInput:t.rawInput,errorText:e.errorText})}h();break;case"start-step":p.message.parts.push({type:"step-start"});break;case"finish-step":p.activeTextParts={},p.activeReasoningParts={};break;case"start":null!=e.messageId&&(p.message.id=e.messageId),await v(e.messageMetadata),(null!=e.messageId||null!=e.messageMetadata)&&h();break;case"finish":case"message-metadata":await v(e.messageMetadata),null!=e.messageMetadata&&h();break;case"error":null==s||s(Error(e.errorText));break;default:if(e.type.startsWith("data-")){if((null==a?void 0:a[e.type])!=null&&await ep({value:e.data,schema:a[e.type]}),e.transient){null==n||n(e);break}let t=null!=e.id?p.message.parts.find(t=>e.type===t.type&&e.id===t.id):void 0;null!=t?t.data=e.data:p.message.parts.push(e),null==n||n(e),h()}}t.enqueue(e)})}}))}({stream:e,onToolCall:this.onToolCall,onData:this.onData,messageMetadataSchema:this.messageMetadataSchema,dataPartSchemas:this.dataPartSchemas,runUpdateMessageJob:r,onError:e=>{throw e}}),onError:e=>{throw e}}),this.setStatus({status:"ready"})}catch(e){if(d||"AbortError"===e.name)return d=!0,this.setStatus({status:"ready"}),null;p=!0,e instanceof TypeError&&(e.message.toLowerCase().includes("fetch")||e.message.toLowerCase().includes("network"))&&(u=!0),this.onError&&e instanceof Error&&this.onError(e),this.setStatus({status:"error",error:e})}finally{try{null==(t=this.onFinish)||t.call(this,{message:this.activeResponse.state.message,messages:this.state.messages,isAbort:d,isDisconnect:u,isError:p})}catch(e){console.error(e)}this.activeResponse=void 0}(null==(r=this.sendAutomaticallyWhen)?void 0:r.call(this,{messages:this.state.messages}))&&!p&&await this.makeRequest({trigger:"submit-message",messageId:null==(a=this.lastMessage)?void 0:a.id,metadata:s,headers:i,body:n})}};eu(()=>eG(eX.array(eX.object({id:eX.string(),role:eX.enum(["system","user","assistant"]),metadata:eX.unknown().optional(),parts:eX.array(eX.union([eX.object({type:eX.literal("text"),text:eX.string(),state:eX.enum(["streaming","done"]).optional(),providerMetadata:tD.optional()}),eX.object({type:eX.literal("reasoning"),text:eX.string(),state:eX.enum(["streaming","done"]).optional(),providerMetadata:tD.optional()}),eX.object({type:eX.literal("source-url"),sourceId:eX.string(),url:eX.string(),title:eX.string().optional(),providerMetadata:tD.optional()}),eX.object({type:eX.literal("source-document"),sourceId:eX.string(),mediaType:eX.string(),title:eX.string(),filename:eX.string().optional(),providerMetadata:tD.optional()}),eX.object({type:eX.literal("file"),mediaType:eX.string(),filename:eX.string().optional(),url:eX.string(),providerMetadata:tD.optional()}),eX.object({type:eX.literal("step-start")}),eX.object({type:eX.string().startsWith("data-"),id:eX.string().optional(),data:eX.unknown()}),eX.object({type:eX.literal("dynamic-tool"),toolName:eX.string(),toolCallId:eX.string(),state:eX.literal("input-streaming"),input:eX.unknown().optional(),output:eX.never().optional(),errorText:eX.never().optional()}),eX.object({type:eX.literal("dynamic-tool"),toolName:eX.string(),toolCallId:eX.string(),state:eX.literal("input-available"),input:eX.unknown(),output:eX.never().optional(),errorText:eX.never().optional(),callProviderMetadata:tD.optional()}),eX.object({type:eX.literal("dynamic-tool"),toolName:eX.string(),toolCallId:eX.string(),state:eX.literal("output-available"),input:eX.unknown(),output:eX.unknown(),errorText:eX.never().optional(),callProviderMetadata:tD.optional(),preliminary:eX.boolean().optional()}),eX.object({type:eX.literal("dynamic-tool"),toolName:eX.string(),toolCallId:eX.string(),state:eX.literal("output-error"),input:eX.unknown(),output:eX.never().optional(),errorText:eX.string(),callProviderMetadata:tD.optional()}),eX.object({type:eX.string().startsWith("tool-"),toolCallId:eX.string(),state:eX.literal("input-streaming"),providerExecuted:eX.boolean().optional(),input:eX.unknown().optional(),output:eX.never().optional(),errorText:eX.never().optional(),approval:eX.never().optional()}),eX.object({type:eX.string().startsWith("tool-"),toolCallId:eX.string(),state:eX.literal("input-available"),providerExecuted:eX.boolean().optional(),input:eX.unknown(),output:eX.never().optional(),errorText:eX.never().optional(),callProviderMetadata:tD.optional(),approval:eX.never().optional()}),eX.object({type:eX.string().startsWith("tool-"),toolCallId:eX.string(),state:eX.literal("approval-requested"),input:eX.unknown(),providerExecuted:eX.boolean().optional(),output:eX.never().optional(),errorText:eX.never().optional(),callProviderMetadata:tD.optional(),approval:eX.object({id:eX.string(),approved:eX.never().optional(),reason:eX.never().optional()})}),eX.object({type:eX.string().startsWith("tool-"),toolCallId:eX.string(),state:eX.literal("approval-responded"),input:eX.unknown(),providerExecuted:eX.boolean().optional(),output:eX.never().optional(),errorText:eX.never().optional(),callProviderMetadata:tD.optional(),approval:eX.object({id:eX.string(),approved:eX.boolean(),reason:eX.string().optional()})}),eX.object({type:eX.string().startsWith("tool-"),toolCallId:eX.string(),state:eX.literal("output-available"),providerExecuted:eX.boolean().optional(),input:eX.unknown(),output:eX.unknown(),errorText:eX.never().optional(),callProviderMetadata:tD.optional(),preliminary:eX.boolean().optional(),approval:eX.object({id:eX.string(),approved:eX.literal(!0),reason:eX.string().optional()}).optional()}),eX.object({type:eX.string().startsWith("tool-"),toolCallId:eX.string(),state:eX.literal("output-error"),providerExecuted:eX.boolean().optional(),input:eX.unknown(),output:eX.never().optional(),errorText:eX.string(),callProviderMetadata:tD.optional(),approval:eX.object({id:eX.string(),approved:eX.literal(!0),reason:eX.string().optional()}).optional()}),eX.object({type:eX.string().startsWith("tool-"),toolCallId:eX.string(),state:eX.literal("output-denied"),providerExecuted:eX.boolean().optional(),input:eX.unknown(),output:eX.never().optional(),errorText:eX.never().optional(),callProviderMetadata:tD.optional(),approval:eX.object({id:eX.string(),approved:eX.literal(!1),reason:eX.string().optional()})})]))}))));var rf=e.i(7561030);e.i(2405338);var rv=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)},rb=(e,t,r)=>(rv(e,t,"read from private field"),r?r.call(e):t.get(e)),rI=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},rE=(e,t,r,a)=>(rv(e,t,"write to private field"),a?a.call(e,r):t.set(e,r),r),rw=class{constructor(e=[]){rI(this,y,void 0),rI(this,f,"ready"),rI(this,v,void 0),rI(this,b,new Set),rI(this,I,new Set),rI(this,E,new Set),this.pushMessage=e=>{rE(this,y,rb(this,y).concat(e)),rb(this,w).call(this)},this.popMessage=()=>{rE(this,y,rb(this,y).slice(0,-1)),rb(this,w).call(this)},this.replaceMessage=(e,t)=>{rE(this,y,[...rb(this,y).slice(0,e),this.snapshot(t),...rb(this,y).slice(e+1)]),rb(this,w).call(this)},this.snapshot=e=>structuredClone(e),this["~registerMessagesCallback"]=(e,t)=>{let r=t?null!=t?(0,rf.default)(e,t):e:e;return rb(this,b).add(r),()=>{rb(this,b).delete(r)}},this["~registerStatusCallback"]=e=>(rb(this,I).add(e),()=>{rb(this,I).delete(e)}),this["~registerErrorCallback"]=e=>(rb(this,E).add(e),()=>{rb(this,E).delete(e)}),rI(this,w,()=>{rb(this,b).forEach(e=>e())}),rI(this,T,()=>{rb(this,I).forEach(e=>e())}),rI(this,A,()=>{rb(this,E).forEach(e=>e())}),rE(this,y,e)}get status(){return rb(this,f)}set status(e){rE(this,f,e),rb(this,T).call(this)}get error(){return rb(this,v)}set error(e){rE(this,v,e),rb(this,A).call(this)}get messages(){return rb(this,y)}set messages(e){rE(this,y,[...e]),rb(this,w).call(this)}};y=new WeakMap,f=new WeakMap,v=new WeakMap,b=new WeakMap,I=new WeakMap,E=new WeakMap,w=new WeakMap,T=new WeakMap,A=new WeakMap;var rT=class extends ry{constructor({messages:e,...t}){const r=new rw(e);super({...t,state:r}),rI(this,_,void 0),this["~registerMessagesCallback"]=(e,t)=>rb(this,_)["~registerMessagesCallback"](e,t),this["~registerStatusCallback"]=e=>rb(this,_)["~registerStatusCallback"](e),this["~registerErrorCallback"]=e=>rb(this,_)["~registerErrorCallback"](e),rE(this,_,r)}};function rA(){let{experimental_throttle:e,resume:t=!1,...r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,V.useRef)("chat"in r?r.chat:new rT(r));("chat"in r&&r.chat!==a.current||"id"in r&&a.current.id!==r.id)&&(a.current="chat"in r?r.chat:new rT(r));let o="id"in r?r.id:null,s=(0,V.useCallback)(t=>a.current["~registerMessagesCallback"](t,e),[e,o]),i=(0,V.useSyncExternalStore)(s,()=>a.current.messages,()=>a.current.messages),n=(0,V.useSyncExternalStore)(a.current["~registerStatusCallback"],()=>a.current.status,()=>a.current.status),l=(0,V.useSyncExternalStore)(a.current["~registerErrorCallback"],()=>a.current.error,()=>a.current.error),c=(0,V.useCallback)(e=>{"function"==typeof e&&(e=e(a.current.messages)),a.current.messages=e},[a]);return(0,V.useEffect)(()=>{t&&a.current.resumeStream()},[t,a]),{id:a.current.id,messages:i,setMessages:c,sendMessage:a.current.sendMessage,regenerate:a.current.regenerate,clearError:a.current.clearError,stop:a.current.stop,error:l,resumeStream:a.current.resumeStream,status:n,addToolResult:a.current.addToolResult}}_=new WeakMap,e.s(["useChat",()=>rA],9854108);var r_=e.i(7034926),eX=q,rS=Symbol.for("vercel.ai.gateway.error"),rk=class e extends(k=Error,S=rS,k){constructor({message:e,statusCode:t=500,cause:r}){super(e),this[S]=!0,this.statusCode=t,this.cause=r}static isInstance(t){return e.hasMarker(t)}static hasMarker(e){return"object"==typeof e&&null!==e&&rS in e&&!0===e[rS]}},rx="GatewayAuthenticationError",rR=Symbol.for(`vercel.ai.gateway.error.${rx}`),rM=class e extends(R=rk,x=rR,R){constructor({message:e="Authentication failed",statusCode:t=401,cause:r}={}){super({message:e,statusCode:t,cause:r}),this[x]=!0,this.name=rx,this.type="authentication_error"}static isInstance(e){return rk.hasMarker(e)&&rR in e}static createContextualError(t){let{apiKeyProvided:r,oidcTokenProvided:a,message:o="Authentication failed",statusCode:s=401,cause:i}=t;return new e({message:r?`AI Gateway authentication failed: Invalid API key.

Create a new API key: https://vercel.com/d?to=%2F%5Bteam%5D%2F%7E%2Fai%2Fapi-keys

Provide via 'apiKey' option or 'AI_GATEWAY_API_KEY' environment variable.`:a?`AI Gateway authentication failed: Invalid OIDC token.

Run 'npx vercel link' to link your project, then 'vc env pull' to fetch the token.

Alternatively, use an API key: https://vercel.com/d?to=%2F%5Bteam%5D%2F%7E%2Fai%2Fapi-keys`:`AI Gateway authentication failed: No authentication provided.

Option 1 - API key:
Create an API key: https://vercel.com/d?to=%2F%5Bteam%5D%2F%7E%2Fai%2Fapi-keys
Provide via 'apiKey' option or 'AI_GATEWAY_API_KEY' environment variable.

Option 2 - OIDC token:
Run 'npx vercel link' to link your project, then 'vc env pull' to fetch the token.`,statusCode:s,cause:i})}},rC="GatewayInvalidRequestError",rj=Symbol.for(`vercel.ai.gateway.error.${rC}`),rP=class extends(C=rk,M=rj,C){constructor({message:e="Invalid request",statusCode:t=400,cause:r}={}){super({message:e,statusCode:t,cause:r}),this[M]=!0,this.name=rC,this.type="invalid_request_error"}static isInstance(e){return rk.hasMarker(e)&&rj in e}},rO="GatewayRateLimitError",rN=Symbol.for(`vercel.ai.gateway.error.${rO}`),rD=class extends(P=rk,j=rN,P){constructor({message:e="Rate limit exceeded",statusCode:t=429,cause:r}={}){super({message:e,statusCode:t,cause:r}),this[j]=!0,this.name=rO,this.type="rate_limit_exceeded"}static isInstance(e){return rk.hasMarker(e)&&rN in e}},rF="GatewayModelNotFoundError",rK=Symbol.for(`vercel.ai.gateway.error.${rF}`),rZ=(0,r_.lazyValidator)(()=>(0,r_.zodSchema)(eX.object({modelId:eX.string()}))),rL=class extends(N=rk,O=rK,N){constructor({message:e="Model not found",statusCode:t=404,modelId:r,cause:a}={}){super({message:e,statusCode:t,cause:a}),this[O]=!0,this.name=rF,this.type="model_not_found",this.modelId=r}static isInstance(e){return rk.hasMarker(e)&&rK in e}},rV="GatewayInternalServerError",rU=Symbol.for(`vercel.ai.gateway.error.${rV}`),rB=class extends(F=rk,D=rU,F){constructor({message:e="Internal server error",statusCode:t=500,cause:r}={}){super({message:e,statusCode:t,cause:r}),this[D]=!0,this.name=rV,this.type="internal_server_error"}static isInstance(e){return rk.hasMarker(e)&&rU in e}},r$="GatewayResponseError",rJ=Symbol.for(`vercel.ai.gateway.error.${r$}`),rH=class extends(Z=rk,K=rJ,Z){constructor({message:e="Invalid response from Gateway",statusCode:t=502,response:r,validationError:a,cause:o}={}){super({message:e,statusCode:t,cause:o}),this[K]=!0,this.name=r$,this.type="response_error",this.response=r,this.validationError=a}static isInstance(e){return rk.hasMarker(e)&&rJ in e}};async function rq(e){let{response:t,statusCode:r,defaultMessage:a="Gateway request failed",cause:o,authMethod:s}=e,i=await (0,r_.safeValidateTypes)({value:t,schema:rG});if(!i.success)return new rH({message:`Invalid error response format: ${a}`,statusCode:r,response:t,validationError:i.error,cause:o});let n=i.value,l=n.error.type,c=n.error.message;switch(l){case"authentication_error":return rM.createContextualError({apiKeyProvided:"api-key"===s,oidcTokenProvided:"oidc"===s,statusCode:r,cause:o});case"invalid_request_error":return new rP({message:c,statusCode:r,cause:o});case"rate_limit_exceeded":return new rD({message:c,statusCode:r,cause:o});case"model_not_found":{let e=await (0,r_.safeValidateTypes)({value:n.error.param,schema:rZ});return new rL({message:c,statusCode:r,modelId:e.success?e.value.modelId:void 0,cause:o})}default:return new rB({message:c,statusCode:r,cause:o})}}var rG=(0,r_.lazyValidator)(()=>(0,r_.zodSchema)(eX.object({error:eX.object({message:eX.string(),type:eX.string().nullish(),param:eX.unknown().nullish(),code:eX.union([eX.string(),eX.number()]).nullish()})})));function rz(e,t){var r;return rk.isInstance(e)?e:B.APICallError.isInstance(e)?rq({response:function(e){if(void 0!==e.data)return e.data;if(null!=e.responseBody)try{return JSON.parse(e.responseBody)}catch(t){return e.responseBody}return{}}(e),statusCode:null!=(r=e.statusCode)?r:500,defaultMessage:"Gateway request failed",cause:e,authMethod:t}):rq({response:{},statusCode:500,defaultMessage:e instanceof Error?`Gateway request failed: ${e.message}`:"Unknown Gateway error",cause:e,authMethod:t})}var rY="ai-gateway-auth-method";async function rW(e){let t=await (0,r_.safeValidateTypes)({value:e[rY],schema:rQ});return t.success?t.value:void 0}var rQ=(0,r_.lazyValidator)(()=>(0,r_.zodSchema)(eX.union([eX.literal("api-key"),eX.literal("oidc")]))),rX=class{constructor(e){this.config=e}async getAvailableModels(){try{let{value:e}=await (0,r_.getFromApi)({url:`${this.config.baseURL}/config`,headers:await (0,r_.resolve)(this.config.headers()),successfulResponseHandler:(0,r_.createJsonResponseHandler)(r0),failedResponseHandler:(0,r_.createJsonErrorResponseHandler)({errorSchema:eX.any(),errorToMessage:e=>e}),fetch:this.config.fetch});return e}catch(e){throw await rz(e)}}async getCredits(){try{let e=new URL(this.config.baseURL),{value:t}=await (0,r_.getFromApi)({url:`${e.origin}/v1/credits`,headers:await (0,r_.resolve)(this.config.headers()),successfulResponseHandler:(0,r_.createJsonResponseHandler)(r1),failedResponseHandler:(0,r_.createJsonErrorResponseHandler)({errorSchema:eX.any(),errorToMessage:e=>e}),fetch:this.config.fetch});return t}catch(e){throw await rz(e)}}},r0=(0,r_.lazyValidator)(()=>(0,r_.zodSchema)(eX.object({models:eX.array(eX.object({id:eX.string(),name:eX.string(),description:eX.string().nullish(),pricing:eX.object({input:eX.string(),output:eX.string(),input_cache_read:eX.string().nullish(),input_cache_write:eX.string().nullish()}).transform(e=>{let{input:t,output:r,input_cache_read:a,input_cache_write:o}=e;return{input:t,output:r,...a?{cachedInputTokens:a}:{},...o?{cacheCreationInputTokens:o}:{}}}).nullish(),specification:eX.object({specificationVersion:eX.literal("v2"),provider:eX.string(),modelId:eX.string()}),modelType:eX.enum(["language","embedding","image"]).nullish()}))}))),r1=(0,r_.lazyValidator)(()=>(0,r_.zodSchema)(eX.object({balance:eX.string(),total_used:eX.string()}).transform(e=>{let{balance:t,total_used:r}=e;return{balance:t,totalUsed:r}}))),r2=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v2",this.supportedUrls={"*/*":[/.*/]}}get provider(){return this.config.provider}async getArgs(e){let{abortSignal:t,...r}=e;return{args:this.maybeEncodeFileParts(r),warnings:[]}}async doGenerate(e){let{args:t,warnings:r}=await this.getArgs(e),{abortSignal:a}=e,o=await (0,r_.resolve)(this.config.headers());try{let{responseHeaders:s,value:i,rawValue:n}=await (0,r_.postJsonToApi)({url:this.getUrl(),headers:(0,r_.combineHeaders)(o,e.headers,this.getModelConfigHeaders(this.modelId,!1),await (0,r_.resolve)(this.config.o11yHeaders)),body:t,successfulResponseHandler:(0,r_.createJsonResponseHandler)(eX.any()),failedResponseHandler:(0,r_.createJsonErrorResponseHandler)({errorSchema:eX.any(),errorToMessage:e=>e}),...a&&{abortSignal:a},fetch:this.config.fetch});return{...i,request:{body:t},response:{headers:s,body:n},warnings:r}}catch(e){throw await rz(e,await rW(o))}}async doStream(e){let{args:t,warnings:r}=await this.getArgs(e),{abortSignal:a}=e,o=await (0,r_.resolve)(this.config.headers());try{let{value:s,responseHeaders:i}=await (0,r_.postJsonToApi)({url:this.getUrl(),headers:(0,r_.combineHeaders)(o,e.headers,this.getModelConfigHeaders(this.modelId,!0),await (0,r_.resolve)(this.config.o11yHeaders)),body:t,successfulResponseHandler:(0,r_.createEventSourceResponseHandler)(eX.any()),failedResponseHandler:(0,r_.createJsonErrorResponseHandler)({errorSchema:eX.any(),errorToMessage:e=>e}),...a&&{abortSignal:a},fetch:this.config.fetch});return{stream:s.pipeThrough(new TransformStream({start(e){r.length>0&&e.enqueue({type:"stream-start",warnings:r})},transform(t,r){if(t.success){let a=t.value;("raw"!==a.type||e.includeRawChunks)&&("response-metadata"===a.type&&a.timestamp&&"string"==typeof a.timestamp&&(a.timestamp=new Date(a.timestamp)),r.enqueue(a))}else r.error(t.error)}})),request:{body:t},response:{headers:i}}}catch(e){throw await rz(e,await rW(o))}}isFilePart(e){return e&&"object"==typeof e&&"type"in e&&"file"===e.type}maybeEncodeFileParts(e){for(let t of e.prompt)for(let e of t.content)if(this.isFilePart(e)&&e.data instanceof Uint8Array){let t=Uint8Array.from(e.data),r=U.Buffer.from(t).toString("base64");e.data=new URL(`data:${e.mediaType||"application/octet-stream"};base64,${r}`)}return e}getUrl(){return`${this.config.baseURL}/language-model`}getModelConfigHeaders(e,t){return{"ai-language-model-specification-version":"2","ai-language-model-id":e,"ai-language-model-streaming":String(t)}}},r4=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v2",this.maxEmbeddingsPerCall=2048,this.supportsParallelCalls=!0}get provider(){return this.config.provider}async doEmbed(e){var t;let{values:r,headers:a,abortSignal:o,providerOptions:s}=e,i=await (0,r_.resolve)(this.config.headers());try{let{responseHeaders:e,value:n,rawValue:l}=await (0,r_.postJsonToApi)({url:this.getUrl(),headers:(0,r_.combineHeaders)(i,null!=a?a:{},this.getModelConfigHeaders(),await (0,r_.resolve)(this.config.o11yHeaders)),body:{input:1===r.length?r[0]:r,...s?{providerOptions:s}:{}},successfulResponseHandler:(0,r_.createJsonResponseHandler)(r9),failedResponseHandler:(0,r_.createJsonErrorResponseHandler)({errorSchema:eX.any(),errorToMessage:e=>e}),...o&&{abortSignal:o},fetch:this.config.fetch});return{embeddings:n.embeddings,usage:null!=(t=n.usage)?t:void 0,providerMetadata:n.providerMetadata,response:{headers:e,body:l}}}catch(e){throw await rz(e,await rW(i))}}getUrl(){return`${this.config.baseURL}/embedding-model`}getModelConfigHeaders(){return{"ai-embedding-model-specification-version":"2","ai-model-id":this.modelId}}},r9=(0,r_.lazyValidator)(()=>(0,r_.zodSchema)(eX.object({embeddings:eX.array(eX.array(eX.number())),usage:eX.object({tokens:eX.number()}).nullish(),providerMetadata:eX.record(eX.string(),eX.record(eX.string(),eX.unknown())).optional()}))),r5=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v2",this.maxImagesPerCall=4}get provider(){return this.config.provider}async doGenerate(e){var t;let{prompt:r,n:a,size:o,aspectRatio:s,seed:i,providerOptions:n,headers:l,abortSignal:c}=e,d=await (0,r_.resolve)(this.config.headers());try{let{responseHeaders:e,value:u,rawValue:p}=await (0,r_.postJsonToApi)({url:this.getUrl(),headers:(0,r_.combineHeaders)(d,null!=l?l:{},this.getModelConfigHeaders(),await (0,r_.resolve)(this.config.o11yHeaders)),body:{prompt:r,n:a,...o&&{size:o},...s&&{aspectRatio:s},...i&&{seed:i},...null!=n?n:{}},successfulResponseHandler:(0,r_.createJsonResponseHandler)(r8),failedResponseHandler:(0,r_.createJsonErrorResponseHandler)({errorSchema:eX.any(),errorToMessage:e=>e}),...c&&{abortSignal:c},fetch:this.config.fetch});return{images:u.images,warnings:null!=(t=u.warnings)?t:[],providerMetadata:u.providerMetadata,response:{timestamp:new Date,modelId:this.modelId,headers:e}}}catch(e){throw rz(e,await rW(d))}}getUrl(){return`${this.config.baseURL}/image-model`}getModelConfigHeaders(){return{"ai-image-model-specification-version":"2","ai-model-id":this.modelId}}},r6=eX.object({images:eX.array(eX.unknown()).optional()}).catchall(eX.unknown()),r8=eX.object({images:eX.array(eX.string()),warnings:eX.array(eX.object({type:eX.literal("other"),message:eX.string()})).optional(),providerMetadata:eX.record(eX.string(),r6).optional()});async function r7(){var e;return null==(e=(0,e0.getContext)().headers)?void 0:e["x-vercel-id"]}async function r3(e){let t=(0,r_.loadOptionalSetting)({settingValue:e.apiKey,environmentVariableName:"AI_GATEWAY_API_KEY"});if(t)return{token:t,authMethod:"api-key"};try{return{token:await (0,e0.getVercelOidcToken)(),authMethod:"oidc"}}catch(e){return null}}!function(){var e,t;let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=null,o=null,s=null!=(e=r.metadataCacheRefreshMillis)?e:3e5,i=0,n=null!=(t=(0,r_.withoutTrailingSlash)(r.baseURL))?t:"https://ai-gateway.vercel.sh/v1/ai",l=async()=>{let e=await r3(r);if(e)return(0,r_.withUserAgentSuffix)({Authorization:`Bearer ${e.token}`,"ai-gateway-protocol-version":"0.0.1",[rY]:e.authMethod,...r.headers},"ai-sdk/gateway/2.0.11");throw rM.createContextualError({apiKeyProvided:!1,oidcTokenProvided:!1,statusCode:401})},c=()=>{let e=(0,r_.loadOptionalSetting)({settingValue:void 0,environmentVariableName:"VERCEL_DEPLOYMENT_ID"}),t=(0,r_.loadOptionalSetting)({settingValue:void 0,environmentVariableName:"VERCEL_ENV"}),r=(0,r_.loadOptionalSetting)({settingValue:void 0,environmentVariableName:"VERCEL_REGION"});return async()=>{let a=await r7();return{...e&&{"ai-o11y-deployment-id":e},...t&&{"ai-o11y-environment":t},...r&&{"ai-o11y-region":r},...a&&{"ai-o11y-request-id":a}}}},d=e=>new r2(e,{provider:"gateway",baseURL:n,headers:l,fetch:r.fetch,o11yHeaders:c()}),u=async()=>new rX({baseURL:n,headers:l,fetch:r.fetch}).getCredits().catch(async e=>{throw await rz(e,await rW(await l()))}),p=function(e){if(new.target)throw Error("The Gateway Provider model function cannot be called with the new keyword.");return d(e)};p.getAvailableModels=async()=>{var e,t,c;let d=null!=(c=null==(t=null==(e=r._internal)?void 0:e.currentDate)?void 0:t.call(e).getTime())?c:Date.now();return(!a||d-i>s)&&(i=d,a=new rX({baseURL:n,headers:l,fetch:r.fetch}).getAvailableModels().then(e=>(o=e,e)).catch(async e=>{throw await rz(e,await rW(await l()))})),o?Promise.resolve(o):a},p.getCredits=u,p.imageModel=e=>new r5(e,{provider:"gateway",baseURL:n,headers:l,fetch:r.fetch,o11yHeaders:c()}),p.languageModel=d,p.textEmbeddingModel=e=>new r4(e,{provider:"gateway",baseURL:n,headers:l,fetch:r.fetch,o11yHeaders:c()})}();var ae=B,eX=q,at=Object.defineProperty,ar=Symbol.for("vercel.ai.error.AI_NoOutputSpecifiedError");ae.AISDKError;Symbol.for("vercel.ai.error.AI_InvalidArgumentError");ae.AISDKError;Symbol.for("vercel.ai.error.AI_InvalidStreamPartError");ae.AISDKError;Symbol.for("vercel.ai.error.AI_InvalidToolInputError");ae.AISDKError;Symbol.for("vercel.ai.error.AI_NoImageGeneratedError");ae.AISDKError;var aa="AI_NoObjectGeneratedError",ao=`vercel.ai.error.${aa}`,as=Symbol.for(ao),ai=class extends ae.AISDKError{constructor({message:e="No object generated.",cause:t,text:r,response:a,usage:o,finishReason:s}){super({name:aa,message:e,cause:t}),this[L]=!0,this.text=r,this.response=a,this.usage=o,this.finishReason=s}static isInstance(e){return ae.AISDKError.hasMarker(e,ao)}};L=as;Symbol.for("vercel.ai.error.AI_NoOutputGeneratedError");ae.AISDKError,ae.AISDKError;Symbol.for("vercel.ai.error.AI_NoSuchToolError");ae.AISDKError;Symbol.for("vercel.ai.error.AI_ToolCallRepairError");ae.AISDKError,ae.AISDKError;Symbol.for("vercel.ai.error.AI_InvalidDataContentError");ae.AISDKError;Symbol.for("vercel.ai.error.AI_InvalidMessageRoleError");ae.AISDKError;Symbol.for("vercel.ai.error.AI_MessageConversionError");ae.AISDKError;Symbol.for("vercel.ai.error.AI_DownloadError");ae.AISDKError;Symbol.for("vercel.ai.error.AI_RetryError");ae.AISDKError;var an="5.0.95",al=eX.union([eX.string(),eX.instanceof(Uint8Array),eX.instanceof(ArrayBuffer),eX.custom(e=>{var t,r;return null!=(r=null==(t=globalThis.Buffer)?void 0:t.isBuffer(e))&&r},{message:"Must be a Buffer"})]),ac=eX.lazy(()=>eX.union([eX.null(),eX.string(),eX.number(),eX.boolean(),eX.record(eX.string(),ac),eX.array(ac)])),ad=eX.record(eX.string(),eX.record(eX.string(),ac)),au=eX.object({type:eX.literal("text"),text:eX.string(),providerOptions:ad.optional()}),ap=eX.object({type:eX.literal("image"),image:eX.union([al,eX.instanceof(URL)]),mediaType:eX.string().optional(),providerOptions:ad.optional()}),ah=eX.object({type:eX.literal("file"),data:eX.union([al,eX.instanceof(URL)]),filename:eX.string().optional(),mediaType:eX.string(),providerOptions:ad.optional()}),ag=eX.object({type:eX.literal("reasoning"),text:eX.string(),providerOptions:ad.optional()}),am=eX.object({type:eX.literal("tool-call"),toolCallId:eX.string(),toolName:eX.string(),input:eX.unknown(),providerOptions:ad.optional(),providerExecuted:eX.boolean().optional()}),ay=eX.discriminatedUnion("type",[eX.object({type:eX.literal("text"),value:eX.string()}),eX.object({type:eX.literal("json"),value:ac}),eX.object({type:eX.literal("error-text"),value:eX.string()}),eX.object({type:eX.literal("error-json"),value:ac}),eX.object({type:eX.literal("content"),value:eX.array(eX.union([eX.object({type:eX.literal("text"),text:eX.string()}),eX.object({type:eX.literal("media"),data:eX.string(),mediaType:eX.string()})]))})]),af=eX.object({type:eX.literal("tool-result"),toolCallId:eX.string(),toolName:eX.string(),output:ay,providerOptions:ad.optional()}),av=eX.object({role:eX.literal("system"),content:eX.string(),providerOptions:ad.optional()}),ab=eX.object({role:eX.literal("user"),content:eX.union([eX.string(),eX.array(eX.union([au,ap,ah]))]),providerOptions:ad.optional()}),aI=eX.object({role:eX.literal("assistant"),content:eX.union([eX.string(),eX.array(eX.union([au,ah,ag,am,af]))]),providerOptions:ad.optional()}),aE=eX.object({role:eX.literal("tool"),content:eX.array(af),providerOptions:ad.optional()});eX.union([av,ab,aI,aE]),(0,r_.createIdGenerator)({prefix:"aitxt",size:24}),TransformStream;var aw=(0,r_.lazyValidator)(()=>(0,r_.zodSchema)(eX.union([eX.strictObject({type:eX.literal("text-start"),id:eX.string(),providerMetadata:ad.optional()}),eX.strictObject({type:eX.literal("text-delta"),id:eX.string(),delta:eX.string(),providerMetadata:ad.optional()}),eX.strictObject({type:eX.literal("text-end"),id:eX.string(),providerMetadata:ad.optional()}),eX.strictObject({type:eX.literal("error"),errorText:eX.string()}),eX.strictObject({type:eX.literal("tool-input-start"),toolCallId:eX.string(),toolName:eX.string(),providerExecuted:eX.boolean().optional(),dynamic:eX.boolean().optional()}),eX.strictObject({type:eX.literal("tool-input-delta"),toolCallId:eX.string(),inputTextDelta:eX.string()}),eX.strictObject({type:eX.literal("tool-input-available"),toolCallId:eX.string(),toolName:eX.string(),input:eX.unknown(),providerExecuted:eX.boolean().optional(),providerMetadata:ad.optional(),dynamic:eX.boolean().optional()}),eX.strictObject({type:eX.literal("tool-input-error"),toolCallId:eX.string(),toolName:eX.string(),input:eX.unknown(),providerExecuted:eX.boolean().optional(),providerMetadata:ad.optional(),dynamic:eX.boolean().optional(),errorText:eX.string()}),eX.strictObject({type:eX.literal("tool-output-available"),toolCallId:eX.string(),output:eX.unknown(),providerExecuted:eX.boolean().optional(),dynamic:eX.boolean().optional(),preliminary:eX.boolean().optional()}),eX.strictObject({type:eX.literal("tool-output-error"),toolCallId:eX.string(),errorText:eX.string(),providerExecuted:eX.boolean().optional(),dynamic:eX.boolean().optional()}),eX.strictObject({type:eX.literal("reasoning-start"),id:eX.string(),providerMetadata:ad.optional()}),eX.strictObject({type:eX.literal("reasoning-delta"),id:eX.string(),delta:eX.string(),providerMetadata:ad.optional()}),eX.strictObject({type:eX.literal("reasoning-end"),id:eX.string(),providerMetadata:ad.optional()}),eX.strictObject({type:eX.literal("source-url"),sourceId:eX.string(),url:eX.string(),title:eX.string().optional(),providerMetadata:ad.optional()}),eX.strictObject({type:eX.literal("source-document"),sourceId:eX.string(),mediaType:eX.string(),title:eX.string(),filename:eX.string().optional(),providerMetadata:ad.optional()}),eX.strictObject({type:eX.literal("file"),url:eX.string(),mediaType:eX.string(),providerMetadata:ad.optional()}),eX.strictObject({type:eX.custom(e=>"string"==typeof e&&e.startsWith("data-"),{message:'Type must start with "data-"'}),id:eX.string().optional(),data:eX.unknown(),transient:eX.boolean().optional()}),eX.strictObject({type:eX.literal("start-step")}),eX.strictObject({type:eX.literal("finish-step")}),eX.strictObject({type:eX.literal("start"),messageId:eX.string().optional(),messageMetadata:eX.unknown().optional()}),eX.strictObject({type:eX.literal("finish"),finishReason:eX.enum(["stop","length","content-filter","tool-calls","error","other","unknown"]).optional(),messageMetadata:eX.unknown().optional()}),eX.strictObject({type:eX.literal("abort")}),eX.strictObject({type:eX.literal("message-metadata"),messageMetadata:eX.unknown()})])));async function aT(e){if(void 0===e)return{value:void 0,state:"undefined-input"};let t=await (0,r_.safeParseJSON)({text:e});return t.success?{value:t.value,state:"successful-parse"}:(t=await (0,r_.safeParseJSON)({text:function(e){let t=["ROOT"],r=-1,a=null;function o(e,o,s){switch(e){case'"':r=o,t.pop(),t.push(s),t.push("INSIDE_STRING");break;case"f":case"t":case"n":r=o,a=o,t.pop(),t.push(s),t.push("INSIDE_LITERAL");break;case"-":t.pop(),t.push(s),t.push("INSIDE_NUMBER");break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":r=o,t.pop(),t.push(s),t.push("INSIDE_NUMBER");break;case"{":r=o,t.pop(),t.push(s),t.push("INSIDE_OBJECT_START");break;case"[":r=o,t.pop(),t.push(s),t.push("INSIDE_ARRAY_START")}}function s(e,a){switch(e){case",":t.pop(),t.push("INSIDE_OBJECT_AFTER_COMMA");break;case"}":r=a,t.pop()}}function i(e,a){switch(e){case",":t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break;case"]":r=a,t.pop()}}for(let n=0;n<e.length;n++){let l=e[n];switch(t[t.length-1]){case"ROOT":o(l,n,"FINISH");break;case"INSIDE_OBJECT_START":switch(l){case'"':t.pop(),t.push("INSIDE_OBJECT_KEY");break;case"}":r=n,t.pop()}break;case"INSIDE_OBJECT_AFTER_COMMA":'"'===l&&(t.pop(),t.push("INSIDE_OBJECT_KEY"));break;case"INSIDE_OBJECT_KEY":'"'===l&&(t.pop(),t.push("INSIDE_OBJECT_AFTER_KEY"));break;case"INSIDE_OBJECT_AFTER_KEY":":"===l&&(t.pop(),t.push("INSIDE_OBJECT_BEFORE_VALUE"));break;case"INSIDE_OBJECT_BEFORE_VALUE":o(l,n,"INSIDE_OBJECT_AFTER_VALUE");break;case"INSIDE_OBJECT_AFTER_VALUE":s(l,n);break;case"INSIDE_STRING":switch(l){case'"':t.pop(),r=n;break;case"\\":t.push("INSIDE_STRING_ESCAPE");break;default:r=n}break;case"INSIDE_ARRAY_START":"]"===l?(r=n,t.pop()):(r=n,o(l,n,"INSIDE_ARRAY_AFTER_VALUE"));break;case"INSIDE_ARRAY_AFTER_VALUE":switch(l){case",":t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break;case"]":r=n,t.pop();break;default:r=n}break;case"INSIDE_ARRAY_AFTER_COMMA":o(l,n,"INSIDE_ARRAY_AFTER_VALUE");break;case"INSIDE_STRING_ESCAPE":t.pop(),r=n;break;case"INSIDE_NUMBER":switch(l){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":r=n;break;case"e":case"E":case"-":case".":break;case",":t.pop(),"INSIDE_ARRAY_AFTER_VALUE"===t[t.length-1]&&i(l,n),"INSIDE_OBJECT_AFTER_VALUE"===t[t.length-1]&&s(l,n);break;case"}":t.pop(),"INSIDE_OBJECT_AFTER_VALUE"===t[t.length-1]&&s(l,n);break;case"]":t.pop(),"INSIDE_ARRAY_AFTER_VALUE"===t[t.length-1]&&i(l,n);break;default:t.pop()}break;case"INSIDE_LITERAL":{let o=e.substring(a,n+1);"false".startsWith(o)||"true".startsWith(o)||"null".startsWith(o)?r=n:(t.pop(),"INSIDE_OBJECT_AFTER_VALUE"===t[t.length-1]?s(l,n):"INSIDE_ARRAY_AFTER_VALUE"===t[t.length-1]&&i(l,n))}}}let n=e.slice(0,r+1);for(let r=t.length-1;r>=0;r--)switch(t[r]){case"INSIDE_STRING":n+='"';break;case"INSIDE_OBJECT_KEY":case"INSIDE_OBJECT_AFTER_KEY":case"INSIDE_OBJECT_AFTER_COMMA":case"INSIDE_OBJECT_START":case"INSIDE_OBJECT_BEFORE_VALUE":case"INSIDE_OBJECT_AFTER_VALUE":n+="}";break;case"INSIDE_ARRAY_START":case"INSIDE_ARRAY_AFTER_COMMA":case"INSIDE_ARRAY_AFTER_VALUE":n+="]";break;case"INSIDE_LITERAL":{let t=e.substring(a,e.length);"true".startsWith(t)?n+="true".slice(t.length):"false".startsWith(t)?n+="false".slice(t.length):"null".startsWith(t)&&(n+="null".slice(t.length))}}return n}(e)})).success?{value:t.value,state:"repaired-parse"}:{value:void 0,state:"failed-parse"}}function aA(e){return e.type.startsWith("tool-")}function a_(e){return"dynamic-tool"===e.type}function aS(e){return aA(e)||a_(e)}function ak(e){return a_(e)?e.toolName:e.type.split("-").slice(1).join("-")}(0,r_.createIdGenerator)({prefix:"aitxt",size:24}),(0,r_.createIdGenerator)({prefix:"aiobj",size:24}),(0,r_.createIdGenerator)({prefix:"aiobj",size:24});var ax={},aR={object:()=>aj,text:()=>aC};for(var aM in aR)at(ax,aM,{get:aR[aM],enumerable:!0});var aC=()=>({type:"text",responseFormat:{type:"text"},async parsePartial(e){let{text:t}=e;return{partial:t}},async parseOutput(e){let{text:t}=e;return t}}),aj=e=>{let{schema:t}=e,r=(0,r_.asSchema)(t);return{type:"object",responseFormat:{type:"json",schema:r.jsonSchema},async parsePartial(e){let{text:t}=e,r=await aT(t);switch(r.state){case"failed-parse":case"undefined-input":return;case"repaired-parse":case"successful-parse":return{partial:r.value};default:{let e=r.state;throw Error(`Unsupported parse state: ${e}`)}}},async parseOutput(e,t){let{text:a}=e,o=await (0,r_.safeParseJSON)({text:a});if(!o.success)throw new ai({message:"No object generated: could not parse the response.",cause:o.error,text:a,response:t.response,usage:t.usage,finishReason:t.finishReason});let s=await (0,r_.safeValidateTypes)({value:o.value,schema:r});if(!s.success)throw new ai({message:"No object generated: response did not match schema.",cause:s.error,text:a,response:t.response,usage:t.usage,finishReason:t.finishReason});return s.value}}},aP=Symbol.for("vercel.ai.error.AI_NoSuchProviderError");ae.NoSuchModelError,ae.AISDKError;var aO=class{constructor({api:e="/api/chat",credentials:t,headers:r,body:a,fetch:o,prepareSendMessagesRequest:s,prepareReconnectToStreamRequest:i}){this.api=e,this.credentials=t,this.headers=r,this.body=a,this.fetch=o,this.prepareSendMessagesRequest=s,this.prepareReconnectToStreamRequest=i}async sendMessages(e){var t,r,a,o,s;let{abortSignal:i,...n}=e,l=await (0,r_.resolve)(this.body),c=await (0,r_.resolve)(this.headers),d=await (0,r_.resolve)(this.credentials),u={...(0,r_.normalizeHeaders)(c),...(0,r_.normalizeHeaders)(n.headers)},p=await (null==(t=this.prepareSendMessagesRequest)?void 0:t.call(this,{api:this.api,id:n.chatId,messages:n.messages,body:{...l,...n.body},headers:u,credentials:d,requestMetadata:n.metadata,trigger:n.trigger,messageId:n.messageId})),h=null!=(r=null==p?void 0:p.api)?r:this.api,g=(null==p?void 0:p.headers)!==void 0?(0,r_.normalizeHeaders)(p.headers):u,m=(null==p?void 0:p.body)!==void 0?p.body:{...l,...n.body,id:n.chatId,messages:n.messages,trigger:n.trigger,messageId:n.messageId},y=null!=(a=null==p?void 0:p.credentials)?a:d,f=null!=(o=this.fetch)?o:globalThis.fetch,v=await f(h,{method:"POST",headers:(0,r_.withUserAgentSuffix)({"Content-Type":"application/json",...g},`ai-sdk/${an}`,(0,r_.getRuntimeEnvironmentUserAgent)()),body:JSON.stringify(m),credentials:y,signal:i});if(!v.ok)throw Error(null!=(s=await v.text())?s:"Failed to fetch the chat response.");if(!v.body)throw Error("The response body is empty.");return this.processResponseStream(v.body)}async reconnectToStream(e){var t,r,a,o,s;let i=await (0,r_.resolve)(this.body),n=await (0,r_.resolve)(this.headers),l=await (0,r_.resolve)(this.credentials),c={...(0,r_.normalizeHeaders)(n),...(0,r_.normalizeHeaders)(e.headers)},d=await (null==(t=this.prepareReconnectToStreamRequest)?void 0:t.call(this,{api:this.api,id:e.chatId,body:{...i,...e.body},headers:c,credentials:l,requestMetadata:e.metadata})),u=null!=(r=null==d?void 0:d.api)?r:`${this.api}/${e.chatId}/stream`,p=(null==d?void 0:d.headers)!==void 0?(0,r_.normalizeHeaders)(d.headers):c,h=null!=(a=null==d?void 0:d.credentials)?a:l,g=null!=(o=this.fetch)?o:globalThis.fetch,m=await g(u,{method:"GET",headers:(0,r_.withUserAgentSuffix)(p,`ai-sdk/${an}`,(0,r_.getRuntimeEnvironmentUserAgent)()),credentials:h});if(204===m.status)return null;if(!m.ok)throw Error(null!=(s=await m.text())?s:"Failed to fetch the chat response.");if(!m.body)throw Error("The response body is empty.");return this.processResponseStream(m.body)}},aN=class extends aO{constructor(e={}){super(e)}processResponseStream(e){return(0,r_.parseJsonEventStream)({stream:e,schema:aw}).pipeThrough(new TransformStream({async transform(e,t){if(!e.success)throw e.error;t.enqueue(e.value)}}))}};(0,r_.lazyValidator)(()=>(0,r_.zodSchema)(eX.array(eX.object({id:eX.string(),role:eX.enum(["system","user","assistant"]),metadata:eX.unknown().optional(),parts:eX.array(eX.union([eX.object({type:eX.literal("text"),text:eX.string(),state:eX.enum(["streaming","done"]).optional(),providerMetadata:ad.optional()}),eX.object({type:eX.literal("reasoning"),text:eX.string(),state:eX.enum(["streaming","done"]).optional(),providerMetadata:ad.optional()}),eX.object({type:eX.literal("source-url"),sourceId:eX.string(),url:eX.string(),title:eX.string().optional(),providerMetadata:ad.optional()}),eX.object({type:eX.literal("source-document"),sourceId:eX.string(),mediaType:eX.string(),title:eX.string(),filename:eX.string().optional(),providerMetadata:ad.optional()}),eX.object({type:eX.literal("file"),mediaType:eX.string(),filename:eX.string().optional(),url:eX.string(),providerMetadata:ad.optional()}),eX.object({type:eX.literal("step-start")}),eX.object({type:eX.string().startsWith("data-"),id:eX.string().optional(),data:eX.unknown()}),eX.object({type:eX.literal("dynamic-tool"),toolName:eX.string(),toolCallId:eX.string(),state:eX.literal("input-streaming"),input:eX.unknown().optional(),providerExecuted:eX.boolean().optional(),output:eX.never().optional(),errorText:eX.never().optional()}),eX.object({type:eX.literal("dynamic-tool"),toolName:eX.string(),toolCallId:eX.string(),state:eX.literal("input-available"),input:eX.unknown(),providerExecuted:eX.boolean().optional(),output:eX.never().optional(),errorText:eX.never().optional(),callProviderMetadata:ad.optional()}),eX.object({type:eX.literal("dynamic-tool"),toolName:eX.string(),toolCallId:eX.string(),state:eX.literal("output-available"),input:eX.unknown(),providerExecuted:eX.boolean().optional(),output:eX.unknown(),errorText:eX.never().optional(),callProviderMetadata:ad.optional(),preliminary:eX.boolean().optional()}),eX.object({type:eX.literal("dynamic-tool"),toolName:eX.string(),toolCallId:eX.string(),state:eX.literal("output-error"),input:eX.unknown(),providerExecuted:eX.boolean().optional(),output:eX.never().optional(),errorText:eX.string(),callProviderMetadata:ad.optional()}),eX.object({type:eX.string().startsWith("tool-"),toolCallId:eX.string(),state:eX.literal("input-streaming"),providerExecuted:eX.boolean().optional(),input:eX.unknown().optional(),output:eX.never().optional(),errorText:eX.never().optional(),approval:eX.never().optional()}),eX.object({type:eX.string().startsWith("tool-"),toolCallId:eX.string(),state:eX.literal("input-available"),providerExecuted:eX.boolean().optional(),input:eX.unknown(),output:eX.never().optional(),errorText:eX.never().optional(),callProviderMetadata:ad.optional(),approval:eX.never().optional()}),eX.object({type:eX.string().startsWith("tool-"),toolCallId:eX.string(),state:eX.literal("approval-requested"),input:eX.unknown(),providerExecuted:eX.boolean().optional(),output:eX.never().optional(),errorText:eX.never().optional(),callProviderMetadata:ad.optional(),approval:eX.object({id:eX.string(),approved:eX.never().optional(),reason:eX.never().optional()})}),eX.object({type:eX.string().startsWith("tool-"),toolCallId:eX.string(),state:eX.literal("approval-responded"),input:eX.unknown(),providerExecuted:eX.boolean().optional(),output:eX.never().optional(),errorText:eX.never().optional(),callProviderMetadata:ad.optional(),approval:eX.object({id:eX.string(),approved:eX.boolean(),reason:eX.string().optional()})}),eX.object({type:eX.string().startsWith("tool-"),toolCallId:eX.string(),state:eX.literal("output-available"),providerExecuted:eX.boolean().optional(),input:eX.unknown(),output:eX.unknown(),errorText:eX.never().optional(),callProviderMetadata:ad.optional(),preliminary:eX.boolean().optional(),approval:eX.object({id:eX.string(),approved:eX.literal(!0),reason:eX.string().optional()}).optional()}),eX.object({type:eX.string().startsWith("tool-"),toolCallId:eX.string(),state:eX.literal("output-error"),providerExecuted:eX.boolean().optional(),input:eX.unknown(),output:eX.never().optional(),errorText:eX.string(),callProviderMetadata:ad.optional(),approval:eX.object({id:eX.string(),approved:eX.literal(!0),reason:eX.string().optional()}).optional()}),eX.object({type:eX.string().startsWith("tool-"),toolCallId:eX.string(),state:eX.literal("output-denied"),providerExecuted:eX.boolean().optional(),input:eX.unknown(),output:eX.never().optional(),errorText:eX.never().optional(),callProviderMetadata:ad.optional(),approval:eX.object({id:eX.string(),approved:eX.literal(!1),reason:eX.string().optional()})})])).nonempty("Message must contain at least one part")})).nonempty("Messages array must not be empty"))),e.s(["DefaultChatTransport",()=>aN,"getToolOrDynamicToolName",()=>ak,"isToolOrDynamicToolUIPart",()=>aS,"isToolUIPart",()=>aA],3358287)}]);

//# debugId=e8fa8a72-526b-e1d4-ad93-363d3d4f53dd
//# sourceMappingURL=33b5c5561324a627.js.map