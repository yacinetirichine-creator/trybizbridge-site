;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="941a6e4b-1e93-6665-27f9-18e871f2dc14")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,2766871,e=>{"use strict";var t=e.i(1146226),l=e.i(5169864),i=e.i(9722978),s=e.i(5756088),a=e.i(6401841),n=e.i(8893913),r=e.i(8876434),o=e.i(3306538),c=e.i(2504781),d=e.i(779588),m=e.i(6870754),u=e.i(8674454),x=e.i(6694387),p=e.i(4991687),h=e.i(8459493),j=e.i(7448864),g=e.i(8522580),f=e.i(5255926),y=e.i(9318197),v=e.i(5468328),w=e.i(455575),b=e.i(1019550),k=e.i(5610834),S=e.i(4004502),C=e.i(7780974),N=e.i(7837522),D=e.i(3322724),R=e.i(57106),P=e.i(9716741),A=e.i(8062867),L=e.i(8994597),I=e.i(4043190),B=e.i(5758916),M=e.i(9650453),T=e.i(369178),_=e.i(4450569),F=e.i(7808943);let U=e=>{let{branch:l,onClearBranch:i,isUsingActiveBranches:s}=e;return(0,t.jsxs)(T.default,{children:[(0,t.jsxs)(_.default,{center:!0,className:"empty-preview",hcenter:!0,vcenter:!0,children:[(0,t.jsx)("h3",{className:"jsx-c1a77c3a387314ef text-copy-16",children:s?"No Active Branches":"No Preview Deployments"}),(0,t.jsxs)(_.default,{flex:0,style:{color:"var(--accents-5)"},children:[(0,t.jsx)("p",{className:"jsx-c1a77c3a387314ef text-copy-14 m-0",children:l?(0,t.jsxs)(t.Fragment,{children:["Commit to the ",(0,t.jsx)(F.default,{children:l})," branch to deploy."]}):"Commit using our Git connections."}),!!l&&!!i&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(y.Spacer,{}),(0,t.jsx)("p",{className:"jsx-c1a77c3a387314ef text-copy-14 m-0",children:(0,t.jsx)(R.Link,{onClick:i,style:{fontWeight:700},variant:"highlight",children:"View All Deployments"})})]})]})]}),(0,t.jsx)(M.default,{id:"c1a77c3a387314ef",children:".empty-preview{text-align:center;padding:var(--geist-gap-double);border:1px dashed var(--accents-2);border-radius:var(--geist-radius);min-height:calc(300px + var(--geist-gap-double)*1.5)}"})]})};var O=e.i(7137884),E=e.i(4245131),$=e.i(8517043),z=e.i(6850581),H=e.i(9334091),V=e.i(3496900),G=e.i(5883567),W=e.i(6005997),Y=e.i(7218483),K=e.i(9375869),Q=e.i(4904548),q=e.i(6226725),J=e.i(3959677),X=e.i(5371931),Z=e.i(9222994),ee=e.i(8529990),et=e.i(7417898),el=e.i(8216525);function ei(e){let{children:l,isPrevious:s,style:a}=e;return(0,t.jsx)("span",{className:(0,i.clsx)("truncate text-[var(--accents-3)]","[&>a]:inline-block","[&>a]:truncate","[&>a]:max-w-[250px]","[&>a]:align-top","[&>a]:no-underline","[&>a:hover]:underline","[&>a]:text-[var(--geist-foreground)]","max-[480px]:[&>a]:max-w-[120px]","[&>a.via-fork]:font-medium",s&&"text-[var(--accents-5)]"),style:{...a},children:l})}function es(e){let{message:l,commitUrl:s,style:a}=e;return(0,t.jsx)("a",{className:(0,i.clsx)("geist-ellipsis","text-[var(--accents-5)]","no-underline","inline-block","leading-6","hover:underline","max-[480px]:max-w-full"),href:s,style:a,target:"_blank",title:l,children:l})}let ea=l.default.memo(e=>{let{type:l,children:s,commitUrl:a,message:r,icon:o,isPrevious:c,deployment:d,isStale:m,style:u,noPadding:x=!1,showCommit:p}=e,h=(0,K.useDeploymentLink)(d);return m?(0,t.jsxs)("div",{className:(0,i.clsx)("flex flex-row items-center justify-start gap-4 flex-initial rounded px-3 py-2",{"bg-gray-100":c}),style:u,children:[c?(0,t.jsx)(q.CrossCircle,{color:"gray-900",style:{flexShrink:0}}):(0,t.jsx)(n.RotateCounterClockwise,{color:"gray-900",style:{flexShrink:0}}),(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start flex-initial truncate",children:[(0,t.jsxs)("div",{className:"flex w-full items-center gap-1",children:[(0,t.jsx)("span",{className:"px-[3px]",children:(0,t.jsx)(el.DeploymentStatus,{deployment:d})}),(0,t.jsx)("p",{className:`${(0,i.clsx)("text-label-14 truncate",{"line-through":c})}`,children:(0,t.jsx)(R.Link,{className:(0,i.clsx)("flex items-center gap-2.5 text-inherit no-underline hover:underline",{"text-accents-5":c}),href:h,children:(0,t.jsx)("span",{children:d.url})})})]}),(0,t.jsx)(et.DeploymentSourceLinks,{deployment:d,singleLine:!0,textStyle:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",textDecoration:c?"line-through":void 0}})]})]}):(0,t.jsxs)(_.default,{style:{padding:x?0:"12px 0",lineHeight:"24px"},children:[(0,t.jsxs)(_.default,{row:!0,vcenter:!0,children:[o?(0,t.jsxs)(t.Fragment,{children:[((e,l)=>{switch(e){case"github":return(0,t.jsx)(J.default,{...l,style:{marginLeft:1}});case"gitlab":return(0,t.jsx)(X.default,{...l,style:{marginLeft:1}});case"bitbucket":return(0,t.jsx)(Z.default,{...l,style:{marginLeft:1}})}})(l),(0,t.jsx)(y.Spacer,{x:.25})]}):null,(0,t.jsx)(ei,{children:s})]}),p?(0,t.jsx)(es,{commitUrl:a,message:r}):null]})}),en=l.default.memo(e=>{let{deployment:l,icon:i,isStale:s,noPadding:a,isPrevious:n,style:r,showCommit:o}=e,c=(0,ee.getGitInfoFromDeployment)(l);return c?.type!=="github"?null:(0,t.jsx)(ea,{commitUrl:c.commitUrl,deployment:l,icon:i,isPrevious:n,isStale:s,message:c.commitMessage,noPadding:a,showCommit:o,style:r,type:"github",children:c.viaFork&&c.prId&&c.prUrl?(0,t.jsxs)(t.Fragment,{children:["( ",(0,t.jsx)("a",{href:c.commitUrl,target:"_blank",children:c.commitSha.slice(0,7)})," ","in ",(0,t.jsxs)("a",{href:c.prUrl,target:"_blank",children:["forked PR#",c.prId]}),")"]}):(0,t.jsx)("a",{href:c.refUrl,target:"_blank",title:c.commitRef,children:c.commitRef})})}),er=l.default.memo(e=>{let{deployment:l,icon:i,isStale:s,noPadding:a,isPrevious:n,showCommit:r}=e,o=(0,ee.getGitInfoFromDeployment)(l);return o?.type!=="gitlab"?null:(0,t.jsx)(ea,{commitUrl:o.commitUrl,deployment:l,icon:i,isPrevious:n,isStale:s,message:o.commitMessage,noPadding:a,showCommit:r,type:"gitlab",children:(0,t.jsx)("a",{href:o.refUrl,target:"_blank",title:o.commitRef,children:o.commitRef})})}),eo=l.default.memo(e=>{let{deployment:l,icon:i,isStale:s,noPadding:a,isPrevious:n,showCommit:r}=e,o=(0,ee.getGitInfoFromDeployment)(l);return o?.type!=="bitbucket"?null:(0,t.jsx)(ea,{commitUrl:o.commitUrl,deployment:l,icon:i,isPrevious:n,isStale:s,message:o.commitMessage,noPadding:a,showCommit:r,type:"bitbucket",children:(0,t.jsx)("a",{href:o.refUrl,target:"_blank",title:o.commitRef,children:o.commitRef})})}),ec=l.default.memo(e=>{let{deployment:l,icon:i=!1,isStale:s=!1,noPadding:a,previousDeployment:n,showCommit:r=!0}=e;return l?.meta?l.meta.githubDeployment?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(en,{deployment:l,icon:i,isStale:s,noPadding:a,showCommit:r}),s&&n?(0,t.jsx)(en,{deployment:n,icon:i,isPrevious:!0,isStale:s,noPadding:a,showCommit:r}):null]}):l.meta.gitlabDeployment?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(er,{deployment:l,icon:i,isStale:s,noPadding:a,showCommit:r}),s&&n?(0,t.jsx)(er,{deployment:n,icon:i,isPrevious:!0,isStale:s,noPadding:a,showCommit:r}):null]}):l.meta.bitbucketDeployment?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(eo,{deployment:l,icon:i,isStale:s,noPadding:a,showCommit:r}),s&&n?(0,t.jsx)(eo,{deployment:n,icon:i,isPrevious:!0,isStale:s,noPadding:a,showCommit:r}):null]}):(0,t.jsx)("span",{style:{color:"var(--accents-3)",fontWeight:"normal",minHeight:72,lineHeight:"48px"},children:"-"}):null});var ed=e.i(3896684),em=e.i(2457794),eu=e.i(2348990),ex=e.i(1138941),ep=e.i(672468),eh=e.i(7917902),ej=e.i(277234),eg=e.i(5269510);let ef=function(e){let{project:l,link:i=!0}=e,s=(0,ex.useProjectUrl)(l),{isLoading:a,data:n}=(()=>{let{isTeam:e,team:t}=(0,eh.useAccount)(),{data:l,error:i,isLoading:s}=(0,ep.default)(`/api/v0/speed-insights/latest-scores?${(0,eg.stringify)({teamId:e?t?.id:void 0})}`,e=>(0,ej.fetchAPI)(e,{throwOnHTTPError:!0}));return{data:l,isLoading:s,isError:!!i}})(),r=n?.find(e=>{let{projectId:t}=e;return t===l?.id})?.value,o=a||!(0,eu.isSpeedInsightsEnabled)(l)||void 0===r?(0,t.jsx)(v.Tooltip,{delay:!1,text:"Get detailed performance metrics with Insights.",children:(0,t.jsx)(em.default,{size:"small",children:(0,t.jsx)(ed.ChartActivity,{color:"gray-900"})})}):(0,t.jsx)(em.default,{size:"small",value:r,children:r.toString()});return s&&i?(0,t.jsx)(R.Link,{href:`${s}/speed-insights`,style:{display:"flex"},children:o}):o};var ey=e.i(5143983),ev=e.i(5484396),ew=e.i(6613731),eb=e.i(9771394),ek=e.i(1303150),eS=e.i(4396019);function eC(e){let{project:l,...i}=e,{domain:s,deployment:a,loaded:n}=(0,eS.useProjectProductionDeployment)(l?.id),r=(0,eb.usePlaceholder)()??!a,o=l&&!a;return(0,t.jsx)(t.Fragment,{children:!n||r?(0,t.jsx)(f.Skeleton,{style:{paddingTop:"62.5%",minHeight:"100%"},width:"100%"}):(0,t.jsx)(ek.DeploymentPreview,{...i,deployment:a,empty:o,placeholder:!1,projectDomain:s})})}var eN=e.i(5566974),eD=e.i(145675),eR=e.i(6440096);function eP(){return(0,t.jsx)(eA,{})}function eA(){let{promise:e}=(0,eD.useApi)(eR.getProjectProductionDeployment),{promise:i}=(0,eD.useApi)(eR.getDashboardProject),s=(0,l.use)(e),a=(0,l.use)(i);return s?.deployment?(0,t.jsx)(eN.DeploymentConfiguration,{deployment:s.deployment,project:a??null}):(0,t.jsx)(eN.DeploymentConfigurationRoot,{disabled:!0})}var eL=e.i(4585051),eI=e.i(8651268);let eB=l.memo(function(){let{deployment:e,size:l=24}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e?.creator?(0,t.jsx)(eI.PrincipalAvatar,{size:l,principalId:e.creator.uid,principal:{type:"user",uid:e.creator.uid,username:e.creator.username},showProviderIcon:!1,deploymentMeta:e.meta?.originalDeploymentId?void 0:e.meta}):(0,t.jsx)(eL.Avatar,{placeholder:!0,size:l})});var eM=e.i(2381001),eT=e.i(4040097),e_=e.i(1298796),eF=e.i(2982888),eU=e.i(1717203),eO=e.i(7557283),eE=e.i(8227242),e$=e.i(5802506),ez=e.i(930810),eH=e.i(1987826);e.i(3182268);var eV=e.i(7849855),eG=e.i(5924191),eW=e.i(5338940),eY=e.i(4244280),eK=e.i(8042625),eQ=e.i(1173672),eq=e.i(4597921),eJ=e.i(5072965);let eX=(0,W.default)(()=>e.A(2124931).then(e=>e.UndoRollbackModal),{loadableGenerated:{modules:[5755381]}});function eZ(e){let{rollbackDescription:i,project:s,deploymentId:a}=e,[n,r]=(0,l.useState)(!1),[o,d]=(0,l.useState)(i.description),[m,u]=(0,l.useState)(!1),x=function(){let{mutate:e}=(0,eG.useSWRConfig)(),{team:t}=(0,eW.useTeam)();return async(l,i,s)=>{if(!t)throw Error("Team not found");let a=`${(0,eY.API_DEPLOYMENT_UPDATE_ROLLBACK_DESCRIPTION)(l.id,i)}${(0,eK.encode)({teamId:t.id})}`;await (0,ej.fetchAPI)(a,{method:"PATCH",body:JSON.stringify({description:s}),throwOnHTTPError:!0}),await e((0,eQ.getProjectProductionDeploymentKey)({projectIdOrName:l.id,teamId:t.slug})),await e((0,eQ.getProjectProductionDeploymentKey)({projectIdOrName:l.name,teamId:t.slug}))}}(),p=(0,w.useToasts)(),{can:h}=(0,eU.default)(),j=void 0!==s&&void 0!==a&&h(eO.Action.Create,eO.Resource.DeploymentRollback),g=async()=>{if(s&&a){u(!0);try{await x(s,a,o),r(!1)}catch(e){p.error({text:"Something went wrong updating rollback description.",key:"update-rollback-description"}),(0,e$.captureError)(e)}finally{u(!1)}}};if(n){let e=o.length>=ez.REASON_MAX_CHARACTER_LENGTH;return(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial mb-4 w-full rounded bg-gray-200 px-3 py-2",children:[(0,t.jsx)(H.Textarea,{autoFocus:!0,className:"min-h-20 text-sm",value:o,onChange:e=>d(e.target.value),placeholder:"Production is not behaving as expected…",error:e?`Reason cannot be longer than ${ez.REASON_MAX_CHARACTER_LENGTH} characters.`:void 0}),(0,t.jsxs)("div",{className:"flex flex-row items-stretch justify-end gap-2 flex-initial",children:[(0,t.jsx)(c.Button,{onClick:()=>r(!1),type:"secondary",size:"small",children:"Cancel"}),(0,t.jsx)(c.Button,{onClick:g,loading:m,size:"small",disabled:e,children:"Update Reason"})]})]})}return(0,t.jsxs)("div",{className:"flex flex-row items-stretch justify-start gap-2 flex-initial mb-4 w-full rounded bg-gray-100 px-3 py-2 break-words",children:[(0,t.jsx)("p",{className:"text-copy-14 flex-1 min-w-0",children:i.description.length>0?(0,t.jsx)(eE.LinkParser,{text:i.description}):"No reason provided."}),j?(0,t.jsx)("div",{className:"grid place-content-center",children:(0,t.jsx)(v.Tooltip,{className:"w-full @md-page:w-auto",desktopOnly:!0,text:"Update rollback reason",children:(0,t.jsx)(R.Link,{onClick:()=>{d(i.description),r(!0)},children:(0,t.jsx)(V.PencilEdit,{color:"gray-900"})})})}):null]})}function e0(e){let{project:l,productionDeployment:i,productionAliases:s,isLoading:a}=e,n=(0,ew.useWrappedToolbarAuthLinkHandler)({via:"project-dashboard-alias-list",deployment:i??void 0}),r=(0,Y.useAgo)(i?.createdAt),o=(0,eF.getDeploymentCreatorUsername)({deployment:i}),c=(0,eq.useServerFlag)("enable-is-backend-project",!1),d=i&&s&&!a;return(0,t.jsxs)("div",{className:"flex flex-col gap-[22px]",children:[(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start flex-none",children:[(0,t.jsx)("div",{className:"max-w-full mx-auto w-[calc(100vw-(100vw-100%))] px-0 min-w-0",children:(0,t.jsx)(E.Description,{className:"[&>dd>span]:flex [&>dd>span]:overflow-hidden [&>dd>span_a]:inline-block [&>dd>span_a]:truncate",content:d?(0,t.jsx)(ev.default,{children:(0,t.jsx)(K.default,{deployment:i})}):(0,t.jsx)(f.Skeleton,{height:16,width:190}),title:"Deployment"})}),c?null:(0,t.jsx)("div",{className:"flex flex-row items-center justify-start gap-2 flex-initial",style:{marginLeft:"8px",marginRight:"8px"},children:d?(0,t.jsx)(ef,{project:l}):(0,t.jsx)(f.Skeleton,{boxHeight:32,height:32,rounded:!0,width:32})})]}),(0,t.jsx)("div",{className:"max-w-full mx-auto w-[calc(100vw-(100vw-100%))] px-0",children:(0,t.jsx)(E.Description,{content:d?(0,t.jsx)(ev.default,{children:(0,t.jsx)(Q.default,{defaultRoute:i.defaultRoute,domains:s,linkProps:n})}):(0,t.jsx)(f.Skeleton,{boxHeight:20,height:16,width:220}),title:(0,t.jsx)("div",{className:"max-w-full mx-auto w-[calc(100vw-(100vw-100%))] px-0",children:(0,t.jsx)(e2,{})})})}),(0,t.jsxs)("div",{className:"relative block min-w-px max-w-full flex-[0_1_auto] items-stretch justify-start @sm-page:flex @sm-page:flex-row @lg-page:flex-wrap",children:[(0,t.jsx)(E.Description,{content:d?(0,t.jsx)(ev.default,{children:(0,t.jsx)("div",{className:"relative flex h-[22px] min-w-px max-w-full flex-row items-center @lg-page:flex-wrap",children:(0,t.jsx)(el.DeploymentStatus,{deployment:i,label:!0,labelStyle:{fontWeight:500}})})}):(0,t.jsx)(f.Skeleton,{boxHeight:22,height:16,width:60}),title:"Status"}),(0,t.jsx)(y.Spacer,{x:1,y:.75}),(0,t.jsx)(E.Description,{content:d?(0,t.jsx)(ev.default,{children:(0,t.jsx)(z.RelativeTimeCard,{asChild:!0,date:i.createdAt,side:"top",children:(0,t.jsxs)("div",{className:"flex items-center gap-[0.4rem]",children:[(0,t.jsxs)(P.default,{className:"inline-block truncate",noMargin:!0,preset:"body-2",children:[r,o?` by ${o}`:null]}),(0,t.jsx)(eB,{deployment:i,size:22})]})})}):(0,t.jsx)(f.Skeleton,{boxHeight:22,height:16,width:180}),title:"Created"})]}),(0,t.jsx)("div",{className:"max-w-full mx-auto w-[calc(100vw-(100vw-100%))] px-0",children:(0,t.jsx)(E.Description,{content:d?(0,t.jsx)(ev.default,{children:(0,t.jsx)(et.DeploymentSourceLinks,{deployment:i,className:"gap-0.5"})}):(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-0.5 flex-initial",children:[(0,t.jsx)(f.Skeleton,{boxHeight:22,height:16,width:120}),(0,t.jsx)(f.Skeleton,{boxHeight:22,height:16,width:240})]}),title:"Source"})})]})}function e1(e){let{productionDeployment:l,productionAliases:i,isLoading:s}=e,a=l&&i&&!s,n=(0,ew.useWrappedToolbarAuthLinkHandler)({via:"project-dashboard-alias-list",deployment:l??void 0}),{projectSlug:r,teamSlug:o}=(0,eV.useProjectAndTeamSlug)();return o&&r?(0,t.jsxs)("div",{className:"flex min-h-[258px] flex-col gap-[22px]",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"mb-1 flex items-center justify-between",children:[(0,t.jsx)("p",{className:"text-copy-14 text-gray-900",children:"Rolling release in progress"}),(0,t.jsx)(R.Link,{variant:"highlight",href:`/${o}/${r}/deployments/rolling-release`,children:"Manage"})]}),(0,t.jsx)(eH.RollingReleaseDetails,{variant:"overview",projectSlug:r,teamSlug:o})]}),(0,t.jsx)(E.Description,{content:a?(0,t.jsx)(Q.default,{defaultRoute:l.defaultRoute,domains:i,linkProps:n}):(0,t.jsx)(f.Skeleton,{boxHeight:20,height:16,width:220}),title:(0,t.jsx)(e2,{})})]}):null}function e2(){let{projectSlug:e,teamSlug:l}=(0,eV.useProjectAndTeamSlug)();return(0,t.jsxs)("div",{className:"flex gap-2 items-center",children:["Domains",(0,t.jsx)(R.Link,{href:`/${l}/${e}/settings/domains`,...(0,eJ.createTrackingAttributes)({name:"add-new-domain"}),children:(0,t.jsx)(G.PlusCircle,{className:"cursor-pointer"})})]})}function e4(e){let{project:l,productionDeployment:i,previousDeployment:s,productionAliases:a,rollbackDescription:n,isLoading:r}=e,o=(0,ew.useWrappedToolbarAuthLinkHandler)({via:"project-dashboard-alias-list",deployment:i??void 0}),c=(0,Y.useAgo)(n?.createdAt),d=i&&a&&!r;return(0,t.jsxs)("div",{className:"flex min-h-[258px] flex-col gap-[22px]",children:[(0,t.jsx)(E.Description,{content:d?(0,t.jsxs)(t.Fragment,{children:[n?(0,t.jsx)(eZ,{rollbackDescription:n,project:l,deploymentId:i.id}):null,(0,t.jsx)("div",{className:"flex flex-col gap-2",children:(0,t.jsx)(ec,{deployment:i,icon:!0,isStale:!0,noPadding:!0,previousDeployment:s})})]}):(0,t.jsxs)("div",{className:"mb-8 flex flex-col gap-2",children:[(0,t.jsx)(f.Skeleton,{autoSize:!0,className:"h-[58px] w-full"}),(0,t.jsx)(f.Skeleton,{autoSize:!0,className:"h-[58px] w-full"})]}),title:n?(0,t.jsxs)("div",{className:"flex items-center gap-1 normal-case",children:["Rolled back ",c,n.username?(0,t.jsxs)(t.Fragment,{children:[" ","by"," ",(0,t.jsx)(eI.PrincipalAvatar,{size:22,principalId:n.userId,principal:{type:"user",uid:n.userId,username:n.username}})," ",n.username]}):null]}):"Rolled back"}),(0,t.jsx)(E.Description,{content:d?(0,t.jsx)(Q.default,{defaultRoute:i.defaultRoute,domains:a,linkProps:o}):(0,t.jsx)(f.Skeleton,{boxHeight:20,height:16,width:220}),title:(0,t.jsx)(e2,{})})]})}function e5(e){let{scope:s,project:a,productionAliases:n,productionDeployment:r,previousDeployment:o,upcomingDeployment:c,projectLink:d,isLoading:m,onCancelUpcomingDeployment:u,productionDeploymentIsStale:x,refreshPreviewImage:p,rollbackDescription:h,rollingReleaseResponse:j}=e,g=!!(!m&&a&&!r),[f,y]=(0,l.useState)(!1),v=j?.rollingRelease,w=a&&v&&"ACTIVE"===v.state,b=(0,t.jsx)(ey.ProductionDeploymentBar,{aliasError:c?.aliasError,loading:m,onCancelUpcomingDeployment:u,previousDeployment:o,productionDeployment:r,productionDeploymentIsStale:x,project:a,projectLink:d&&"type"in d&&d.type?d:null,upcomingDeployment:c});return(0,t.jsx)("div",{className:"max-w-full mx-auto w-[var(--geist-page-width-with-margin)] px-[var(--geist-page-margin)]",children:(0,t.jsxs)("div",{className:"relative flex min-w-px max-w-full flex-1 flex-col items-stretch justify-start",children:[g?(0,t.jsxs)(e_.DeploymentCardContainer,{children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(eT.ProductionDeploymentCardSkeleton,{visible:!1}),(0,t.jsx)(eM.NoDeploymentCard,{className:"rounded-md border-none shadow-[0_1px_0_0_rgba(0,0,0,0.08),0_2px_2px_rgba(0,0,0,0.04)]",project:a,scope:s,style:{position:"absolute",inset:0,zIndex:1,boxShadow:"none",height:"auto"}})]}),b]}):(0,t.jsxs)(e_.DeploymentCardContainer,{variant:(0,e_.getStatusBarVariant)({productionDeploymentIsStale:x,upcomingDeployment:c,isLoading:m}),children:[(0,t.jsxs)($.Fieldset,{className:(0,i.clsx)("z-[1] border-none","!shadow-[0_1px_0_0_rgba(0,0,0,0.08),_0_2px_2px_rgba(0,0,0,0.04)]","!rounded-md","[&>div:first-child]:p-4","dark:!shadow-[0_1px_0_0_var(--ds-gray-alpha-400)]","bg-clip-padding"),children:[(0,t.jsx)(O.FieldsetContent,{children:(0,t.jsxs)("div",{className:"relative flex min-w-px max-w-full flex-1 flex-col items-stretch justify-start gap-6 @lg-page:flex-row @lg-page:flex-wrap",children:[(0,t.jsx)("div",{className:"relative flex w-full min-w-px max-w-full flex-none flex-col items-stretch justify-start @lg-page:max-w-[38%]",children:(0,t.jsx)(eC,{project:a,refresh:p})}),(0,t.jsx)("div",{className:"relative flex min-w-px max-w-full flex-1 flex-col items-stretch justify-start pt-2",children:(()=>{switch(w?"rollingRelease":x&&!m?"rollback":"deployment"){case"rollback":return(0,t.jsx)(e4,{project:a,previousDeployment:o,productionAliases:n,productionDeployment:r,rollbackDescription:h,isLoading:m});case"rollingRelease":return(0,t.jsx)(e1,{productionAliases:n,productionDeployment:r,isLoading:m});default:return(0,t.jsx)(e0,{productionAliases:n,productionDeployment:r,project:a,isLoading:m})}})()})]})}),(0,t.jsx)(eP,{})]}),b]}),(0,t.jsx)(l.Suspense,{children:f?(0,t.jsx)(eX,{open:f,setOpen:y}):null})]})})}var e9=e.i(9974972),e8=e.i(9584282),e7=e.i(6619197),e3=e.i(5129431),e6=e.i(2645806),te=e.i(4029500),tt=e.i(5598924),tl=e.i(6119682),ti=e.i(13501),ts=e.i(1903055),ta=e.i(2941917),tn=e.i(6625227),tr=e.i(100247);let to=function(e){let{project:t,productionDeployment:i,revalidateProject:s}=e,a=t?.targets?.production,n=(0,tn.default)(a?.url,{refreshInterval:3e3}),r=n.data,[o,c]=l.useState(r),{areChecksRunning:d,areDomainsAssigning:m}=(0,tr.getDeploymentStatus)(r);l.useEffect(()=>{(r!==o&&r?.readyState==="READY"&&s(),a)?r&&r!==o&&c(r):c(null)},[a,r,s,o]);let u=!!(!a||n.error||o),x=o&&i?o.createdAt>i.createdAt:o&&!i;return{mutate:n.mutate,isLoading:!u,data:x&&(["QUEUED","BUILDING","ERROR"].includes(r?.readyState??"")||d||r?.checksConclusion==="failed"||m)?r:null}};var tc=e.i(2652226),td=e.i(58194),tm=e.i(6516601),tu=e.i(4218798),tx=e.i(5442212),tp=e.i(1122901),th=e.i(5771992),tj=e.i(7401972),tg=e.i(5326905),tf=e.i(1201436),ty=e.i(1991452),tv=e.i(7674801),tw=e.i(6015702),tb=e.i(6107899),tk=e.i(4345845),tS=e.i(8172029),tC=e.i(545405),tN=e.i(3907048),tD=e.i(5071474);let tR=(0,l.memo)(function(e){let{branch:s,redeploy:a,project:n,feedbackState:r}=e,{branch:o,deployment:c}=s,m=(0,l.useMemo)(()=>({...c,uid:c.id,readyState:c.readyState,ready:c.readyAt,created:c.createdAt,creator:{...c.creator,uid:c.creator?.uid??c.userId}}),[c]),u=(0,ee.getGitInfoFromDeployment)(c),x=function(e){if(!(0,ee.getGitInfoFromDeployment)(e))return;if(e.alias?.length===1)return e.alias[0];let t=`${e.name}-git-`,l=e.alias?.find(e=>e.startsWith(t));if(l)return l;let i=e.alias?.find(t=>{let l=t.indexOf("-git-");return -1!==l&&e.name.startsWith(t.substring(0,l))});return i||e.alias?.[e.alias.length-1]}(c)??c.url,p="ERROR"===c.readyState||"failed"===c.checksConclusion||c.aliasError,{latestSuccessfulDeployment:h}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,l=function(e){let{meta:t={}}=e??{};return"githubCommitRef"in t?{"meta-githubCommitRef":t.githubCommitRef}:"gitlabCommitRef"in t?{"meta-gitlabCommitRef":t.gitlabCommitRef}:"bitbucketCommitRef"in t?{"meta-bitbucketCommitRef":t.bitbucketCommitRef}:void 0}(t),i=t?.readyState==="READY",{data:s,isLoading:a}=(0,th.default)({limit:i||!l?0:1,projectId:e,state:"READY",...l});if(i)return{latestSuccessfulDeployment:t,isLoading:!1};if(!l)return{isLoading:!1};let[n]=s?.deployments??[];return{latestSuccessfulDeployment:n,isLoading:a}}(n?.id,p?void 0:m),{query:j}=(0,ty.useRouter)(),g=(0,tS.getQueryParam)(j.teamSlug)??"",f=(0,tS.getQueryParam)(j.project)??"",y=`/${g}/${f}/deployments${(0,eK.encode)({filterBranch:o})}`,v=`/${g}/${f}/logs?branches=${o}`,w=(0,K.useDeploymentLink)(c),{can:b}=(0,eU.default)({projectIdOrName:n?.name}),k=null!==c.target?eO.Resource.Deployment:eO.Resource.DeploymentPreview,S=b(eO.Action.Update,k),C=b(eO.Action.Read,k),N=h?`https://${x}`:w,D=u?.prUrl??u?.refUrl??u?.commitUrl,P=s.meta?.number??u?.prId?`#${s.meta?.number??u?.prId}`:"Source",A=(0,Y.useAgo)(c.createdAt),L=(0,ew.useWrappedToolbarAuthLinkHandler)({via:"active-branches",deployment:c});return(0,t.jsxs)("div",{className:(0,i.default)("group/branch-row relative grid grid-flow-row items-start gap-2 px-4 py-3","first:rounded-t last:rounded-b [&:has(.link-overlay:hover)]:bg-gray-100","md:flex md:flex-row md:items-center md:justify-between"),children:[(0,t.jsx)(R.Link,{className:"link-overlay absolute inset-0 z-[1]",href:N,...L}),(0,t.jsxs)("div",{className:"flex min-w-[110px] max-w-[230px] shrink items-center gap-x-2 sm:max-w-max md:max-w-[500px]",children:[(0,t.jsx)(tk.GitBranch,{className:"hidden md:inline-block",color:"gray-900",size:16}),(0,t.jsx)("p",{className:"text-label-14-mono truncate text-gray-alpha-1000",children:o})]}),(0,t.jsxs)("div",{className:(0,i.default)("grid w-full shrink-0 auto-cols-fr grid-flow-col gap-x-4 md:w-auto","lg:grid-cols-[var(--first-column)_var(--base-columns)]","grid-cols-[70px_90px_70px]"),style:{"--first-column":"minmax(0, 72px)","--base-columns":"minmax(0, 87px) 75px minmax(0, 120px) 60px 24px","--comment-column":"38px"},children:[(0,t.jsx)(tP,{href:N,...L,icon:(0,t.jsx)(tb.PreviewEye,{size:12}),label:"Preview"}),r&&r.unresolved>0?(0,t.jsx)(tP,{className:(0,i.default)("hidden md:flex"),"data-type":"comments",href:N,icon:(0,t.jsx)(tw.Message,{color:"gray-900",size:12}),label:r.unresolved.toString()}):null,(0,t.jsx)(tP,{className:"!gap-0.5",href:w,icon:(0,t.jsx)("div",{className:"flex items-center h-[10px]",children:(0,t.jsx)(el.DeploymentStatus,{deployment:m,className:"-my-0.5 pl-0.5"})}),label:(0,t.jsx)("span",{className:"font-mono",children:(0,tD.getDeploymentHash)(c)})}),D?(0,t.jsx)(tP,{href:D,icon:(0,t.jsx)(tv.LogoGithub,{size:12}),label:P}):null,(0,t.jsxs)("div",{className:"relative hidden items-center gap-x-2 lg:flex",children:[(0,t.jsx)(tN.CreatorAvatar,{deployment:c,size:20}),(0,t.jsx)("p",{className:"text-label-14 text-gray-900 truncate",children:!c.meta?.originalDeploymentId&&u?.commitAuthorLogin?u.commitAuthorLogin:c.creator?.username})]}),(0,t.jsx)("div",{className:"text-label-14 z-[2] hidden self-center whitespace-nowrap text-right text-gray-900 lg:block",children:(0,t.jsx)(z.RelativeTimeCard,{date:c.createdAt,ignoreCardPointerEvents:!0,side:"top",children:(0,t.jsx)("p",{className:"text-label-14 text-gray-900",children:A})})}),(0,t.jsx)(d.DotsMenu,{iconSize:14,menuButtonClassName:"z-[2] !h-full place-self-end",children:(0,t.jsx)(tA,{buildLogsUrl:w,canReadDeployment:C,canUpdateDeployment:S,deploymentsLink:y,gitAlias:x,redeploy:()=>{a?.(c)},runtimeLogsUrl:v})})]})]})}),tP=e=>{let{href:l,linkProps:s,label:a,icon:n,className:r}=e;return(0,t.jsxs)(R.Link,{className:(0,i.default)("flex items-center gap-1.5 bg-background-100","border border-solid border-gray-200 px-1.5 pr-2 py-1 rounded-full","text-gray-900 [&>p]:text-gray-900 z-[2] size-fit","hover:bg-gray-100 hover:border-gray-500","hover:text-gray-1000","group-has-[.link-overlay:hover]/branch-row:border-gray-500",r),href:l,...s,children:[n,(0,t.jsx)("p",{className:"text-label-12 !text-current",children:a})]})};function tA(e){let{canReadDeployment:l,canUpdateDeployment:i,deploymentsLink:s,gitAlias:a,redeploy:n,buildLogsUrl:r,runtimeLogsUrl:o}=e,c=(0,w.useToasts)(),{track:d}=(0,N.useTrackActivity)();return(0,t.jsxs)(t.Fragment,{children:[i?(0,t.jsx)(h.MenuItem,{onClick:()=>{n(),d(C.VercelActivityAction.ProjectOverviewActiveBranchesDeploymentRedeployClicked,{})},children:"Redeploy"}):null,l?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h.MenuItem,{href:s,isLink:!0,onClick:()=>void d(C.VercelActivityAction.ProjectOverviewActiveBranchesDeploymentViewBuildLogsClicked,{}),shouldOnClickWhenLink:!0,children:"View All Deployments"}),(0,t.jsx)(h.MenuItem,{href:r,isLink:!0,onClick:()=>void d(C.VercelActivityAction.ProjectOverviewActiveBranchesDeploymentViewBuildLogsClicked,{}),shouldOnClickWhenLink:!0,children:"View Build Logs"}),(0,t.jsx)(h.MenuItem,{href:o,isLink:!0,onClick:()=>void d(C.VercelActivityAction.ProjectOverviewActiveBranchesDeploymentViewRuntimeLogsClicked,{}),shouldOnClickWhenLink:!0,children:"View Runtime Logs"}),(0,t.jsx)(h.MenuItem,{onClick:()=>{(0,tC.copyToClipboard)(a),c.message("Copied deployment url to clipboard!"),d(C.VercelActivityAction.ProjectOverviewActiveBranchesDeploymentCopyBranchUrlClicked,{})},suffix:(0,t.jsx)(tf.Copy,{}),children:"Copy Branch URL"})]}):null,l&&i?null:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(tg.MenuDivider,{}),i?null:(0,t.jsx)(j.MenuItemLocked,{children:"Redeploy"}),l?null:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(j.MenuItemLocked,{children:"View Build Logs"}),(0,t.jsx)(j.MenuItemLocked,{children:"View Runtime Logs"}),(0,t.jsx)(j.MenuItemLocked,{children:"View Source"}),(0,t.jsx)(j.MenuItemLocked,{children:"Copy Branch URL"})]})]})]})}var tL=e.i(4173901),tI=e.i(2405338),tB=e.i(9365163),tM=e.i(424862),tT=e.i(1754766),t_=e.i(8610291),tF=e.i(4826121);function tU(e){let{widths:l=[50,15,10]}=e;return(0,t.jsxs)("div",{className:"relative flex flex-col justify-between gap-3 px-4 py-3.5 first:rounded-t-sm last:rounded-b-sm md:flex-row md:items-center md:gap-2","data-testid":(0,S.tid)("deployments","deployment-entity","no-uid"),children:[(0,t.jsxs)("div",{className:"flex grow flex-col gap-2 md:flex-row md:items-center",children:[(0,t.jsx)(tk.GitBranch,{className:"hidden md:inline-block",color:"gray-900",size:16}),(0,t.jsx)(f.Skeleton,{height:20,width:`${l[0]}%`})]}),(0,t.jsxs)("div",{className:"flex min-w-64 items-center gap-2",children:[(0,t.jsx)(f.Skeleton,{className:"rounded-full",height:20,width:73.2}),(0,t.jsx)(f.Skeleton,{className:"rounded-full",height:20,width:71.02}),(0,t.jsx)(f.Skeleton,{className:"rounded-full",height:20,width:90.08}),(0,t.jsx)("span",{className:"ml-auto",children:(0,t.jsx)(f.Skeleton,{height:20,width:24})})]})]})}function tO(){return(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-3 flex-initial px-6 pt-9 pb-6 geist-wrapper",children:[(0,t.jsxs)("div",{className:"flex flex-col items-start justify-start lg:justify-between gap-3 flex-initial",children:[(0,t.jsx)(f.Skeleton,{height:26,width:245}),(0,t.jsxs)("div",{className:"flex flex-col lg:flex-row items-stretch justify-start gap-2 flex-initial w-full",children:[(0,t.jsx)(f.Skeleton,{height:40,style:{flexGrow:0,flexShrink:1},width:"100%"}),(0,t.jsx)(f.Skeleton,{className:"!w-full md:!w-[192px]",height:40})]})]}),(0,t.jsx)(A.EntityGroup,{children:(0,t.jsxs)("div",{className:"flex flex-col !divide-solid rounded-md bg-background-100 !divide-x-0 !divide-y !divide-gray-alpha-400",children:[(0,t.jsx)(tU,{widths:[50,15,8]}),(0,t.jsx)(tU,{widths:[60,20,6]}),(0,t.jsx)(tU,{widths:[40,25,10]}),(0,t.jsx)(tU,{widths:[30,20,8]}),(0,t.jsxs)("div",{className:"hidden !divide-solid !divide-x-0 !divide-y !divide-gray-alpha-400 md:contents",children:[(0,t.jsx)(tU,{widths:[70,25,10]}),(0,t.jsx)(tU,{widths:[60,15,12]}),(0,t.jsx)(tU,{widths:[30,20,8]}),(0,t.jsx)(tU,{widths:[40,15,8]}),(0,t.jsx)(tU,{widths:[50,25,6]}),(0,t.jsx)(tU,{widths:[70,20,10]})]})]})})]})}var tE=e.i(835922),t$=e.i(6498376),tz=e.i(5035457),tH=e.i(9593963);function tV(){let{project:e="",teamSlug:s=""}=(0,k.useParams)()??{},{can:a,isLoading:n}=(0,eU.default)(),r=a(eO.Action.Read,eO.Resource.ObservabilityData),o=a(eO.Action.Read,eO.Resource.WebAnalytics),c=(0,eq.useServerFlag)("esp-547",!1),d=(0,l.useCallback)(()=>c?(0,t.jsx)(tH.ProjectSCPSkeleton,{}):(0,t.jsx)(tE.ProjectFirewallCardSkeleton,{}),[c]),m=(0,l.useCallback)(e=>{let{projectSlug:l,teamSlug:i}=e;return c?(0,t.jsx)(tH.ProjectSCP,{projectSlug:l,teamSlug:i}):(0,t.jsx)(tE.ProjectFirewallCard,{projectSlug:l,teamSlug:i})},[c]);return(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start flex-initial geist-wrapper",children:(0,t.jsx)("div",{className:(0,i.clsx)("mt-4 grid grid-cols-1 gap-4 lg:grid-cols-3"),children:n?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d,{}),(0,t.jsx)(tz.ProjectObservabilityCardSkeleton,{}),(0,t.jsx)(t$.ProjectAnalyticsCardSkeleton,{})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l.Suspense,{fallback:(0,t.jsx)(d,{}),children:(0,t.jsx)(m,{projectSlug:e,teamSlug:s})}),(0,t.jsx)(l.Suspense,{fallback:(0,t.jsx)(tz.ProjectObservabilityCardSkeleton,{}),children:r?(0,t.jsx)(tz.ProjectObservabilityCard,{teamSlug:s,projectSlug:e}):(0,t.jsx)(tz.ProjectObservabilityCardNoAccess,{})}),(0,t.jsx)(l.Suspense,{fallback:(0,t.jsx)(t$.ProjectAnalyticsCardSkeleton,{}),children:o?(0,t.jsx)(t$.ProjectAnalyticsCard,{projectSlug:e,teamSlug:s}):(0,t.jsx)(t$.ProjectAnalyticsCardNoAccess,{})})]})})})}var tG=e.i(7132425),tW=e.i(3748432),tY=e.i(5709282),tK=e.i(588428),tQ=e.i(5797774),tq=e.i(4899593);function tJ(e){let{project:l}=e,{team:i}=(0,eW.useTeam)(),{value:s}=(0,tK.useV0RBAC)();return l?.v0&&i?(0,t.jsx)(tQ.ContextCard.Trigger,{content:(0,t.jsxs)("div",{className:"max-w-52 flex flex-col gap-4",children:[(0,t.jsxs)("p",{className:"text-copy-14 text-gray-900",children:["This project is created and managed on"," ",(0,t.jsx)(R.Link,{href:"https://v0.app",target:"_blank",type:"primary",children:"v0.app"}),"."]}),s&&(0,t.jsx)("p",{className:"text-copy-14 text-gray-900 mt-2",children:"Users with v0-specific access controls will be able to manage this project."}),(0,t.jsx)(c.Button,{Component:"a",size:"small",type:"secondary",className:"w-full",href:`/${i.slug}/~/settings/members`,children:"Manage Access"})]}),side:"bottom",children:(0,t.jsx)("div",{className:"bg-blue-300 text-blue-900 hover:bg-blue-400 flex items-center justify-center size-[28px] rounded-full",children:(0,t.jsx)(tq.V0Mark,{size:16,style:{"--geist-foreground":"currentColor"}})})}):null}function tX(e){let{isLoadingDeployment:l,...s}=e,{data:a}=(0,td.default)(s.productionDeployment?.url);return!l&&a&&s.project&&s.productionDeployment?(0,t.jsx)(tZ,{buildsData:a.builds,...s}):(0,t.jsx)("div",{className:`flex flex-col items-stretch justify-start flex-initial ${(0,i.clsx)("geist-show-on-tablet")}`,children:(0,t.jsx)(d.DotsMenu,{})})}let tZ=l.default.memo(e=>{let{project:l,productionDeployment:r,canRollbackDeployment:o,openRollbackModal:m,rollbackTooltip:u}=e,x=(0,k.useRouter)(),p=(0,k.useParams)(),g=(0,K.useDeploymentLink)(r),{link:f}=function(){let e,{deploymentUrl:t,branchName:l,project:i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{team:s,user:a,isLoading:n}=(0,eh.useAccount)(),r=n?void 0:s?.slug||a?.username;return r&&(e=i?`/${[r,i].map(encodeURIComponent).join("/")}/logs?${t?`deploymentDomains=${t}`:""}${l?`&branches=${l}`:""}`:`/${encodeURIComponent(r)}/~/logs?${t?`deploymentDomains=${t}`:""}${l?`&branches=${l}`:""}`),{link:e}}({deploymentUrl:r?.url,branchName:l?.link?.productionBranch??"",project:p?.project});if(null===r)return(0,t.jsx)("div",{style:{width:88}});let y=f||"",w="View Runtime Logs",b=null,C=null;return!o||u?(b=(0,t.jsx)(v.Tooltip,{text:u||"You do not have permission to rollback this project",children:(0,t.jsx)(c.Button,{disabled:!0,size:"small",type:"secondary",children:(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-2 flex-initial",children:[u?(0,t.jsx)(a.Stop,{color:"gray-500"}):(0,t.jsx)(s.LockClosed,{color:"gray-500"}),(0,t.jsx)("span",{children:"Instant Rollback"})]})})}),C=(0,t.jsx)(h.MenuItem,{disabled:!0,suffix:u?(0,t.jsx)(a.Stop,{color:"gray-500"}):(0,t.jsx)(j.MenuItemLocked,{color:"gray-500"}),children:"Instant Rollback"})):(b=(0,t.jsx)(c.Button,{onClick:m,size:"small",type:"secondary",typeName:"button",children:(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-2 flex-initial",children:[(0,t.jsx)(n.RotateCounterClockwise,{}),(0,t.jsx)("span",{children:"Instant Rollback"})]})}),C=(0,t.jsx)(h.MenuItem,{onClick:m,suffix:(0,t.jsx)(n.RotateCounterClockwise,{}),children:"Instant Rollback"})),(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start",style:{marginTop:0,flex:"0 0 auto"},children:(0,t.jsxs)("div",{className:"flex flex-row items-stretch justify-start",style:{flex:"0 0 auto"},children:[(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-3 geist-hide-on-tablet",style:{flex:"0 0 auto"},children:[(0,t.jsx)(R.ButtonLink,{href:g,size:"small",title:"View Build Logs",type:"secondary",children:"Build Logs"}),(0,t.jsx)(R.ButtonLink,{href:y,size:"small",title:w,type:"secondary",children:"Runtime Logs"}),b]}),(0,t.jsx)("div",{className:`flex flex-row items-center justify-start flex-initial ${(0,i.clsx)("geist-show-on-tablet")}`,children:(0,t.jsxs)(d.DotsMenu,{children:[(0,t.jsx)(h.MenuItem,{onClick:()=>x.push(g),children:"View Build Logs"}),(0,t.jsx)(h.MenuItem,{"data-testid":(0,S.tid)("production-links","function-logs-button"),onClick:()=>x.push(y),children:w}),C]})})]})})});function t0(e){let{branches:i,handleCancelDeployment:s,handleClickCreateAlias:a,handleClickRedeploy:n,project:r,productionDeploymentId:o}=e,[c]=function(e){let{projectId:t,branches:i=[]}=e,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{isReady:a,team:n}=(0,eW.useTeam)(),r=(0,l.useRef)(new Map),o=(0,tI.default)(()=>t&&a&&0!==i.length?`/api/feedback/branch-state${(0,eK.encode)({projectId:t,teamId:n?.id,branch:i})}`:null,e=>fetch(e).then(e=>e.json()),s);return(0,l.useEffect)(()=>{if(o.data)for(let e of o.data)r.current.set(e.branch,e)},[o.data]),[(0,l.useMemo)(()=>{let e={};for(let t of i)e[t]=o.data?.find(e=>e.branch===t)??r.current.get(t);return e},[o.data,i]),o]}({projectId:r?.id,branches:i.map(e=>e.branch)});return(0,t.jsx)(t.Fragment,{children:i.map(e=>(0,t.jsx)(tR,{branch:e,feedbackState:c[e.branch],handleCancelDeployment:s,handleClickCreateAlias:a,isCurrentProductionDeployment:o===e.deployment.id,project:r,redeploy:n},e.deployment.id))})}function t1(e){let{repositoryButton:i,usageButton:s,domainsSettingsButton:a,visitButton:n}=e,o=(0,k.useParams)(),{promise:c}=(0,eD.useApi)(eR.getProjectOverview),d=(0,l.use)(c),m=`/${encodeURIComponent(o?.teamSlug??"")}/${encodeURIComponent(o?.project??"")}/settings/domains`,j=t9(d);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"block md:hidden",children:(0,t.jsxs)("div",{className:"flex flex-row items-stretch justify-start gap-3 flex-initial",children:[n,i,(0,t.jsxs)(p.MenuContainer,{children:[(0,t.jsx)(x.MenuButton,{"aria-label":"Menu",shape:"square",svgOnly:!0,type:"secondary",children:(0,t.jsx)(r.MoreHorizontal,{})}),(0,t.jsxs)(u.Menu,{children:[(0,t.jsx)(h.MenuItem,{href:m,isLink:!0,children:"Domains"}),j?(0,t.jsx)(h.MenuItem,{href:j,isLink:!0,children:"Usage"}):null]})]})]})}),(0,t.jsxs)("div",{className:"hidden md:flex flex-wrap flex-row md:flex-row lg:flex-row-reverse items-stretch justify-start gap-4 flex-initial",children:[n,a,s,i]})]})}function t2(e){let{rowLimit:i,project:s,projectIdOrName:a,teamSlug:n,isProjectLoading:r,cancelModal:o,rollbackModal:c}=e,[d,u]=(0,l.useState)(i),{data:x}=(0,ta.default)({project:s,limit:d}),[p,h]=(0,l.useState)(null),j=x?.aliases||p,{modal:g,open:f}=(0,e3.default)(s),{modal:v,open:w}=(0,e7.default)(a,s),{track:k}=(0,N.useTrackActivity)(),S=(0,l.useCallback)((e,t)=>{t?w(e):f(e)},[w,f]),{filteredBranch:D,setFilteredBranch:R,clearBranch:P,showBranchFilterBar:L}=(0,tx.useProjectFilteredBranch)({project:s}),{isInitialStatusItems:M,selectedStatusItems:T,handleSelectStatusItem:_}=(0,tp.useFilterStatus)(),[F,O]=(0,l.useState)(""),[E,{size:$,isLoading:z},H]=function(e){let{limit:t,project:l,users:i,readyStateFilter:s,branchSearch:a,branch:n}=e,r=!!l?.hasActiveBranches,o=(0,th.useDeploymentsInfinite)({limit:t,project:r?void 0:l,requireProject:!0,users:i,target:"preview",branch:n,readyStateFilter:s},{refreshInterval:5e3}),c=(0,tj.useProjectDeployedBranches)({limit:t,project:r?l:void 0,includeDeploymentInfo:!0,active:!0,includeProductionBranch:!1,query:a,readyStateFilter:s},{refreshInterval:5e3,keepPreviousData:!0,revalidateFirstPage:!0,persistSize:!0});return r?[!0,...c]:[!1,...o]}({limit:i,project:s,branch:D??void 0,readyStateFilter:(0,tp.getReadyStateFilter)(T),branchSearch:F}),{isLoadingMore:V,isReachingEnd:G,initialDataLoaded:W,isEmpty:Y,loadMore:K,mutate:Q}=H,[q,J]=(0,l.useState)(null),{data:X}=(0,tn.default)(q),Z=(0,l.useCallback)(e=>{J("uid"in e?e.uid:e.id)},[]),[ee,et]=(0,l.useState)(!1),el=(0,l.useCallback)(()=>{et(!0)},[]),ei=(0,l.useCallback)(()=>{et(!1)},[]);return(0,t.jsx)(t.Fragment,{children:s&&W?(0,t.jsxs)("div",{className:"max-w-full mx-auto w-[var(--geist-page-width-with-margin)] px-[var(--geist-page-margin)]",children:[(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(y.Spacer,{y:1.5}),(0,t.jsxs)("div",{id:"preview-deployments",className:"flex flex-col items-stretch lg:justify-between flex-initial",children:[(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start gap-1 flex-initial",children:(0,t.jsx)("p",{className:"text-heading-20",children:E?"Active Branches":"Preview Deployments"})}),(0,t.jsx)(y.Spacer,{y:.5}),!!(!Y||!M||D||F)&&(0,t.jsx)("div",{className:"flex flex-col md:flex-row lg:flex-row items-stretch justify-start flex-initial",children:E?(0,t.jsxs)("div",{className:"flex w-full flex-col gap-2 md:flex-row",children:[(0,t.jsx)("div",{className:"grow",children:(0,t.jsx)(tL.DebouncedSearchInput,{disabled:Y&&!F,loading:z&&F.length>0,onFocus:()=>void k(C.VercelActivityAction.ProjectOverviewActiveBranchesSearchFocused,{}),setSearch:O})}),(0,t.jsx)(tp.default,{handleSelectStatusItem:_,menuButtonClassName:"w-full !justify-between md:!justify-center md:w-auto",position:"none",selectedStatusItems:T})]}):(0,t.jsxs)("div",{className:"flex w-full flex-col gap-2 md:flex-row",children:[(0,t.jsx)(tp.default,{handleSelectStatusItem:_,position:"none",selectedStatusItems:T}),(0,t.jsx)(tt.BranchSearchCombobox,{onSelect:R,project:s,skeleton:!s,value:D||""})]})})]}),L&&!E?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(y.Spacer,{y:.5}),(0,t.jsx)(te.FilteredBranchEntityBar,{branch:D,deployments:H.deployments,isLoading:!W,onClearBranch:P,project:s})]}):(0,t.jsx)(y.Spacer,{y:.5}),Y?(0,t.jsx)(U,{branch:D,onClearBranch:P,isUsingActiveBranches:E}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(A.EntityGroup,{children:(0,t.jsxs)(t.Fragment,{children:[!r&&E?(0,t.jsx)("div",{className:"flex flex-col !divide-solid rounded bg-background-100 !divide-x-0 !divide-y !divide-gray-alpha-400",children:(0,b.default)(H.branches,i).map(e=>(0,t.jsx)(t0,{branches:e,handleCancelDeployment:Z,handleClickCreateAlias:el,handleClickRedeploy:S,project:s},e[0].deployment.id))}):null,r||E?null:H.deployments.map(e=>(0,t.jsx)(B.DeploymentRow,{deployment:e,handleCancelDeployment:Z,handleClickCreateAlias:el,redeploy:S,projectIdOrName:a},e.uid)),r?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(B.DeploymentRow,{}),(0,t.jsx)(B.DeploymentRow,{}),(0,t.jsx)(B.DeploymentRow,{}),(0,t.jsx)(B.DeploymentRow,{}),(0,t.jsx)(B.DeploymentRow,{}),(0,t.jsx)(B.DeploymentRow,{}),(0,t.jsx)(B.DeploymentRow,{}),(0,t.jsx)(B.DeploymentRow,{}),(0,t.jsx)(B.DeploymentRow,{}),(0,t.jsx)(B.DeploymentRow,{})]}):null]})}),G?(0,t.jsx)(m.LoadMoreButton,{placeholder:!0}):(0,t.jsx)(m.LoadMoreButton,{loading:V&&$>1,onClick:()=>{K(),h(j),u(d+i)}})]}),(0,t.jsx)(I.default,{active:ee,onCancel:ei}),o,(0,t.jsx)(e6.default,{active:!!X,deployment:X,onClose:()=>{J(null),Q()},teamId:n}),c,g,v]}),(0,t.jsx)(y.Spacer,{y:2})]}):(0,t.jsx)(tO,{})})}function t4(e){let{projectId:i,projectPaused:s,teamSlug:a}=e,[n,r]=(0,l.useState)(!1),o=(0,l.useCallback)(async()=>{if(i&&a)try{await (0,t_.resumeProject)(i,a),w.toasts.success("Resumed project")}catch{w.toasts.error("Error resuming project")}finally{r(!1)}},[i,a]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(t5,{handleSetShowResumeModal:r,projectPaused:s}),(0,t.jsx)(tT.ResumeServiceModal,{active:n,hide:()=>r(!1),save:o,teamSlug:a})]})}function t5(e){let{projectPaused:l,handleSetShowResumeModal:i}=e;return l?(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start flex-initial p-4",children:(0,t.jsx)(g.Note,{action:(0,t.jsx)(c.Button,{onClick:()=>i(!0),size:"small",children:"Resume Service"}),fill:!0,type:"warning",children:(0,t.jsxs)("p",{className:"text-copy-14 text-amber-900",children:[(0,tM.noOrphan)("The project is paused and your Production Deployment is currently unavailable. "),(0,t.jsx)(R.Link,{external:!0,href:"/docs/projects/overview#pausing-a-project",underline:!0,children:"Learn More"})]})})}):null}tZ.displayName="ProductionLinks";let t9=e=>{let t=(0,k.useParams)(),l=t?.teamSlug;return l&&e?`/${l}/~/usage?${tF.USAGE_TAB_PROJECT_QUERY_PARAM_KEY}=${e.id}`:null};e.s(["default",0,function(e){let s=(0,D.useIsMobile)()?5:10,a=(0,k.useParams)(),n=a?.project,[r,c]=(0,l.useState)(!1),d=(0,l.useCallback)(()=>{c(!0)},[]),{data:m,isLoading:u,error:x,mutate:p}=(0,eD.useApi)(eR.getProjectOverview,{refreshInterval:3e4,dedupingInterval:1e3});(0,tm.default)("newCreated","Your project was created and is deploying."),(0,tm.default)("deploymentDeleted","The deployment was deleted."),(0,tm.default)("fromTransfer","Transferred Project successfully.","success",!!m?.transferCompletedAt);let h=m?.link,{data:j,isLoading:g}=(0,eD.useApi)(eR.getProjectProductionDeployment),{deployment:v,deploymentIsStale:w,rollbackDescription:b}=j??{},S=to({project:m,productionDeployment:v,revalidateProject:p}),{data:C}=function(e){let{project:t,productionDeploymentIsStale:l}=e,{data:i,mutate:s,...a}=(0,th.default)({projectId:l&&t?t.id:"",limit:10,rollbackCandidate:!0}),n=i?.deployments.filter(e=>e.isRollbackCandidate),r=n?.[0];return{...a,data:r,mutate:()=>s()}}({project:m,productionDeploymentIsStale:w}),{data:N,isLoading:R}=(0,eD.useApi)(eR.getProjectDomains),A=N?.domains??[],I=(0,l.useMemo)(()=>(0,tY.getSortedNonRedirectDomains)(A).map(e=>e.name),[A,R]),{data:B,isLoading:M}=(0,eD.useApi)(eR.getProjectRollingRelease),T=(0,tu.useProjectTransferring)(m),_=u||g||R||M,[F,U]=(0,l.useState)(0),O=(0,l.useCallback)(()=>{U(e=>e+1)},[]),{canRollbackDeployment:E,rollbackModal:$,openRollbackModal:z}=(0,tB.useInstantRollbackModal)(m,{onClose:O});(0,ts.default)(x);let H=(0,l.useCallback)(()=>n?(0,t.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[(0,t.jsx)("p",{className:"text-heading-32 truncate",children:n}),(0,t.jsx)(tG.MicrofrontendsBadge,{className:"relative top-px",project:m??null}),(0,t.jsx)(tJ,{project:m??null})]}):(0,t.jsx)(f.Skeleton,{height:40,width:220}),[n,m]);return(0,t.jsxs)("div",{style:{background:"var(--ds-background-200)",minHeight:"calc(100vh - var(--navbar-height))"},children:[(0,t.jsx)(L.HeadTitle,{title:m?`${m.name} – Overview`:"Overview",titlePostfix:!0}),(0,t.jsx)(t4,{projectId:m?.id,projectPaused:!!m?.paused,teamSlug:a?.teamSlug??""}),T?(0,t.jsxs)("div",{className:"max-w-full mx-auto w-[var(--geist-page-width-with-margin)] px-[var(--geist-page-margin)]",children:[(0,t.jsx)(y.Spacer,{y:2}),(0,t.jsx)(e9.default,{})]}):null,m&&!T?(0,t.jsx)(tl.DiscontinuedNodeBanner,{project:m,teamSlug:a?.teamSlug??""}):null,m&&!T?(0,t.jsx)(ti.ExceededMicrofrontendsLimitBanner,{project:m,teamSlug:a?.teamSlug??""}):null,(0,t.jsx)(tc.default,{buttons:(0,t.jsx)(t1,{repositoryButton:e.repositoryButton,usageButton:e.usageButton,domainsSettingsButton:e.domainsSettingsButton,visitButton:e.visitButton}),title:(0,t.jsx)(H,{}),truncateTitle:!0,updatedStyles:!0}),T?(0,t.jsx)("div",{className:"max-w-full mx-auto w-[calc(100vw-(100vw-100%))] px-0 min-h-[calc(100vh-280px)] bg-[var(--ds-background-200)] py-[var(--geist-gap-double)]",children:(0,t.jsx)("div",{className:"max-w-full mx-auto w-[var(--geist-page-width-with-margin)] px-[var(--geist-page-margin)]",children:(0,t.jsx)(e8.default,{})})}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"max-w-full mx-auto w-[calc(100vw-(100vw-100%))] px-0 pt-6",children:[(0,t.jsx)("div",{className:"max-w-full mx-auto w-[var(--geist-page-width-with-margin)] px-[var(--geist-page-margin)]",children:(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start flex-initial",style:{justifyContent:"space-between"},children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)(P.default,{h3:!0,noMargin:!0,style:{flex:"0 1 auto"},children:["Production"," ",(0,t.jsx)("span",{className:(0,i.clsx)({"hidden md:inline":w&&!_}),children:"Deployment"})]}),w&&!_?(0,t.jsx)(o.Badge,{variant:"amber-subtle",children:"Rolled Back"}):null]}),(0,t.jsx)(tX,{canRollbackDeployment:E,isLoadingDeployment:g,openRollbackModal:()=>z(),productionDeployment:v??(0,ex.getProductionDeployment)(m),project:m,rollbackTooltip:""})]})}),(0,t.jsx)(y.Spacer,{y:1}),(0,t.jsx)(tW.ConditionalNavigationMarker,{enabled:_,label:"ProductionDeploymentCard",phase:"skeleton"}),(0,t.jsx)(tW.ConditionalNavigationMarker,{enabled:!_,label:"ProductionDeploymentCard",phase:"content",children:(0,t.jsx)(e5,{isLoading:_,onCancelUpcomingDeployment:d,previousDeployment:C,productionAliases:I,productionDeployment:v,productionDeploymentIsStale:!!w,project:m,projectLink:h,refreshPreviewImage:F,rollbackDescription:b,scope:a?.teamSlug||"",upcomingDeployment:S.data,rollingReleaseResponse:B})})]}),(0,t.jsx)(tV,{}),(0,t.jsx)(t2,{cancelModal:(0,t.jsx)(e6.default,{active:!!(S.data&&r),deployment:S.data,onClose:()=>{c(!1),S.mutate()},teamId:a?.teamSlug??""}),projectIdOrName:n,rowLimit:s,project:m,teamSlug:a?.teamSlug??"",isProjectLoading:u,rollbackModal:$})]})]})}],2766871)}]);

//# debugId=941a6e4b-1e93-6665-27f9-18e871f2dc14
//# sourceMappingURL=36f451528284cce9.js.map