;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="7cdf59ad-bab2-0d89-85bc-d173e2f47712")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,4351165,e=>{"use strict";var t=e.i(1146226),n=e.i(5169864);let r=(0,n.createContext)(null);function a(e){let{children:n,perTLDPropagationTimeMap:a}=e;return(0,t.jsx)(r.Provider,{value:a,children:n})}function i(e){let t=(0,n.useContext)(r);return t?t.get(e):(console.warn("usePerTLDPropagationTime must be used within a PerTLDPropagationTimeProvider, returning null"),null)}e.s(["PerTLDPropagationTimeProvider",()=>a,"useTldPropagationTime",()=>i])},5519011,e=>{e.v({content:"add-domain-in-use-modal-module__vFG4Bq__content",favicon:"add-domain-in-use-modal-module__vFG4Bq__favicon",inset:"add-domain-in-use-modal-module__vFG4Bq__inset",loadingItem:"add-domain-in-use-modal-module__vFG4Bq__loadingItem",noteCenterText:"add-domain-in-use-modal-module__vFG4Bq__noteCenterText",outset:"add-domain-in-use-modal-module__vFG4Bq__outset",subitem:"add-domain-in-use-modal-module__vFG4Bq__subitem"})},8162654,e=>{"use strict";var t=e.i(1146226),n=e.i(3306538),r=e.i(2504781),a=e.i(5255926),i=e.i(5468328),s=e.i(8161149),l=e.i(3500331),o=e.i(8522580),d=e.i(8674454),c=e.i(4991687),u=e.i(6694387),m=e.i(57106),h=e.i(6239252),x=e.i(5169864),f=e.i(4345845),p=e.i(3162826),g=e.i(7813548),j=e.i(9722978),v=e.i(5610834),b=e.i(6143247),y=e.i(1717203),w=e.i(7557283),N=e.i(5927860),S=e.i(4274392),C=e.i(902715),I=e.i(1991452),k=e.i(6891161),D=e.i(9318197),P=e.i(4004502),z=e.i(8518548);function A(e){let{setRemoveModal:n,removeModal:r,domain:a,onRemoveDomain:s,removing:l,error:d}=e,c=(0,I.useRouter)(),u=(0,x.useCallback)(()=>n(!1),[n]),{can:m}=(0,y.default)(),h=m(w.Action.Update,w.Resource.Project),{data:f}=(0,z.useProjectDomains)(c.query.project,{redirect:a}),p=(f?.length??0)>0,g=(0,x.useCallback)(async()=>{await s({removeRedirects:p})},[p,s]),j=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(k.Modal.Header,{children:(0,t.jsx)(k.Modal.Title,{children:"Remove Domain from Project"})}),(0,t.jsx)(D.Spacer,{}),(0,t.jsxs)("p",{className:"text-copy-14",children:["Removing ",(0,t.jsx)("strong",{children:a})," will disconnect it from your project. This project will no longer be accessible from this domain, including in production."]}),(0,t.jsx)(D.Spacer,{}),p?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(o.Note,{type:"warning",children:["This domain has ",f?.length," redirect",f?.length===1?"":"s"," pointing to it:"," ",f?.map(e=>`"${e.name}"`).join(", "),". Removing this domain will also remove the domains that redirect to it."]}),(0,t.jsx)(D.Spacer,{})]}):null,d?(0,t.jsx)(o.Note,{type:"error",children:d}):null]}),v=(f?.length??0)+1,b=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(k.Modal.Action,{onClick:()=>n(!1),type:"secondary",children:"Cancel"}),(0,t.jsx)(i.Tooltip,{disableTriggers:h,text:"You don't have permission to manage domains in this project. Ask your team admin to manage domains or grant you the member role or higher.",children:(0,t.jsx)(k.Modal.Action,{"data-testid":(0,P.tid)("project","settings","domains","remove-domain-modal","confirm-button"),disabled:l||!h,loading:l,onClick:g,type:"error",children:p?`Remove ${2===v?"Both":`All ${v}`} Domains`:"Remove"})})]});return(0,t.jsxs)(k.Modal,{active:r,"data-testid":(0,P.tid)("project","settings","domains","remove-domain-modal"),onClickOutside:u,width:"520px",children:[(0,t.jsx)(k.Modal.Body,{children:j}),(0,t.jsx)(k.Modal.Actions,{children:b})]})}var E=e.i(693385),T=e.i(7957424),R=e.i(542164),O=e.i(822157),_=e.i(1516738),B=e.i(8835183);function $(e){let n=(0,x.useRef)(null);return(0,x.useEffect)(()=>{let e=e=>{if((e.metaKey||e.ctrlKey)&&"f"===e.key){let t=n.current;document.activeElement!==t&&(e.preventDefault(),t?.focus())}};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[]),(0,t.jsx)(B.SearchInput,{ref:n,clearable:!1,value:e.value,name:"search",error:e.noResultsFound?"We couldn't find any domains matching your search.":void 0,onChange:t=>e.setSearch(t.target.value),placeholder:"Searchâ€¦",width:"100%"})}var M=e.i(3322724),F=e.i(6881349),L=e.i(9668517),W=e.i(6060673),V=e.i(2928617);function G(e){let n=(0,L.useTeamSlug)(),r=(0,v.useParams)(),{data:a}=(0,W.useProject)(r?.project);return a?.link?(0,t.jsx)(U,{project:a,...e}):(0,t.jsx)("div",{className:"flex flex-row items-stretch justify-start gap-4 flex-initial",children:(0,t.jsx)(m.ButtonLink,{as:`/${n}/${a?.name}/settings/git`,href:`/${n}/${a?.name}/settings/git`,size:"small",type:"secondary",children:"Connect Git Repository"})})}function U(e){let{disabled:r,onChange:a,onFocus:i,project:s,value:l,environmentId:o,clearable:d=!1}=e,{data:c}=(0,V.useProjectBranches)(s.id),u=(c||[]).map(e=>e.ref),m=u.filter(e=>e!==s.link.productionBranch);return(0,t.jsxs)(F.Combobox,{className:"flex w-full",clearable:d,disabled:r,onChange:e=>a?.(e??""),placeholder:"All Branches",value:l,children:[(0,t.jsx)(F.Combobox.Input,{"aria-label":"Git Branch",onChange:e=>a?.(e.target.value),onFocus:i}),(0,t.jsxs)(F.Combobox.List,{emptyMessage:"No Branches",children:[(0,t.jsx)(t.Fragment,{children:!!l&&!u.includes(l??"")&&(0,t.jsx)(F.Combobox.Option,{displayValue:!0,value:l??"",children:`Use "${l}"`})}),(0,t.jsx)(t.Fragment,{children:"production"===o&&(0,t.jsxs)(F.Combobox.Option,{value:s.link.productionBranch||"",children:[(0,t.jsx)("p",{className:"text-copy-14",children:s.link.productionBranch}),(0,t.jsx)(D.Spacer,{inline:!0,x:1/4}),(0,t.jsx)(n.Badge,{variant:"blue",children:"Production"})]})}),(0,t.jsx)(t.Fragment,{children:m.map(e=>(0,t.jsx)(F.Combobox.Option,{value:e,children:e},e))})]})]})}var Y=e.i(818351),q=e.i(8042625),H=e.i(4244280),J=e.i(4937017);e.i(3512434);var Q=e.i(9835407),K=e.i(1873881),X=e.i(1395335);let Z=Q.z.object({cns:Q.z.array(Q.z.string()),expiresAt:Q.z.number()}),ee=Q.z.union([Q.z.object({certs:Q.z.array(Z)}),Q.z.undefined()]),et=Q.z.object({error:Q.z.object({status:Q.z.number().optional(),message:Q.z.string(),code:Q.z.enum(["public-alias","no-permissions-certs"]).optional()})});var en=e.i(8785423);let er=Q.z.object({providers:Q.z.array(Q.z.object({role:Q.z.string(),id:Q.z.string()})),nameserverProviders:Q.z.array(Q.z.string())}),ea=Q.z.object({error:Q.z.object({code:Q.z.enum(["not_found","invalid_name","internal_server_error"]),message:Q.z.string(),name:Q.z.string()})});async function ei(e,t){if(await new Promise(e=>{setTimeout(e,1)}),(0,X.isPublicAlias)(t))return{isDomainOnCloudflare:!1,hasCloudflareInFront:!1};let n=await (0,K.safeFetch)(e,{successSchema:er,failureSchema:ea});if(n.isErr())return{isDomainOnCloudflare:!1,hasCloudflareInFront:!1};let r=n.value.nameserverProviders.includes("Cloudflare"),a=n.value.providers.find(e=>"front-proxy"===e.role);return{isDomainOnCloudflare:r,hasCloudflareInFront:a?.id==="Cloudflare"}}let es=Q.z.null(),el=Q.z.object({error:Q.z.object({code:Q.z.enum(["invalid_name"]),message:Q.z.string()})});function eo(e,t){let n=(0,L.useTeamSlug)();return(0,Y.useIsomorphicSWR)(e.length>0?`${H.API_DOMAINS}/${encodeURIComponent(e)}/verify${(0,q.encode)({teamId:n})}`:null,async t=>(0,X.isPublicAlias)(e)?(0,J.okAsync)(null):(0,K.safeFetch)(t,{method:"POST",successSchema:es,failureSchema:el}),{refreshWhenHidden:!1,refreshWhenOffline:!1,revalidateOnReconnect:!0,revalidateOnFocus:!0,refreshInterval:15e3,dedupingInterval:15e3,...t})}let ed=Q.z.discriminatedUnion("result",[Q.z.object({result:Q.z.literal("success")}),Q.z.object({result:Q.z.literal("error"),message:Q.z.string(),code:Q.z.string()})]),ec=Q.z.object({error:Q.z.object({code:Q.z.enum(["incorrect_txt_record","txt_on_another_project","existing_project_domain","txt_on_wrong_domain"]),message:Q.z.string(),name:Q.z.string().optional()})});var eu=e.i(4030453),em=e.i(6607601),eh=e.i(7073483),ex=e.i(2405338);let ef=Q.z.object({boughtAt:Q.z.number().nullable(),verified:Q.z.boolean().optional(),createdAt:Q.z.number(),cdnEnabled:Q.z.boolean(),configVerifiedAt:Q.z.number().nullable().optional(),expiresAt:Q.z.number().nullable(),id:Q.z.string(),intendedNameservers:Q.z.array(Q.z.string()),movedAt:Q.z.number().optional(),movedFromOwnerId:Q.z.string().optional(),name:Q.z.string(),nameservers:Q.z.array(Q.z.string()),nsVerifiedAt:Q.z.number().nullable(),orderedAt:Q.z.number().optional(),renew:Q.z.boolean().optional(),serviceType:Q.z.enum(["zeit.world","external","na"]),teamId:Q.z.string().nullable(),transferredAt:Q.z.number().nullable().optional(),txtVerifiedAt:Q.z.number().nullable(),verificationRecord:Q.z.string(),creator:Q.z.object({id:Q.z.string(),customerId:Q.z.string().nullable().optional(),email:Q.z.string(),username:Q.z.string(),name:Q.z.string().optional()}).optional(),zone:Q.z.boolean().optional(),userId:Q.z.string().nullable().optional()}),ep=Q.z.object({domain:ef}),eg=Q.z.object({error:Q.z.object({code:Q.z.string(),message:Q.z.string(),name:Q.z.string().optional()})});function ej(e,t){var n;let r=(0,L.useTeamSlug)();return(0,ex.default)(e&&r?(n={domainName:e,teamId:r},`${H.API_DOMAINS}/${encodeURIComponent(n.domainName)}${(0,q.encode)({teamId:n.teamId})}`):null,async t=>e&&(0,X.isPublicAlias)(e)?(0,J.errAsync)(new K.ApiError({error:{error:{code:"forbidden",message:`You don't have access to "${e}"`,name:e}}})):(0,K.safeFetch)(t,{successSchema:ep,failureSchema:eg}),{dedupingInterval:3e4,...t})}var ev=e.i(4237893),eb=e.i(2807882);function ey(e){let{children:n,tabs:r,disabled:a,selected:i,defaultSelected:s=0,onChange:l,borderless:o}=e,[d,c]=(0,x.useState)(s),u=void 0!==i?i:d;return(0,t.jsxs)("div",{className:(0,j.clsx)({[String(eb.default.disabled)]:a,[String(eb.default.borderless)]:o}),"data-geist-fieldset-tabs":"",children:[(0,t.jsx)("div",{className:eb.default.tabsRow,children:(0,t.jsx)(ev.Tabs,{selected:i?r[i]:r[d],setSelected:e=>{if(a)return;let t=r.findIndex(t=>t===e);void 0===i&&c(t),l?.(t)},style:{boxShadow:"none"},tabs:r.map(e=>({title:e,value:e}))})}),x.Children.map(n,(e,t)=>t===u?e:null)]})}var ew=e.i(8517043),eN=e.i(7137884),eS=e.i(9177891),eC=e.i(277234),eI=e.i(7917902),ek=e.i(2751307);function eD(e){let{teamDomain:n,projectDomain:r,refresh:a}=e,i=!!n?.zone,s=(0,L.useTeamSlug)(),{team:l}=(0,eI.useAccount)(),d=(0,x.useCallback)(async()=>{let e=`?teamId=${encodeURIComponent(s??"")}`;await (0,eC.fetchAPI)(`${H.API_DOMAINS}/${encodeURIComponent(r.name)}${e}`,{method:"PATCH",body:JSON.stringify({zone:!0}),throwOnHTTPError:!0}),a()},[r.name,s,a]);(0,x.useEffect)(()=>{let e=setTimeout(()=>{i||d()},2500);return()=>clearTimeout(e)},[i,d]);let c=l?.billing?.plan==="hobby";return n?(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsx)("span",{children:"Update your domain's nameservers to enable Vercel DNS."}),(0,t.jsx)(eS.NSConfiguration,{nameservers:n.intendedNameservers.length>0?n.intendedNameservers:ek.VERCEL_NAMESERVERS})]}):(0,t.jsx)(o.Note,{children:c?"Please move this domain to this team in order to use Vercel nameservers.":(0,t.jsxs)(t.Fragment,{children:["Please"," ",(0,t.jsx)(m.Link,{href:"https://vercel.com/docs/domains/working-with-domains/transfer-your-domain",className:"text-blue-900 underline",children:"move this domain"})," ","to this team in order to use Vercel nameservers. If no one on your team has access to this domain, contact support to prove ownership of it"]})})}function eP(e){let{dnsRecords:n,teamDomain:r,domainConfig:a,projectDomain:i,configMethod:s,domainConnectUrl:l,setConfigMethod:o,verifyTxtError:d}=e;if((0,R.default)(i.name)&&(!a||"zeit.world"!==a.serviceType))return(0,t.jsx)(eD,{teamDomain:r,projectDomain:i,refresh:e.refresh});if(!a?.misconfigured)return(0,t.jsx)("div",{className:"flex flex-col gap-2 border-0",children:(0,t.jsx)(eS.DNSConfiguration,{records:n,domainConnectUrl:l,verifyTxtError:d})});let{conflicts:c}=a,u=c.sort((e,t)=>e.type.localeCompare(t.type)).map(e=>{var t,n;return{...e,name:(t=e.name,(n=i.apexName)===t?"@":t.slice(0,t.length-n.length-1))}}),m=u.length>0,h=1===u.length;return(0,t.jsxs)(ey,{borderless:!0,selected:+("DNS Records"!==s),onChange:e=>{o(0===e?"DNS Records":"Nameservers")},tabs:["DNS Records","Vercel DNS"],children:[(0,t.jsx)(ew.Fieldset,{borderlessTabs:!0,children:(0,t.jsx)(eN.FieldsetContent,{className:"px-1 pb-0 pt-2",children:(0,t.jsxs)("div",{className:"flex flex-col gap-2 border-0",children:[(0,t.jsx)("span",{children:"The DNS records at your provider must match the following records to verify and connect your domain to Vercel."}),m?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("p",{children:["Remove the following conflicting DNS"," ",h?"record":"records"," from your DNS provider:"]}),(0,t.jsx)(eS.DNSConfiguration,{records:u}),(0,t.jsx)("p",{children:"Afterwards, set the following record on your DNS provider to continue:"})]}):null,(0,t.jsx)(eS.DNSConfiguration,{records:n,domainConnectUrl:l,verifyTxtError:d})]})})}),(0,t.jsx)(ew.Fieldset,{borderlessTabs:!0,children:(0,t.jsx)(eN.FieldsetContent,{className:"px-1 pt-2",children:(0,t.jsx)(eD,{teamDomain:r,projectDomain:i,refresh:e.refresh})})})]})}var ez=e.i(9177216);let eA=Q.z.object({providers:Q.z.array(Q.z.object({role:Q.z.string(),id:Q.z.string()})),nameserverProviders:Q.z.array(Q.z.string())}),eE=Q.z.object({error:Q.z.object({code:Q.z.enum(["not_found","invalid_name","internal_server_error"]),message:Q.z.string(),name:Q.z.string()})});function eT(e){let t=(0,ez.parse)(e);return!t.error&&("www"===t.subdomain||t.domain===e)&&t.listed}function eR(e,t){return t===e?"@":e.slice(0,e.length-t.length-1)}var eO=e.i(4394127),e_=e.i(5924191),eB=e.i(3186167),e$=e.i(7432042),eM=e.i(109803),eF=e.i(4351165),eL=e.i(953632),eW=e.i(9977037),eV=e.i(7018839),eG=e.i(5836125),eU=e.i(8905788);function eY(e){return null===e?null:Math.floor((Date.now()-e)/6e4)}function eq(e){var n,r,a;let i,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6e4,l={refreshWhenHidden:!1,refreshWhenOffline:!1,revalidateOnReconnect:!1,revalidateOnFocus:!1,refreshInterval:s,dedupingInterval:3e4},[o,d]=(0,x.useTransition)(),c=(0,L.useTeamSlug)(),u=(0,en.useDomainConfig)(e.name,{strict:!1,projectIdOrName:e.projectId},l),h=(n=e.name,(0,Y.useIsomorphicSWR)((0,X.isPublicAlias)(n)?null:`/api/front-domains/check-proxy-status?domain=${n}`,async e=>ei(e,n),{dedupingInterval:3e4,...l})),f=function(e,t){let{domain:n,filterDeleted:r=!0}=e,a=(0,L.useTeamSlug)();return(0,Y.useIsomorphicSWR)(`${H.API_ALIASES}/${encodeURIComponent(n)}${(0,q.encode)({filterDeleted:r,teamId:a})}`,async e=>{try{let t=await fetch(e);if(204===t.status)return(0,J.ok)(null);return(0,J.ok)(await t.json())}catch(e){return(0,J.err)(e)}},{dedupingInterval:3e4,...t})}({domain:e.name,filterDeleted:!1},l),p=eo(e.name,l),g=(i=(0,L.useTeamSlug)(),(0,Y.useIsomorphicSWR)(`${(0,H.API_PROJECTS_DOMAINS_VERSION)("v9")}/${e.projectId}/domains/${e.name}/verify${(0,q.encode)({teamId:i})}`,async t=>(0,X.isPublicAlias)(e.name)||!1!==e.verified?(0,J.ok)({result:"success"}):(0,K.safeFetch)(t,{successSchema:ed,failureSchema:ec,method:"POST"}),{refreshWhenHidden:!1,refreshWhenOffline:!1,revalidateOnReconnect:!0,revalidateOnFocus:!0,refreshInterval:15e3,dedupingInterval:15e3,...l})),j=function(e,t){let n=(0,L.useTeamSlug)(),{can:r}=(0,y.default)(),a=r(w.Action.List,w.Resource.DomainCertificate);return(0,Y.useIsomorphicSWR)(`${H.API_CERTS}${(0,q.encode)({teamId:n,cn:e})}`,async t=>(0,X.isPublicAlias)(e)?(0,J.errAsync)(new K.ApiError({error:{error:{message:"You are not authorized to list certificates",status:403,code:"public-alias"}}})):a?(0,K.safeFetch)(t,{successSchema:ee,failureSchema:et}):(0,J.errAsync)(new K.ApiError({error:{error:{message:"You are not authorized to list certificates",status:403,code:"no-permissions-certs"}}})),{shouldRetryOnError:!1,dedupingInterval:3e4,...t})}(e.name,l),v=(0,eO.useCertErrors)(e.name,"dnsName",l),b=(0,W.useProject)(e.projectId,{config:l}),N=(r=e.name,a={shouldRetryOnError:!1,...l},(0,ex.default)(r&&!(0,X.isPublicAlias)(r)?`/api/front-domains/domain-connect/status?domain=${r}`:null,e=>(0,eC.fetchAPI)(e,{throwOnHTTPError:!0}),{keepPreviousData:!0,dedupingInterval:3e4,...a})),S=(0,eB.useHasDomainBeenConfiguredWithDomainConnect)(e.name),C=ej(e.name,l),I=(0,eL.parse)(e.name).publicSuffix??"",k=(0,eF.useTldPropagationTime)(I),P=function(e){let{boughtAt:t}=e,[n,r]=(0,x.useState)(eY(t));return((0,x.useEffect)(()=>{if(null===t)return;let e=setInterval(()=>{r(eY(t))},1e4);return()=>clearInterval(e)},[t]),null===t)?null:n}({boughtAt:C.data?.isOk()?C.data.value.domain.boughtAt:null})??eY(C.data?.isOk()?C.data.value.domain.boughtAt:null),[A,E]=(0,x.useState)("DNS Records"),T=e.name.endsWith(".vercel.app"),R=(0,eV.useAtomValue)((0,eG.contactVerificationStateAtom)(new eG.ContactVerificationStateParams({domainName:T?null:e.apexName,scope:c??null}))),O=u.isLoading||h.isLoading||f.isLoading||p.isLoading||g.isLoading||j.isLoading||v.isLoading||C.isLoading||!T&&"Initial"===R._tag,_=u.isValidating||h.isValidating||f.isValidating||p.isValidating||g.isValidating||j.isValidating||v.isValidating||C.isValidating,B=o||_,$=(0,x.useCallback)(()=>{d(async()=>{await Promise.all([u.mutate(),h.mutate(),f.mutate(),p.mutate(),g.mutate(),j.mutate(),v.mutate(),C.mutate(),N.mutate()])})},[v,j,u,f,h,p,g,C,N]),M=function(e,t){eo(e??"");let n=function(e,t){let n=(0,en.useDomainConfig)(e,{strict:!1,projectIdOrName:t}),r={ipv4:"76.76.21.21",cname:"cname.vercel-dns.com."};if(!n.data?.isOk())return r;let a=n.data.value.recommendedIPv4?.[0].value;a&&a.length>0&&(r.ipv4=a[0]);let i=n.data.value.recommendedCNAME?.[0].value;return i&&(r.cname=i),r}(e,t),{data:r}=(0,z.useProjectDomain)(e?{projectId:t,name:e}:null),a=function(e){let{data:t}=(0,ex.default)(e&&!(0,X.isPublicAlias)(e)?`/api/front-domains/check-proxy-status?domain=${e}`:null,async e=>{let t=await (0,K.safeFetch)(e,{successSchema:eA,failureSchema:eE});return t.isOk()?{isDomainOnCloudflare:t.value.nameserverProviders.includes("Cloudflare"),hasCloudflareInFront:t.value.providers.find(e=>"front-proxy"===e.role)?.id==="Cloudflare"}:{isDomainOnCloudflare:!1,hasCloudflareInFront:!1}});return t?.isDomainOnCloudflare??!1}(e),i=ej(e),s=(0,en.useDomainConfig)(e,{strict:!1,projectIdOrName:t});if(!e||!r)return[];let l=r.verification?.at(0),o=r.apexName===e,d=i.data?.isOk()?i.data.value.domain:void 0,c=s.data?.isOk()?s.data.value:void 0,u=d?.intendedNameservers.length?d.intendedNameservers:ek.VERCEL_NAMESERVERS,m=c?.nameservers??[];d?.serviceType==="na"&&d.boughtAt,u.every(e=>m.includes(e));let h=[],x=s.data?.isOk()&&!s.data.value.misconfigured,f=s.data?.isOk()&&["required-change","optional-change"].includes(s.data.value.ipStatus??"");return(!x||f)&&h.push({type:o?"A":"CNAME",name:o?"@":eR(e,r.apexName),value:o?n.ipv4:n.cname,disableProxy:a}),l&&h.push({type:l.type,name:eR(l.domain,r.apexName),value:`${l.value}`,verifyDomain:l.domain}),h}(e.name,e.projectId),F=N.data?.providerId==="cloudflare.com"?(0,eB.getDomainConnectApplyUrl)(e,c??void 0):void 0,V=g.data?.isErr()?g.data.error:void 0,G=(0,t.jsx)(eP,{dnsRecords:M,domainConfig:u.data?.isOk()?u.data.value:void 0,teamDomain:C.data?.isOk()?C.data.value.domain:void 0,projectDomain:e,domainConnectUrl:F,refresh:$,configMethod:A,setConfigMethod:E,verifyTxtError:V?._tag==="ApiError"&&"txt_on_another_project"===V.error.error.code?V.error.error.message:void 0});if(O)return{status:"loading"};if(!T&&eW.Result.isSuccess(R)&&!1===R.value.verified)return{status:"unverified-email",refresh:$,isRefreshing:B,level:R.value.verifyBy>new Date?"warning":"error",ui:(0,t.jsx)(eU.ContactVerificationNotification,{email:R.value.email,verifyBy:R.value.verifyBy,domainName:e.name})};let U=u.data?.isOk()?u.data.value:null;if(S&&(U?.misconfigured||!e.verified))return{status:"domain-connect-success",refresh:$,isRefreshing:B,ui:(0,t.jsx)("p",{className:"text-copy-14",children:"Automatic configuration applied correctly and we are monitoring for the DNS changes to propagate."}),level:"spinner"};if(!e.verified)return{status:"verification-needed",refresh:$,isRefreshing:B,ui:G,level:"error"};if(U?.misconfigured){let e=(0,e$.default)("4h")/6e4;if(null!==P&&P<e&&!U?.configuredBy){let e=k?.averagePropagationDelayMs?Math.max(Math.round(k.averagePropagationDelayMs/6e4*1.3),5):null;return{status:"pending-nameserver-propagation",refresh:$,isRefreshing:B,ui:(0,t.jsx)("div",{className:"pt-2",children:(0,t.jsxs)("p",{className:"text-copy-14",children:[(()=>{if(!e)return ek.DNS_PROPAGATION_WARNING;let n=P?e-P:e;return n<=0?(0,t.jsx)(t.Fragment,{children:"Your domain is taking longer than expected to propagate. This may be due to a delay in the registry."}):(0,t.jsxs)(t.Fragment,{children:["We're estimating that your domain will be online in"," ",(0,t.jsxs)(em.InlineCode,{fontSize:"14px",children:[n," minute",1===n?"":"s"]})," ","based on similar propagation times for"," ",(0,t.jsxs)(em.InlineCode,{fontSize:"14px",children:[".",I]})," domains."]})})()," Once this process is completed, your domain will automatically be assigned and serving traffic."]})}),level:"spinner"}}return{status:"invalid-configuration",refresh:$,isRefreshing:B,ui:G,level:"error"}}let Q=u.data?.isOk()?u.data.value.ipStatus:null,Z=u.data?.isOk()&&!!(u.data.value.recommendedIPv4||u.data.value.recommendedCNAME);if("required-change"===Q&&Z&&!T)return{status:"ip-downgrade",refresh:$,isRefreshing:B,level:"error",ui:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"pt-2",children:"To avoid downtime, you must change your DNS records to match the following:"}),(0,t.jsx)(D.Spacer,{y:.5}),G]})};if(h.data?.hasCloudflareInFront)return S?{status:"disabling-proxy",refresh:$,isRefreshing:B,ui:(0,t.jsx)("div",{className:"pt-2",children:(0,t.jsxs)("p",{children:["We've"," succesfully disabled the proxy in front of your domain and are monitoring for the changes to propagate."]})}),level:"spinner"}:{status:"proxy-detected",refresh:$,className:"px-0",isRefreshing:B,ui:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"pt-2 px-7",children:[(0,t.jsx)("div",{children:"Using a proxy in front of Vercel prevents our automated DDOS and bot-mitigation tools from working correctly. It can also degrade performance."}),(0,t.jsx)(D.Spacer,{y:.5}),(0,t.jsx)("div",{className:"flex justify-between flex-row items-center",children:(0,t.jsxs)("div",{children:["To disable the proxy, update your DNS provider."," ",(0,t.jsx)(m.Link,{variant:"highlight",href:"https://vercel.com/kb/guide/can-i-use-a-proxy-on-top-of-my-vercel-deployment",children:"Learn more."})]})})]}),F?(0,t.jsx)("div",{className:"flex justify-end",children:(0,t.jsx)("div",{className:"ml-16",children:(0,t.jsx)(m.ButtonLink,{href:F,onClick:()=>{(0,eh.track)("click_disable_proxy",{source:"project-domains-page-proxy-warning",domainName:e.name})},size:"small",children:(0,t.jsxs)("div",{className:"flex items-center flex-row gap-1",children:["1-click fix",(0,t.jsx)(eM.External,{})]})})})}):null]}),level:"warning"};let er=b.data?.targets?.production,ea=b.data?.link?.productionBranch||"the default branch",es=f.data?.isOk()&&!f.data.value;if(!b.isLoading&&(!er||es))return{status:"no-deployment",refresh:$,isRefreshing:B,ui:(0,t.jsxs)("p",{className:"text-copy-14",children:["Your domain is properly configured, but you don't have a production deployment.",(0,t.jsx)("br",{}),"To deploy to production,"," ",(0,t.jsxs)(m.Link,{href:"/docs/git",tab:!0,variant:"highlight",children:["push to ",ea]}),", or run ",(0,t.jsx)(em.InlineCode,{noWrap:!0,children:"vercel --prod"})," with our"," ",(0,t.jsx)(m.Link,{href:"/cli",tab:!0,variant:"highlight",children:"command-line interface"}),"."]}),level:"warning"};if(u.data?.isOk()&&"zeit.world"===u.data.value.serviceType&&u.data.value.dnssecEnabled)return{status:"dnssec-needs-to-be-disabled",refresh:$,isRefreshing:B,ui:(0,t.jsx)(eu.Error,{children:"Your domain's nameservers are pointing to Vercel, but you must disable DNSSEC with your domain registrar in order for your nameservers to resolve globally."}),level:"error"};let el=j.data?.isErr()&&"ApiError"===j.data.error._tag&&("public-alias"===j.data.error.error.error.code||"no-permissions-certs"===j.data.error.error.error.code);if(j.data?.isErr()&&!el)return{status:"certs-load-failed",refresh:$,isRefreshing:B,ui:(0,t.jsx)(eu.Error,{children:"Failed to load certs"}),level:"error"};if(el)return"optional-change"===Q&&Z&&!T?{status:"ip-upgrade",refresh:$,isRefreshing:B,level:"warning",ui:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"pt-2",children:"Vercel recommends updating your DNS records to match the following:"}),(0,t.jsx)(D.Spacer,{y:.5}),G]})}:{status:"configured-correctly",refresh:$,isRefreshing:B,ui:null,level:null};let ef=j.data?.isOk()?j.data.value?.certs:void 0,ep=v.data?.isOk()?v.data.value?.errors:void 0;if(!ef?.length){let e=(0,eO.getMostRecentCertErrorInfo)(ep??[]);if(e){let{message:n,isRenewal:r}=e;return{status:r?"certs-renewal-errored":"certs-issue-errored",refresh:$,isRefreshing:B,level:"error",ui:(0,t.jsx)(eu.Error,{children:n})}}return{status:"certs-issuing",refresh:$,isRefreshing:B,ui:(0,t.jsx)("div",{className:"pt-2",children:"We are issuing the certificate for your domain, this should only take a few minutes."}),level:null}}let eg=ef.filter(t=>t.cns.some(t=>(function(e,t){let n=e.toLowerCase(),r=t.toLowerCase();if(n===r)return!0;if(n.startsWith("*.")){let e=n.slice(1);return RegExp(`^[^\\.]+${e.replace(/\./g,"\\.")}$`).test(r)}return!1})(t,e.name)));return 0===eg.filter(e=>e.expiresAt>Date.now()).length&&eg.length>0?{status:"certs-expired",refresh:$,isRefreshing:B,ui:(0,t.jsxs)(eu.Error,{children:["Your SSL cert has expired, please update your"," ",(0,t.jsx)(m.Link,{as:`/${c}/~/domains/${encodeURIComponent(e.name)}`,href:"/dashboard/[teamSlug]/domains/[domain]",tab:!0,variant:"highlight",children:"cert settings"}),"."]}),level:"error"}:"optional-change"===Q&&Z&&!T?{status:"ip-upgrade",refresh:$,isRefreshing:B,level:"warning",ui:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"pt-2",children:"Vercel recommends updating your DNS records to match the following:"}),(0,t.jsx)(D.Spacer,{y:.5}),G]})}:{status:"configured-correctly",refresh:$,isRefreshing:B,ui:null,level:null}}var eH=e.i(8735244),eJ=e.i(8761240),eQ=e.i(9386557);function eK(e){let{domain:n}=e,r=eq(n);if("loading"===r.status)return(0,t.jsx)(a.Skeleton,{className:"block rounded-full",height:"16px",width:"16px"});if(null===r.level)return(0,t.jsx)(eJ.CheckCircleFill,{size:16,color:"blue-700"});switch(r.level){case"warning":return(0,t.jsx)(eJ.CheckCircleFill,{size:16,color:"blue-700"});case"error":return(0,t.jsx)(eQ.WarningFill,{size:16,color:"red-700"});case"spinner":return(0,t.jsx)("div",{className:"flex flex-row items-center justify-start gap-1 flex-initial",style:{color:"var(--ds-gray-900)"},children:(0,t.jsx)(eH.Spinner,{size:16})})}}function eX(e){let{domain:r}=e,i=eq(r);switch(i.status){case"proxy-detected":return(0,t.jsx)(n.Badge,{size:"sm",variant:"amber-subtle",children:(0,t.jsx)("span",{children:"Proxy Detected"})});case"no-deployment":return(0,t.jsx)(n.Badge,{size:"sm",variant:"amber-subtle",children:(0,t.jsx)("span",{children:"No Deployment"})});case"certs-issuing":return(0,t.jsx)(n.Badge,{icon:(0,t.jsx)(eH.Spinner,{size:"12px"}),size:"sm",variant:"gray-subtle",children:(0,t.jsx)("span",{children:"Generating SSL Certificate"})});case"certs-load-failed":return(0,t.jsx)(n.Badge,{size:"sm",variant:"red-subtle",children:(0,t.jsx)("span",{children:"Failed to Load Cert"})});case"certs-issue-errored":return(0,t.jsx)(n.Badge,{size:"sm",variant:"red-subtle",children:(0,t.jsx)("span",{children:"Failed to Generate Cert"})});case"certs-renewal-errored":return(0,t.jsx)(n.Badge,{size:"sm",variant:"red-subtle",children:(0,t.jsx)("span",{children:"Failed to Renew Cert"})});case"configured-correctly":return(0,t.jsx)("span",{className:"text-gray-900",children:"Valid Configuration"});case"dnssec-needs-to-be-disabled":return(0,t.jsx)(n.Badge,{size:"sm",variant:"red-subtle",children:(0,t.jsx)("span",{children:"DNSSEC Needs to be Disabled"})});case"certs-expired":return(0,t.jsx)(n.Badge,{size:"sm",variant:"red-subtle",children:(0,t.jsx)("span",{children:"SSL Cert Expired"})});case"invalid-configuration":return(0,t.jsx)(n.Badge,{size:"sm",variant:"red-subtle",children:(0,t.jsx)("span",{children:"Invalid Configuration"})});case"verification-needed":return(0,t.jsx)(n.Badge,{size:"sm",variant:"red-subtle",children:(0,t.jsx)("span",{children:"Verification Needed"})});case"ip-downgrade":return(0,t.jsx)(n.Badge,{size:"sm",variant:"red-subtle",children:(0,t.jsx)("span",{children:"DNS Change Required"})});case"ip-upgrade":return(0,t.jsx)(n.Badge,{size:"sm",variant:"amber-subtle",children:(0,t.jsx)("span",{children:"DNS Change Recommended"})});case"pending-nameserver-propagation":return(0,t.jsx)(n.Badge,{size:"sm",variant:"gray-subtle",children:(0,t.jsx)("span",{children:"Pending Nameserver Propagation"})});case"domain-connect-success":return(0,t.jsx)(n.Badge,{size:"sm",variant:"gray-subtle",children:(0,t.jsx)("span",{children:"Waiting for DNS Propagation"})});case"disabling-proxy":return(0,t.jsx)(n.Badge,{size:"sm",variant:"gray-subtle",children:(0,t.jsx)("span",{children:"Disabling Proxy"})});case"unverified-email":return(0,t.jsx)(n.Badge,{size:"sm",variant:"warning"===i.level?"amber-subtle":"red-subtle",children:(0,t.jsx)("span",{children:"Unverified email"})});case"loading":return(0,t.jsx)(a.Skeleton,{height:"20px",width:"116px"});default:return null}}var eZ=e.i(3930829),e0=e.i(1937421),e1=e.i(6357175),e2=e.i(7722264),e4=e.i(4837983),e3=e.i(3228096),e8=e.i(3869281),e6=e.i(455575),e5=e.i(2886520),e9=e.i(1848296),e7=e.i(1146455);function te(e){let{selfRedirect:n,setRedirect:r,savingRedirect:a,redirect:s,project:l,domain:o,disabled:d,className:c}=e,u=(0,v.useParams)(),m=u?.project,[h,f]=(0,e1.useDebounceState)("",100),{data:p=[]}=function(e){let{limit:t=10,gitBranch:n,production:r,target:a,redirect:i,redirects:s,verified:l,order:o,search:d}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=(0,L.useTeamSlug)();return(0,Y.useIsomorphicSWR)(e?`${(0,H.API_PROJECTS_DOMAINS_VERSION)("v9")}/${e}/domains${(0,q.encode)({limit:t,gitBranch:n,production:r,target:a,redirects:s,redirect:i,verified:l,order:o,search:d,teamId:c})}`:null,async e=>(await (0,eC.fetchAPI)(e,{throwOnHTTPError:!0})).domains)}(l?.id??m,{limit:100,search:h.length>0?h:void 0,redirects:"false"});return(0,t.jsx)("div",{className:(0,j.default)("flex flex-col md:flex-row lg:flex-row items-stretch justify-start flex-initial",c),children:(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start flex-1",children:n?(0,t.jsx)("div",{className:"w-full",style:{flex:1},children:(0,t.jsx)(i.Tooltip,{style:{minWidth:"100%"},text:"You have redirected another domain to this domain. In turn, you cannot redirect this one.",children:(0,t.jsxs)(F.Combobox,{className:"w-full",children:[(0,t.jsx)(F.Combobox.Input,{"data-testid":(0,P.tid)("redirect-to-field","tooltip","domain-redirect"),defaultValue:"no-redirect-possible",disabled:d,style:{minWidth:"100%"},trimValue:!0}),(0,t.jsx)(F.Combobox.List,{hideOnEmpty:!0,children:(0,t.jsx)(F.Combobox.Option,{value:"no-redirect-possible",children:"No Redirect Possible"})})]})})}):(0,t.jsxs)(F.Combobox,{clearable:!0,disabled:a||d,onChange:e=>{r(e||null)},placeholder:"No Redirect",showMenuButton:p.length>0,value:s??"",children:[(0,t.jsx)(F.Combobox.Input,{"data-testid":(0,P.tid)("redirect-to-field","tooltip","domain-redirect"),onChange:e=>{f(e.target.value)},onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),r(e.currentTarget.value||null))},trimValue:!0}),(0,t.jsx)(F.Combobox.List,{hideOnEmpty:!0,children:(0,t.jsx)(t.Fragment,{children:p.map(e=>{let{name:n}=e;return(0,t.jsx)(x.default.Fragment,{children:n===o||n.startsWith("*")?null:(0,t.jsx)(F.Combobox.Option,{value:n,children:n})},n)})})})]})})})}var tt=e.i(5323212);function tn(e){let{saving:n,setRedirectStatusCode:r,redirectStatusCode:a,disabled:i}=e;return(0,t.jsxs)(tt.Select,{"data-testid":(0,P.tid)("project","domain-status-code"),disabled:n||i,onChange:e=>r(Number(e.target.value)),value:a||307,width:"100%",children:[(0,t.jsxs)("optgroup",{label:"Temporary",children:[(0,t.jsx)("option",{value:"307",children:"307 Temporary Redirect"}),(0,t.jsx)("option",{value:"302",children:"302 Found"})]}),(0,t.jsxs)("optgroup",{label:"Permanent",children:[(0,t.jsx)("option",{value:"308",children:"308 Permanent Redirect"}),(0,t.jsx)("option",{value:"301",children:"301 Moved Permanently"})]})]})}function tr(e){let{domain:n,projectDomainTarget:r,saving:a}=e,[i,s]=(0,x.useState)(r?.redirect?"redirect":"connect-to-environment"),[l,o]=(0,x.useState)(r?.gitBranch?N.EnvTarget.Preview:r?.customEnvironmentId??N.EnvTarget.Production),[d,c]=(0,x.useState)(r?.gitBranch??null),[u,m]=(0,x.useState)(r?.redirect??""),[h,f]=(0,x.useState)(r?.redirectStatusCode??307),p=(0,x.useCallback)(()=>{switch(i){case"connect-to-environment":if(l===N.EnvTarget.Preview&&!d)return(0,J.err)("You must select a git branch for preview environments");return(0,J.ok)({customEnvironmentId:l!==N.EnvTarget.Production&&l!==N.EnvTarget.Preview?l:void 0,gitBranch:l===N.EnvTarget.Preview?d:void 0});case"redirect":if(null===u||"No Redirect"===u)return(0,J.err)("You must select a redirect URL");return(0,J.ok)({redirect:u,redirectStatusCode:h})}},[l,d,i,h,u]),g=(0,t.jsx)("div",{className:"flex w-full flex-col",children:(0,t.jsxs)(e9.RadioGroup,{onChange:e=>{("connect-to-environment"===e||"redirect"===e)&&s(e)},disabled:a,value:i,children:[(0,t.jsxs)("div",{className:"flex w-full flex-col items-start justify-start gap-2 rounded-t-md border border-solid border-gray-400 p-4",children:[(0,t.jsx)("div",{className:"flex flex-row items-center gap-2",children:(0,t.jsx)(e9.RadioGroup.Item,{className:(0,b.cn)("text-sm  leading-5","connect-to-environment"===i?"text-gray-1000":"text-gray-900"),value:"connect-to-environment",children:"Connect to an environment"})}),(0,t.jsxs)("div",{className:"flex w-full flex-col gap-2 pl-6 md:flex-row",children:[(0,t.jsx)("div",{className:"w-full md:w-1/2",children:(0,t.jsx)(e7.EnvironmentsSelect,{activeEnvironmentId:l,hideDevelopment:!0,disabled:"connect-to-environment"!==i||a,onChange:e=>{o(e||null)}})}),(0,t.jsx)("div",{className:"w-full md:w-1/2",children:l===N.EnvTarget.Preview&&(0,t.jsx)(G,{disabled:"connect-to-environment"!==i||a,environmentId:l,onChange:e=>{c(e??null)},onFocus:void 0,value:d||""})})]})]}),(0,t.jsxs)("div",{className:"flex w-full flex-col items-start justify-start gap-2 rounded-b-md border border-t-0 border-solid border-gray-400 p-4",children:[(0,t.jsx)("div",{className:"flex flex-row items-center gap-2",children:(0,t.jsx)(e9.RadioGroup.Item,{className:(0,b.cn)("text-sm  leading-5","redirect"===i?"text-gray-1000":"text-gray-900"),value:"redirect",children:"Redirect to Another Domain"})}),(0,t.jsxs)("div",{className:"flex w-full flex-col gap-2 pl-6 md:flex-row",children:[(0,t.jsx)("div",{className:"w-full md:w-1/2",children:(0,t.jsx)(tn,{disabled:"redirect"!==i,redirectStatusCode:h,saving:a,setRedirectStatusCode:e=>{let t=Number(e.toString());(301===t||302===t||307===t||308===t)&&f(t)}})}),(0,t.jsx)("div",{className:"w-full md:w-1/2",children:(0,t.jsx)(te,{className:"w-full",disabled:"redirect"!==i,domain:n||"",redirect:u,savingRedirect:a,selfRedirect:!1,setRedirect:e=>{m(e)}})})]})]})]})}),j=(0,t.jsx)("div",{className:"flex w-full flex-col",children:(0,t.jsxs)(e9.RadioGroup,{onChange:e=>{("connect-to-environment"===e||"redirect"===e)&&s(e)},disabled:a,value:i,children:[(0,t.jsxs)("div",{className:"flex w-full flex-row items-center justify-start gap-2 rounded-b-md p-2",children:[(0,t.jsx)("div",{className:"flex min-w-[220px] flex-row items-center gap-2",children:(0,t.jsx)(e9.RadioGroup.Item,{className:(0,b.cn)("text-sm  leading-5","connect-to-environment"===i?"text-gray-1000":"text-gray-900"),value:"connect-to-environment",children:"Connect to an environment"})}),(0,t.jsxs)("div",{className:"flex w-full flex-col gap-2 md:flex-row",children:[(0,t.jsx)("div",{className:"w-full md:w-1/2",children:(0,t.jsx)(e7.EnvironmentsSelect,{activeEnvironmentId:l,hideDevelopment:!0,disabled:"connect-to-environment"!==i||a,onChange:e=>{o(e||null)}})}),(0,t.jsx)("div",{className:"w-full md:w-1/2",children:l===N.EnvTarget.Preview&&(0,t.jsx)(G,{disabled:"connect-to-environment"!==i||a,environmentId:l,onChange:e=>{c(e??null)},onFocus:void 0,value:d||""})})]})]}),(0,t.jsxs)("div",{className:"flex w-full flex-row items-center justify-start gap-2 rounded-b-md p-2",children:[(0,t.jsx)("div",{className:"flex min-w-[220px] flex-row items-center gap-2",children:(0,t.jsx)(e9.RadioGroup.Item,{className:(0,b.cn)("text-sm  leading-5","redirect"===i?"text-gray-1000":"text-gray-900"),value:"redirect",children:"Redirect to Another Domain"})}),(0,t.jsxs)("div",{className:"flex w-full flex-col gap-2 md:flex-row",children:[(0,t.jsx)("div",{className:"w-full md:w-1/2",children:(0,t.jsx)(tn,{disabled:"redirect"!==i,redirectStatusCode:h,saving:a,setRedirectStatusCode:e=>{let t=Number(e.toString());(301===t||302===t||307===t||308===t)&&f(t)}})}),(0,t.jsx)("div",{className:"w-full md:w-1/2",children:(0,t.jsx)(te,{className:"w-full",disabled:"redirect"!==i,domain:n||"",redirect:u,savingRedirect:a,selfRedirect:!1,setRedirect:e=>{m(e)}})})]})]})]})});return{ui:"inline"===e.style?j:g,getProjectDomainTarget:p}}function ta(e){return(0,e2.isError)(e)?e.message:"string"==typeof e?e:"An error occurred"}function ti(e){return"object"==typeof e&&null!==e}function ts(e){if(!ti(e))return!1;let t="projectName"in e&&"string"==typeof e.projectName||"projectId"in e&&"string"==typeof e.projectId,n="code"in e&&"string"==typeof e.code,r=e.code,a=n&&["domain_already_in_use","duplicate-team-registration","duplicate-user-registration"].includes(r);return t&&n&&a}let tl=async e=>{let{project:t,isReady:n,team:r,projectDomain:a,redirect:i,redirectStatusCode:s,gitBranch:l,customEnvironmentId:o}=e;if(!t||!n)return;let d={redirect:i||null,redirectStatusCode:s||null,gitBranch:i?null:l};void 0!==o&&(d.customEnvironmentId=o,d.redirect=null,d.redirectStatusCode=null,"preview"!==o&&(d.gitBranch=null)),await (0,eC.fetchAPI)(`${(0,H.API_PROJECTS_DOMAINS_VERSION)("v9")}/${t.id}/domains/${a.name}${r?`?teamId=${r.id}`:""}`,{throwOnHTTPError:!0,method:"PATCH",body:JSON.stringify(d)})};function to(e){let{domain:n,setDomain:r,redirectApexToWWW:a,setRedirectApexToWWW:s}=e,[l,o]=(0,e1.useDebounceState)(a,250),d=n.endsWith(".ve")?l:eT(n);return(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("div",{children:(0,t.jsx)(e5.AutocompleteDomainInput,{onChange:e=>{r(e?e.toLowerCase():""),o(!!e&&eT(e))},onSubmit:()=>{e.onSubmit()},value:n,disabled:e.disabled})}),(0,t.jsx)("div",{className:"flex w-full flex-col gap-2",children:(0,t.jsx)("div",{className:(0,b.cn)("flex flex-col gap-2",d?"visible":"invisible h-[21px]"),children:(0,t.jsx)("div",{className:"flex select-none flex-row gap-2 ",children:(0,t.jsx)(e8.Checkbox,{checked:a,onChange:e=>{s(e.target.checked)},height:8,width:8,children:(0,t.jsxs)("span",{className:"select-none break-all text-sm text-gray-900",children:["Redirect ",(0,ez.get)(n)," to www.",(0,ez.get)(n)," ",(0,t.jsx)(i.Tooltip,{text:(0,t.jsxs)("div",{className:"flex flex-col items-center gap-2",children:["Using a www subdomain allows for faster DNS resolution, improved website performance and more flexible routing.",(0,t.jsxs)(m.Link,{className:"ml-2 flex flex-row items-center text-xs text-blue-900",target:"_blank",rel:"noopener noreferrer",href:"https://vercel.com/docs/domains/working-with-domains#apex-domain",children:[(0,t.jsx)("span",{className:"text-blue-900",children:"Learn more"}),(0,t.jsx)(eM.External,{size:12,className:"ml-1"})]})]}),children:"(Recommended)"})]})})})})})]})}function td(e){let{onClose:n,project:r,teamSlug:a,onSave:s,initialAddDomainInput:l}=e,[d,c]=(0,x.useState)(l??""),[u,m]=(0,x.useState)(!0),h=!!eT(d)&&u,[f,p]=(0,x.useState)(null),[g,j]=(0,x.useTransition)(),{getProjectDomainTarget:v,ui:b}=tr({saving:g,domain:d}),y=(0,e6.useToasts)(),{data:w}=(0,W.useProject)(r),N=v(),S=null;0===d.length?S="Please enter a domain":N.isErr()&&(S=N.error);let C=async()=>{if((0,e_.preload)(`/api/front-domains/domain-connect/status?domain=${d}`,e=>(0,eC.fetchAPI)(e,{throwOnHTTPError:!0})).catch(()=>null),N.isErr())return p(N.error),!1;if((0,R.default)(d)&&(0,X.isPublicAlias)(d))return p("Wildcard subdomains are not supported for .vercel.app domains."),!1;try{let e=(0,R.default)(d)?{domain:d,error:null}:(0,ez.parse)(d);if(e.error||!e.domain)return p("The domain you are trying to add is invalid, please enter a valid domain name and try again"),!1;let t=null;if(h){let n=`www.${e.domain}`;try{t=(await (0,E.addProjectDomain)({domain:n,project:{id:r},team:{id:a},customEnvironmentId:N.value.customEnvironmentId,gitBranch:N.value.gitBranch,redirect:N.value.redirect,redirectStatusCode:N.value.redirectStatusCode})).name}catch(e){if(ts(e)&&(e.projectId===w?.id||e.projectName===w?.name))t=n;else throw e}try{await (0,E.addProjectDomain)({domain:e.domain,project:{id:r},team:{id:a},redirect:N.value.redirect??t})}catch(n){if(ts(n)&&(n.projectId===w?.id||n.projectName===w?.name)){let i=n.domain;if(!i||!t)return p(`The domain "${e.domain}" already exists on this project but could not be updated with redirect configuration. Please update it manually from the domains list.`),!1;try{return await tl({project:{id:r},isReady:!0,team:{id:a},projectDomain:i,redirect:t,redirectStatusCode:308}),y.success("Domain configuration updated"),!0}catch(e){return p(ta(e)),!1}}throw n}}else await (0,E.addProjectDomain)({domain:d,project:{id:r},team:{id:a},customEnvironmentId:N.value.customEnvironmentId,gitBranch:N.value.gitBranch,redirect:N.value.redirect,redirectStatusCode:N.value.redirectStatusCode});if(y.success("Domain added to project"),(0,R.default)(d)){let e=`?teamId=${encodeURIComponent(a)}`;try{await (0,eC.fetchAPI)(`${H.API_DOMAINS}/${encodeURIComponent(d)}${e}`,{method:"PATCH",body:JSON.stringify({zone:!0}),throwOnHTTPError:!0})}catch(t){let e=(0,e2.isError)(t)?t.message:"Failed to update zone";return p(e),!1}}return!0}catch(t){if(ts(t)){if(t.projectId===w?.id||t.projectName===w?.name){let e=t.domain?.name||d;return p(`You are already using the domain "${e}" on this project.`),!1}return e.onDomainTransferRequest({domain:d,projectIdOrNameInUse:t.projectId||t.projectName||""}),!1}if(function(e){if(!ti(e))return!1;let t=e.code;return"code"in e&&"string"==typeof e.code&&"owned-on-other-team"===t}(t))return p("Another team is already using this domain."),!1;return p(ta(t)),!1}};return(0,t.jsxs)(k.Modal,{active:!0,onClickOutside:n,children:[(0,t.jsxs)(k.Modal.Body,{children:[(0,t.jsx)(k.Modal.Title,{children:"Add Domain"}),(0,t.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,t.jsx)("div",{className:"pt-6",children:"Add a domain to connect it to a project. After being connected, the domain will be aliased to the most recent deployment in that environment."}),(0,t.jsxs)("div",{className:"flex flex-col gap-3 pb-2",children:[(0,t.jsx)(to,{disabled:g,domain:d,setDomain:c,onSubmit:()=>{j(async()=>{await C()&&(await s?.(),n())})},redirectApexToWWW:h,setRedirectApexToWWW:m}),b]}),f?(0,t.jsx)(o.Note,{type:"error",fill:!0,children:f}):null]})]}),(0,t.jsxs)(k.Modal.Actions,{children:[(0,t.jsx)(k.Modal.Action,{onClick:n,type:"secondary",children:"Cancel"}),(0,t.jsx)(i.Tooltip,{text:S,disableTriggers:!S,children:(0,t.jsx)(k.Modal.Action,{loading:g,disabled:!!S,onClick:()=>{j(async()=>{await C()&&(await s?.(),n())})},children:"Save"})})]})]})}var tc=e.i(9650453),tu=e.i(4585051),tm=e.i(2455417),th=e.i(6870754),tx=e.i(5338940),tf=e.i(950120),tp=e.i(1138941),tg=e.i(7898658);async function tj(e){let{project:t,isReady:n,team:r,name:a,newProjectId:i}=e;n&&await (0,eC.fetchAPI)(`${(0,H.API_PROJECTS_DOMAINS_VERSION)("v9")}/${t.id}/domains/${a}/move${r?`?teamId=${r.id}`:""}`,{throwOnHTTPError:!0,method:"POST",body:JSON.stringify({projectId:i})})}var tv=e.i(5519011);function tb(e){let{project:n,hideSkeleton:r=!1,size:i=32,style:s}=e,l=(0,tp.getProductionDeployment)(n),{data:o}=(0,tg.default)({project:n}),d=(0,tp.useFramework)(n);return(d||l&&o)&&r?(0,t.jsx)(tu.Avatar,{className:(0,j.clsx)({[tv.default.favicon]:!o?.isSquare,"bg-white/75 rounded-full shadow-border shadow-background-100 dark:bg-foreground dark:shadow-foreground":!!(!o&&d)}),size:i,src:o?.src||d?.logo,style:s,title:n?n.name:void 0}):(0,t.jsx)(a.Skeleton,{height:i,rounded:!0,style:{flexShrink:0},width:i})}function ty(e){let{active:n,domain:r,projectIdOrNameInUse:i,onCancel:s,onComplete:l}=e,[d,c]=(0,x.useState)(!1),u=(0,tp.useProjectIdOrName)(),{data:h}=(0,W.useProject)(u),{team:f,isReady:p}=(0,tx.useTeam)(),{data:g}=(0,W.useProject)(r&&i?i:null),{data:j}=(0,z.useProjectDomain)(g?{projectId:g.id,name:r}:null),v=j?j.redirect??j.name:null,b=n&&!!v&&!!h&&!!g,[y,{domains:w,isLoadingMore:N,loadMore:S,isReachingEnd:C,initialDataLoaded:P}]=(0,z.useProjectDomainsInfinite)(j&&g?g.id:null,v?{redirect:v,limit:20}:{}),A=(0,I.useRouter)(),E=`/${A.query.teamSlug}/${g?.name}/settings/domains`,T=`/${A.query.teamSlug}/${h?.name}/settings/domains`,R=(0,x.useCallback)(()=>{s(),c(!1)},[s]),O=async()=>{h&&r&&i&&j&&g&&v&&(c(!0),await tj({project:g,isReady:p,name:v,team:f,newProjectId:h.id}),l(),c(!1))};return(0,t.jsxs)(k.Modal.Modal,{active:b,onClickOutside:R,children:[(0,t.jsx)(k.Modal.Body,{children:(0,t.jsxs)("div",{className:"jsx-aedf4df6a7382869 flex flex-col items-stretch justify-start gap-8 flex-initial",children:[(0,t.jsxs)("header",{className:"jsx-aedf4df6a7382869",children:[(0,t.jsx)(k.Modal.Title,{children:"Move Domain"}),(0,t.jsxs)("p",{className:"jsx-aedf4df6a7382869 text-copy-14",children:["This domain is already associated with another project."," ",v&&v===r?(0,t.jsx)(t.Fragment,{children:"Please confirm you'd like to move the following domain and its redirects:"}):(0,t.jsx)(t.Fragment,{children:"Please confirm you'd like to transfer the following domain and the domain it redirects to:"})]})]}),(0,t.jsxs)("div",{className:"jsx-aedf4df6a7382869 flex flex-col items-stretch justify-start gap-8 flex-initial",children:[v?(0,t.jsx)(o.Note,{className:tv.default.noteCenterText,fill:!0,label:!1,size:"small",type:"lite",variant:"contrast",children:(0,t.jsx)("p",{className:"jsx-aedf4df6a7382869 text-copy-14 text-center",children:(0,t.jsx)(m.Link,{external:!0,href:`https://${v}`,tab:!0,type:"highlight",children:v})})}):(0,t.jsx)(a.Skeleton,{height:32,width:"100%"}),(0,t.jsxs)("div",{className:"jsx-aedf4df6a7382869 flex flex-row items-stretch justify-evenly flex-initial",children:[(0,t.jsxs)("div",{style:{flex:"0 0 36%"},className:"jsx-aedf4df6a7382869 flex flex-col items-center justify-start gap-2",children:[(0,t.jsx)(m.Link,{href:E,target:"_blank",children:(0,t.jsx)(tb,{hideSkeleton:!!(h&&g),project:g})}),(0,t.jsx)("p",{style:{maxWidth:"100px"},className:"jsx-aedf4df6a7382869 text-[14px] leading-[20px] font-medium text-center line-clamp-3 geist-hide-on-mobile",children:g&&h?(0,t.jsx)(m.Link,{href:E,target:"_blank",title:g.name,variant:"primary",children:g.name}):(0,t.jsx)(a.Skeleton,{height:20,width:100})})]}),(0,t.jsxs)("div",{style:{flex:"0 0 36%"},className:"jsx-aedf4df6a7382869 flex flex-col items-center justify-start gap-2",children:[(0,t.jsx)(m.Link,{href:T,target:"_blank",children:(0,t.jsx)(tb,{hideSkeleton:!!(h&&g),project:h})}),(0,t.jsx)("p",{style:{maxWidth:"100px"},className:"jsx-aedf4df6a7382869 text-[14px] leading-[20px] font-medium text-center line-clamp-3 geist-hide-on-mobile",children:g&&h?(0,t.jsx)(m.Link,{href:T,target:"_blank",title:h.name,variant:"primary",children:h.name}):(0,t.jsx)(a.Skeleton,{height:20,width:100})})]})]})]}),(0,t.jsxs)(k.Modal.Outset,{children:[(0,t.jsx)(tw,{count:w.length+1,loading:!P,title:(0,t.jsxs)("span",{className:"jsx-aedf4df6a7382869",children:[w.length+1," ",0===w.length?"domain":"domains"," will be moved."]}),children:(0,t.jsxs)("div",{className:"jsx-aedf4df6a7382869",children:[(0,t.jsx)(tN,{children:(0,t.jsx)(m.Link,{external:!0,href:`https://${v}`,style:{flexGrow:"1"},tab:!0,children:v})},v),w.map(e=>(0,t.jsx)(tN,{children:(0,t.jsx)(m.Link,{external:!0,href:`https://${e.name}`,style:{flexGrow:"1"},tab:!0,children:e.name})},e.name)),!C&&(0,t.jsxs)("div",{className:"jsx-aedf4df6a7382869 "+(tv.default.inset||""),children:[(0,t.jsx)(th.LoadMoreButton,{loading:N,onClick:S}),(0,t.jsx)(D.Spacer,{})]})]})}),(0,t.jsx)(D.Spacer,{y:-1})]})]})}),(0,t.jsxs)(k.Modal.Actions,{children:[(0,t.jsx)(k.Modal.Action,{onClick:R,type:"secondary",children:"Cancel"}),(0,t.jsx)(k.Modal.Action,{loading:d,onClick:O,children:d?(0,t.jsx)(tm.LoadingDots,{children:"Moving"}):`Move ${w.length+1}${C?"":"+"} ${w.length+1>1?"domains":"domain"}`})]}),(0,t.jsx)(tc.default,{id:"aedf4df6a7382869",children:"header.jsx-aedf4df6a7382869{max-width:440px;margin:0 auto}header.jsx-aedf4df6a7382869>h2{text-align:center;margin:0}header.jsx-aedf4df6a7382869>p{color:var(--accents-5);margin:10px auto 0}.added.jsx-aedf4df6a7382869{color:#999;flex:none}"})]})}function tw(e){let{title:n,children:r,loading:a,count:i,open:s}=e;return a?(0,t.jsx)("div",{className:tv.default.loadingItem,children:(0,t.jsx)(eH.Spinner,{size:14})}):0===i?(0,t.jsx)(tf.Details,{title:n}):(0,t.jsx)(tf.Details,{open:s,title:n,children:(0,t.jsx)("div",{className:tv.default.content,children:r})})}function tN(e){let{children:n}=e;return(0,t.jsx)(tf.Item,{className:tv.default.subitem,children:n})}var tS=e.i(2848845),tC=e.i(4138437);function tI(e){let{newDomain:n,oldDomain:r,onCancel:a,onSave:i,teamSlug:s,project:l}=e,[d,c]=(0,x.useTransition)(),[u,m]=(0,x.useState)("redirect-old-to-new"),[h,f]=(0,x.useState)(null),p=(0,x.useCallback)(()=>{a()},[a]),g=(0,x.useCallback)(async()=>{try{await (0,E.addProjectDomain)({domain:n.domainName,project:{id:l},team:{id:s},customEnvironmentId:n.customEnvironmentId,gitBranch:n.gitBranch,redirect:n.redirect,redirectStatusCode:n.redirectStatusCode})}catch(e){f((0,e2.isError)(e)?e.message:"An unknown error occurred");return}try{switch(u){case"redirect-old-to-new":await tl({isReady:!0,project:{id:l},team:{id:s},projectDomain:r,redirect:n.domainName,redirectStatusCode:307});break;case"delete-old":await (0,E.removeProjectDomain)(l,s,r.name,!1)}}catch(e){await (0,E.removeProjectDomain)(l,s,n.domainName,!1).catch(()=>null),f((0,e2.isError)(e)?e.message:"An unknown error occurred");return}i(n)},[u,n,l,s,r,i]);return(0,t.jsxs)(k.Modal,{active:!0,onClickOutside:p,children:[(0,t.jsxs)(k.Modal.Body,{children:[(0,t.jsx)(k.Modal.Title,{children:"Edit domain"}),(0,t.jsx)(D.Spacer,{}),(0,t.jsx)("div",{className:"flex flex-col gap-2 pb-2",children:(0,t.jsxs)("span",{children:["You've edited the domain name from ",(0,t.jsx)("b",{children:r.name})," to"," ",(0,t.jsx)("b",{children:n.domainName}),"."]})}),(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[(0,t.jsx)(e9.RadioGroup,{onChange:e=>m(e),value:u,children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[(0,t.jsx)(tC.Card,{className:(0,b.cn)("border border-solid border-gray-400 p-0 pl-4","redirect-old-to-new"===u&&"border-blue-700"),gap:2,padding:4,secondary:"redirect-old-to-new"===u,children:(0,t.jsx)(e9.RadioGroup.Item,{fullWidth:!0,value:"redirect-old-to-new",children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-between flex-initial p-4 pl-2",children:[(0,t.jsx)("p",{className:"text-[14px] leading-[20px] font-medium",children:"Redirect old domain to new"}),(0,t.jsxs)("p",{className:"text-copy-14 text-gray-900",children:["Automatically send visitors from ",r.name," to"," ",n.domainName]})]})})}),(0,t.jsx)(tC.Card,{className:(0,b.cn)("border border-solid p-0 pl-4","delete-old"===u?"border-blue-700":"border-gray-400"),gap:2,padding:4,secondary:"delete-old"===u,children:(0,t.jsx)(e9.RadioGroup.Item,{className:"items-center",fullWidth:!0,value:"delete-old",children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-between flex-initial p-4 pl-2",children:[(0,t.jsx)("p",{className:"text-[14px] leading-[20px] font-medium",children:"Remove old domain"}),(0,t.jsxs)("p",{className:"text-copy-14 text-gray-900",children:["Permanently delete ",r.name," and replace it with"," ",n.domainName]})]})})})]})}),h?(0,t.jsx)(o.Note,{type:"error",fill:!0,children:h}):null]})]}),(0,t.jsxs)(k.Modal.Actions,{children:[(0,t.jsx)(k.Modal.Action,{onClick:p,type:"secondary",disabled:d,children:"Cancel"}),(0,t.jsx)(k.Modal.Action,{onClick:()=>{c(g)},loading:d,children:"Save"})]})]})}var tk=e.i(2560270),tD=e.i(4689995);function tP(e){var n,r,a;let i=(0,v.useRouter)(),{domainConnectDomain:s,error:l,errorDescription:o}=(0,eB.useDomainConnectSearchParams)(),{team:d}=(0,tx.useTeam)(),{trigger:c,isMutating:u}=(n=e.projectId,r=d?.id??"",a=s??"",(0,tD.default)(`/remove-project-domain-${n}-${r}-${a}`,async()=>{await (0,E.removeProjectDomain)(n,r,a)}));if(!s||!d)return null;let m=l||!!o,h=async()=>{await c().catch(()=>{}),e.onCancel(),i.replace(window.location.pathname)},x=o?"user_cancel"===o?"Your domain was not configured because the process was canceled.":"An identical record already exists"===o?"One or more records were not created because an identical record already existed":o.endsWith("perhaps your object identifier is invalid?")?"Your DNS provider had an error while creating the record.":null:null;return(0,t.jsxs)(k.Modal.Modal,{active:m,"data-testid":(0,P.tid)("project","settings","domain-connect-error-modal"),onClickOutside:()=>{i.replace(window.location.pathname)},children:[(0,t.jsxs)(k.Modal.Body,{children:[(0,t.jsx)(k.Modal.Header,{children:(0,t.jsx)(k.Modal.Title,{children:"Configuration Failed"})}),"We failed to automatically configure"," ",(0,t.jsx)("strong",{children:s}),". Please follow the steps to manually configure your domain with your provider.",x?(0,t.jsxs)("div",{className:"pt-4 text-sm text-red-800",children:["Error: ",x]}):null]}),(0,t.jsxs)(k.Modal.Actions,{className:"justify-between",children:[(0,t.jsx)(k.Modal.Action,{loading:u,onClick:h,type:"secondary",children:"Cancel"}),(0,t.jsx)(k.Modal.Action,{onClick:()=>{i.replace(window.location.pathname)},children:"Continue with Manual Configuration"})]})]})}var tz=e.i(992159);function tA(){let[e,t]=(0,S.useQueryState)("show-add-domain-modal",{...C.parseAsBoolean,shallow:!0});return{showAddDomainModal:e??!1,setShowAddDomainModal:t}}function tE(e){let{setShowAddDomainModal:n}=tA(),{can:a,isLoading:s}=(0,y.default)({projectIdOrName:e.projectId}),l=a(w.Action.Update,w.Resource.Project),o=!s&&!l;return(0,t.jsx)(i.Tooltip,{disableTriggers:!o,text:"You don't have permission to add domains to this project. Ask your team admin to add a domain or grant you the member role or higher.",children:(0,t.jsx)(r.Button,{disabled:o,onClick:()=>void n(!0),children:"Add Domain"})})}function tT(){let[e,t]=(0,S.useQueryState)("search",{...C.parseAsString,shallow:!0}),{domainConnectDomain:n,error:r}=(0,eB.useDomainConnectSearchParams)();return{search:e??(r?void 0:n)??void 0,setSearch:e=>t(e??null)}}function tR(){let[e,t]=(0,S.useQueryState)("redirect",{...C.parseAsString,shallow:!0});return{redirectFilter:e,setRedirectFilter:e=>t(e)}}function tO(){let[e,t]=(0,S.useQueryState)("gitBranch",{...C.parseAsString,shallow:!0});return{gitBranchFilter:e,setGitBranchFilter:e=>t(e)}}function t_(){let[e,t]=(0,S.useQueryState)("environment",{...C.parseAsString,shallow:!0});return{environmentFilter:e,setEnvironmentFilter:e=>t(e)}}function tB(e){let n=(0,v.useParams)(),r=n?.project,{data:a}=(0,T.useCustomEnvironments)(r),i=(a?.customEnvironments||[]).filter(e=>"preview"!==e.slug),s=[{id:N.EnvTarget.Production,name:"Production"},...i.map(e=>({id:e.id,name:e.slug}))];return(0,t.jsxs)(F.Combobox,{clearable:!0,disabled:e.disabled,noRawSelectedValue:!0,onChange:t=>e.onChange(t??null),placeholder:"All Environments",value:e.value??"",children:[(0,t.jsx)(F.Combobox.Input,{"aria-label":"Environment",onChange:t=>e.onChange(t.target.value||null)}),(0,t.jsx)(F.Combobox.List,{emptyMessage:"No Environments",children:s.map(e=>(0,t.jsx)(F.Combobox.Option,{value:e.id,children:e.name},e.id))})]})}function t$(e){let{search:t}=tT(),{redirectFilter:n}=tR(),{gitBranchFilter:r}=tO(),{environmentFilter:a}=t_(),[{mutate:i},{domains:s,loadMore:l,isLoadingMore:o,isReachingEnd:d,isLoading:c}]=function(e){let{limit:t=20,gitBranch:n,production:r,redirect:a,redirects:i,search:s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=arguments.length>2?arguments[2]:void 0,o=(0,L.useTeamSlug)(),d=(0,eZ.useIsomorphicSWRInfinite)((l,d)=>{let c=`${(0,H.API_PROJECTS_DOMAINS_VERSION)("v9")}/${e}/domains`,u={limit:t+1,gitBranch:n,production:r,redirect:a,redirects:i,teamId:o,search:s};if(!l)return`${c}${(0,q.encode)(u)}`;let m=(d?.domains.length||0)>t?d?.domains[t-1].createdAt:null;return m?`${c}${(0,q.encode)({...u,until:m})}`:""},async e=>""===e?{domains:[],pagination:{count:0,next:null,prev:null}}:(0,eC.fetchAPI)(e,{throwOnHTTPError:!0}),l),c=d.data?.flatMap(e=>e.domains.slice(0,t))??[],u=d.size>(d.data?.length??0),m=d.data?.[d.data.length-1];return[d,{domains:c,loadMore:()=>d.setSize(e=>e+1),isLoadingMore:u,isReachingEnd:m?m.domains.length<=t:void 0,isLoading:d.isLoading}]}(e,{limit:tU,search:t,redirect:n??void 0,gitBranch:r??void 0,production:a===N.EnvTarget.Production||a!==N.EnvTarget.Preview&&void 0});return{domains:a&&a!==N.EnvTarget.Production&&a!==N.EnvTarget.Preview?s.filter(e=>e.customEnvironmentId===a):s,revalidateDomains:i,loadMore:l,isLoadingMore:o,isReachingEnd:d,isLoading:c}}function tM(e){let{domain:r,project:a}=e,{data:i}=(0,T.useCustomEnvironments)(a,{revalidateIfStale:!1});if(r.redirect)return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(p.CornerDownRight,{size:16}),(0,t.jsx)(n.Badge,{size:"sm",variant:"gray-subtle",children:r.redirectStatusCode??307}),(0,t.jsx)("span",{className:"truncate",children:r.redirect})]});if(r.customEnvironmentId){let e=i?.customEnvironments.find(e=>e.id===r.customEnvironmentId);return(0,t.jsxs)("div",{className:"flex flex-[1_0_0] items-center gap-2 overflow-hidden font-mono text-sm font-normal leading-5 text-gray-900",children:[(0,t.jsx)(_.EnvironmentIcon,{id:r.customEnvironmentId}),e?.slug]})}return r.gitBranch?(0,t.jsxs)("div",{className:"flex flex-[1_0_0] items-center gap-2 overflow-hidden font-mono text-sm font-normal leading-5 text-gray-900",children:[(0,t.jsx)(f.GitBranch,{}),(0,t.jsx)("span",{className:"truncate",children:r.gitBranch})]}):(0,t.jsxs)("div",{className:"flex flex-[1_0_0] items-center gap-2 overflow-hidden font-mono text-sm font-normal leading-5 text-gray-900",children:[(0,t.jsx)(_.EnvironmentIcon,{id:N.EnvTarget.Production}),"Production"]})}function tF(e){let{domain:n,project:a,editingDomain:s,setEditingDomain:l,onOpenAccordion:o}=e,{can:d}=(0,y.default)({projectIdOrName:a}),c=eq(n);if(s)return null;let u=!d(w.Action.Update,w.Resource.Project);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.Button,{loading:"loading"===c.status||c.isRefreshing,type:"secondary",size:"small",className:"hidden lg:flex",onClick:()=>{"loading"!==c.status&&c.refresh()},children:"Refresh"}),(0,t.jsx)(i.Tooltip,{disableTriggers:!u,text:"You don't have permission to edit domains from this project. Ask your team admin to edit a domain or grant you the member role or higher.",children:(0,t.jsx)(r.Button,{disabled:u,onClick:()=>{l(!0),o(n.name)},size:"small",type:"secondary",children:"Edit"})})]})}function tL(e){let{domain:n,search:r,textOnly:a}=e,{status:i}=eq(n),[s,l]=(0,x.useState)(!1),o=e=>{if(!r)return(0,t.jsx)("span",{className:"truncate text-sm font-medium leading-5 text-gray-alpha-1000 no-underline max-w-full",children:e});let n=function(e,t){let n=e.toLowerCase(),r=t.toLowerCase();if(!n)return null;let a=r.indexOf(n);if(-1!==a)return[a,a+n.length];let i=null,s=0,l=0;for(let e=0;e<r.length;e++)for(let t=Math.min(n.length,r.length-e);t>=2;t--){let a=r.substring(e,e+t);if(n.includes(a)||a.includes(n)){let r=1/(e+1)*t*(t/n.length);r>l&&(i=[e,e+t],s=t,l=r)}}if(i&&s>=2)return i;let o=-1,d=0,c=null,u=0;for(let e=0;e<r.length;e++){let t=r[e];n.includes(t)?(-1===o&&(o=e),d++):(d>u&&(c=[o,o+d],u=d),o=-1,d=0)}return(d>u&&(c=[o,o+d]),c&&c[1]-c[0]>=2)?c:null}(r,e);if(!n)return(0,t.jsx)("span",{className:"truncate text-sm font-medium leading-5 text-gray-alpha-1000 no-underline",children:e});let[a,i]=n,s=e.substring(a,i);return(0,t.jsx)("span",{className:"truncate text-sm font-medium leading-5 text-gray-alpha-1000 no-underline",children:(0,t.jsx)(e4.HighlightText,{as:"span",search:s,text:e})})};return"loading"===i||a?o(n.name):(0,R.default)(n.name)?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m.Link,{className:"truncate text-sm font-medium leading-5 text-gray-alpha-1000 no-underline max-w-full",onClick:()=>l(!0),children:o(n.name)}),s?(0,t.jsx)(O.default,{active:s,onCancel:()=>l(!1),url:n.name.replace("*.","")}):null]}):(0,t.jsx)(m.Link,{className:"truncate text-sm font-medium leading-5 text-gray-alpha-1000 no-underline max-w-full",href:`https://${n.name}`,rel:"noreferrer noopener",target:"_blank",children:o(n.name)})}function tW(e){let{domain:n,ui:a,onSave:i,onRemove:s,onCancel:d,projectDomainTarget:c,teamSlug:u,project:m}=e,[h,f]=(0,x.useState)(n.name),[p,g]=(0,x.useState)(null),j=null;0===h.length?j="Domain name is required":c.isErr()&&(j=c.error);let[v,b]=(0,x.useState)(null),y=(0,x.useCallback)(async e=>{e.domainName=e.domainName.toLowerCase();try{e.domainName!==n.name?b({newDomain:e,oldDomain:n}):(await tl({project:{id:m},team:{id:u},projectDomain:n,isReady:!0,customEnvironmentId:e.customEnvironmentId,gitBranch:e.gitBranch,redirect:e.redirect,redirectStatusCode:e.redirectStatusCode}),i(e))}catch(e){g((0,e2.isError)(e)?e.message:"We encountered an error while saving this domain. If the problem persists, please contact support.")}},[n,i,m,u]);return(0,t.jsxs)("div",{className:"pb-6 pt-2",children:[v?(0,t.jsx)(tI,{newDomain:v.newDomain,oldDomain:v.oldDomain,onCancel:d,onSave:e=>{i(e)},teamSlug:u,project:m}):null,(0,t.jsx)(l.Input,{"aria-labelledby":"domain-label",value:h,label:"Domain",onChange:e=>{f(e.target.value)}}),(0,t.jsx)("div",{className:"pt-4",children:a}),p?(0,t.jsx)(o.Note,{type:"error",children:p}):null,(0,t.jsxs)("div",{className:"flex flex-row justify-between gap-2 pt-4",children:[(0,t.jsx)(r.Button,{onClick:s,type:"error",children:"Remove"}),(0,t.jsxs)("div",{className:"flex flex-row gap-2",children:[(0,t.jsx)(r.Button,{type:"secondary",onClick:d,children:"Cancel"}),(0,t.jsx)(r.Button,{disabled:null!==j,onClick:()=>{c.isErr()||y({domainName:h,redirect:c.value.redirect??null,redirectStatusCode:c.value.redirectStatusCode??null,gitBranch:c.value.gitBranch??null,customEnvironmentId:c.value.customEnvironmentId||void 0})},children:"Save"})]})]})]})}function tV(e){let{status:n,editingDomain:r,domain:a,project:i,revalidateDomains:s,setEditingDomain:l,getProjectDomainTarget:o,ui:d,teamSlug:c,setRemoveModal:u,onCloseAccordion:h}=e;if(r)return(0,t.jsxs)("div",{className:"p-2 md:px-7",children:[(0,t.jsx)(tW,{domain:a,project:i,onSave:async()=>{await s(),l(!1),h(a.name)},projectDomainTarget:o(),onCancel:()=>{h(a.name),l(!1)},ui:d,teamSlug:c,onRemove:()=>{u(!0)}}),e.teamDomain?.zone&&"loading"!==n.status&&(null===n.level||"warning"===n.level)?(0,t.jsx)("div",{className:"pb-2",children:(0,t.jsx)("p",{className:"text-copy-14",children:(0,t.jsxs)(m.Link,{href:e.teamDomain?.teamId?`/${c}/~/domains/${a.apexName}`:`/dashboard/domains/${a.apexName}`,variant:"highlight",className:"text-xs",children:["View DNS Records & More for ",a.apexName," â†’"]})})}):null]});if("loading"===n.status)return null;if(null===n.level){let e=new Date(Date.now()-864e5),n=new Date(a.createdAt),r=(0,X.isPublicAlias)(a.name);return n>e&&!r?(0,t.jsx)("div",{className:"p-2 px-7",children:(0,t.jsx)(tS.DnsPropagationNote,{children:"It might take some time for the DNS records to propagate globally."})}):null}return(0,t.jsxs)("div",{className:(0,b.cn)("px-7 pb-4 pt-0",n.className),children:[" ",n.ui," "]})}function tG(e){let{domain:n,project:r,teamSlug:a,search:i,onOpenAccordion:s,onCloseAccordion:l,revalidateDomains:o}=e,[d,c]=(0,x.useState)(!1),[u,m]=(0,x.useState)(!1),[h,f]=(0,x.useState)(void 0),[p,v]=(0,x.useTransition)(),y=(0,M.useIsMobile)(),w=ej(n.name);w.data?.isOk()&&w.data.value.domain.teamId;let{getProjectDomainTarget:N,ui:S}=tr({domain:n.name,projectDomainTarget:n,saving:!1,style:y?"cards":"inline"}),C=(0,x.useCallback)(async e=>{let{removeRedirects:t=!1}=e;try{await (0,E.removeProjectDomain)(r,a,n.name,t),await o(),c(!1),m(!1)}catch(e){f((0,e2.isError)(e)?e.message:"We encountered an error while removing this domain. If the problem persists, please contact support.")}},[r,a,n.name,o]),I=eq(n),k="loading"===I.status||null===I.level||u;return(0,t.jsxs)("div",{className:(0,b.cn)("border-b-400 border-b border-solid",e.className),children:[(0,t.jsxs)(g.Item,{value:n.name,children:[(0,t.jsx)("div",{className:"flex w-full flex-col px-4 ",children:(0,t.jsxs)("div",{className:"flex h-[70px] w-full flex-row items-center justify-between",children:[(0,t.jsxs)(g.Trigger,{className:(0,j.clsx)("flex select-text items-center gap-3 self-stretch overflow-hidden bg-transparent p-0 [font-family:Geist]",{"cursor-pointer":!k,"cursor-default":k}),disabled:k,children:[(0,t.jsx)(eK,{domain:n}),(0,t.jsx)("div",{className:"flex w-[220px] min-w-0 items-center gap-2 md:w-[359px]",children:(0,t.jsxs)("div",{className:"flex flex-col items-start justify-end gap-2 max-w-full",children:[(0,t.jsx)(tL,{domain:n,search:i,textOnly:!k}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(eX,{domain:n}),u||k?null:(0,t.jsxs)("div",{className:"flex items-center gap-0 text-xs text-gray-alpha-1000",children:["Learn more",(0,t.jsx)(tk.ChevronDown,{className:(0,j.clsx)("ease-[ease] transition-transform duration-200","[[data-state=open]_&]:rotate-180"),size:12,color:"gray-900"})]})]})]})}),(0,t.jsx)("div",{className:"hidden shrink items-center gap-2 overflow-hidden truncate font-mono text-sm font-normal leading-5 text-gray-900 md:flex",children:(0,t.jsx)(tM,{domain:n,project:r})})]}),(0,t.jsx)("div",{className:"flex shrink-0 items-center gap-3",children:(0,t.jsx)(tF,{domain:n,project:r,editingDomain:u,setEditingDomain:m,onOpenAccordion:s})})]})}),(0,t.jsx)(g.Content,{className:"overflow-hidden will-change-[height] md:px-4 [[data-state=open]_&]:animate-content-open",children:(0,t.jsx)(tV,{status:I,editingDomain:u,domain:n,teamDomain:w.data?.isOk()?w.data.value.domain:null,project:r,revalidateDomains:o,setEditingDomain:m,getProjectDomainTarget:N,ui:S,teamSlug:a,setRemoveModal:c,onCloseAccordion:l},n.name)})]}),d?(0,t.jsx)(A,{domain:n.name,onRemoveDomain:e=>{v(async()=>{await C(e)})},removeModal:d,removing:p,setRemoveModal:c,error:h}):null]})}let tU=90;function tY(e){let{isLoadingMore:n,isReachingEnd:a,loadMore:i}=t$(e.project);return(0,t.jsx)("div",{className:"flex w-full items-center justify-center",children:void 0!==a&&!a&&(0,t.jsx)(r.Button,{type:"tertiary",className:"w-full",loading:n,onClick:()=>void i(),children:"Load more"})})}function tq(e){let{domains:n,loadMore:a,isLoadingMore:i,isReachingEnd:l,isLoading:o,revalidateDomains:d}=t$(e.project),{search:c}=tT(),[u,m]=(0,x.useState)([]),h=(0,x.useCallback)(e=>{m(e)},[]),f=(0,x.useCallback)(e=>{m(t=>t.includes(e)?t:[...t,e])},[]),p=(0,x.useCallback)(e=>{m(t=>t.filter(t=>t!==e))},[]);return o?(0,t.jsx)(tJ,{}):n.length?(0,t.jsx)(g.Root,{type:"multiple",value:u,onValueChange:h,children:(0,t.jsx)("div",{className:"flex flex-col  items-start justify-center self-stretch rounded-md border border-solid border-gray-400 bg-background-100",children:(0,t.jsx)(e0.Virtuoso,{style:{width:"100%"},data:n,endReached:()=>{i||l||a()},useWindowScroll:!0,components:{Footer:()=>i?(0,t.jsx)(tY,{project:e.project}):null},itemContent:(r,a)=>(0,t.jsx)(tG,{domain:a,className:r===n.length-1?"border-b-0":"",project:e.project,teamSlug:e.teamSlug,search:c,onOpenAccordion:f,onCloseAccordion:p,revalidateDomains:d},a.name)})})}):(0,t.jsx)(s.EmptyState.Root,{paddingY:96,descriptionClassName:"max-w-none",titleClassName:"max-w-none",title:"No Results Found",description:"Your search did not return any results.",children:(0,t.jsxs)("div",{className:"flex flex-col items-center gap-2 sm:flex-row",children:[(0,t.jsx)(r.Button,{type:"secondary",onClick:e.onClearFilters,children:"Clear Filters"}),(0,t.jsx)(tE,{projectId:e.project})]})})}let tH=[1,2,3];function tJ(){return(0,t.jsx)("div",{className:"flex flex-col items-start justify-center self-stretch rounded-md border border-solid border-gray-400 bg-background-100",children:tH.map(e=>(0,t.jsx)("div",{className:(0,b.cn)("border-b-400 border-b border-solid w-full"),children:(0,t.jsx)("div",{className:"flex w-full flex-col px-4 ",children:(0,t.jsxs)("div",{className:"flex h-[70px] w-full flex-row items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 self-stretch overflow-hidden bg-transparent p-0 [font-family:Geist]",children:[(0,t.jsx)(a.Skeleton,{className:"block rounded-full",height:"16px",width:"16px"}),(0,t.jsx)("div",{className:"flex w-[220px] min-w-0 items-center gap-2 md:w-[359px]",children:(0,t.jsxs)("div",{className:"flex flex-col items-start justify-end gap-2",children:[(0,t.jsx)(a.Skeleton,{className:"h-[20px]",width:"142px"}),(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsx)(a.Skeleton,{className:"h-[20px]",width:"116px"})})]})}),(0,t.jsx)("div",{className:"hidden shrink items-center gap-2 overflow-hidden truncate font-mono text-sm font-normal leading-5 text-gray-900 md:flex",children:(0,t.jsx)(a.Skeleton,{className:"h-[20px]",width:"108px"})})]}),(0,t.jsx)("div",{className:"flex shrink-0 items-center gap-3",children:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.Button,{loading:!0,type:"secondary",size:"small",className:"hidden lg:flex",children:"Refresh"}),(0,t.jsx)(r.Button,{disabled:!0,size:"small",type:"secondary",children:"Edit"})]})})]})})},e))})}function tQ(){let e=(0,v.useParams)(),n=e?.teamSlug,r=e?.project,{search:a,setSearch:i}=tT(),{redirectFilter:l,setRedirectFilter:o}=tR(),{gitBranchFilter:f,setGitBranchFilter:p}=tO(),{environmentFilter:g,setEnvironmentFilter:j}=t_(),{domains:b,isLoading:y,revalidateDomains:w}=t$(r),I=(0,e1.useDebouncedCallback)(e=>{i(e)},200),{domain:k,setDomain:D}=function(){let[e,t]=(0,S.useQueryState)("domain",{...C.parseAsString,shallow:!0});return{domain:e,setDomain:t}}(),{showAddDomainModal:P,setShowAddDomainModal:z}=tA(),[A,E]=(0,x.useState)(null),T=!a&&!l&&!f&&!g&&!y&&0===b.length,R=a??k??null,[O,_]=(0,x.useState)(a??"");return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex flex-row justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-heading-24",children:(0,t.jsx)(h.SearchContextHighlighter,{children:"Domains"})}),(0,t.jsx)("span",{className:"hidden md:block",children:(0,t.jsx)("p",{className:"text-copy-14 text-gray-900",children:"Domains can be assigned to git branches, custom environments, and production."})})]}),T?null:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(m.ButtonLink,{className:"hidden md:flex",href:`/domains?q=${a?.length?a:""}&teamSlug=${n}`,type:"secondary",children:"Buy Domain"}),(0,t.jsx)(tE,{projectId:r})]})]}),(0,t.jsx)("span",{className:"block md:hidden",children:"These are your domains assigned to branches & production deployments."}),T?(0,t.jsx)(s.EmptyState.Root,{paddingY:28,icon:(0,t.jsx)(s.EmptyState.Icon,{icon:(0,t.jsx)(e3.Globe,{size:32})}),descriptionClassName:"max-w-none",titleClassName:"max-w-none",title:"No domains have been added yet",description:"Add or purchase a domain to get started",children:(0,t.jsxs)("div",{className:"flex flex-col items-center gap-2 sm:flex-row",children:[(0,t.jsx)(m.ButtonLink,{href:`/domains?q=${a?.length?a:""}&teamSlug=${n}`,type:"secondary",children:"Buy Domain"}),(0,t.jsx)(tE,{projectId:r})]})}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsx)($,{value:O,setSearch:e=>{I(e),_(e??"")}})}),(0,t.jsxs)(c.MenuContainer,{position:"bottom-end",closeOnSelect:!1,children:[(0,t.jsx)(u.MenuButton,{type:"secondary","aria-label":"Filter domains",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(tz.Filter,{size:16}),(0,t.jsx)("span",{className:"hidden md:inline",children:"Filter"})]})}),(0,t.jsx)(d.Menu,{width:300,children:(0,t.jsxs)("div",{className:"flex flex-col gap-3 p-4",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsx)("p",{className:"text-label-12 text-gray-900",children:"Environment"}),(0,t.jsx)(tB,{value:g,onChange:e=>{j(e)},disabled:!1})]}),(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsx)("p",{className:"text-label-12 text-gray-900",children:"Git Branch"}),(0,t.jsx)(G,{disabled:!1,environmentId:N.EnvTarget.Preview,clearable:!0,onChange:e=>{p(e??null)},onFocus:void 0,value:f||""})]}),(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsx)("p",{className:"text-label-12 text-gray-900",children:"Redirect To"}),(0,t.jsx)(te,{selfRedirect:!1,setRedirect:e=>{o("function"==typeof e?e(l):e)},savingRedirect:!1,redirect:l,domain:"",disabled:!1,className:"w-full"})]})]})})]})]}),(0,t.jsx)(tq,{project:r,teamSlug:n,onClearFilters:()=>{i(void 0),o(null),p(null),j(null),_("")}})]}),P?(0,t.jsx)(td,{onClose:()=>{z(null),D(null)},onSave:async()=>{await Promise.all([i(void 0),D(null)]),_(""),await w(),await z(null)},initialAddDomainInput:R,project:r,onDomainTransferRequest:e=>{z(null),E(e)},teamSlug:n}):null,A?(0,t.jsx)(ty,{domain:A.domain,onCancel:()=>E(null),active:!0,onComplete:()=>{E(null),w()},projectIdOrNameInUse:A.projectIdOrNameInUse}):null,(0,t.jsx)(tP,{projectId:r,onCancel:()=>{w()}})]})}e.s(["NewProjectDomainsPage",()=>tQ],8162654)}]);

//# debugId=7cdf59ad-bab2-0d89-85bc-d173e2f47712
//# sourceMappingURL=7555044725e003b2.js.map