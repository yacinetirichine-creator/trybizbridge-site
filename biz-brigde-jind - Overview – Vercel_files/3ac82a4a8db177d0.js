;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="ef43988b-09b0-ab6d-971d-4205bb320619")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,5099572,e=>{e.v({contributorInfo:"manage-role-modal-module__oQbjma__contributorInfo",editButton:"manage-role-modal-module__oQbjma__editButton",linkButton:"manage-role-modal-module__oQbjma__linkButton",projectColumn:"manage-role-modal-module__oQbjma__projectColumn",projectColumnLabel:"manage-role-modal-module__oQbjma__projectColumnLabel",projectModalArrow:"manage-role-modal-module__oQbjma__projectModalArrow",projectRoleEntity:"manage-role-modal-module__oQbjma__projectRoleEntity",projectRoleEntityError:"manage-role-modal-module__oQbjma__projectRoleEntityError",projectRoleEntityWarning:"manage-role-modal-module__oQbjma__projectRoleEntityWarning",radioGroupItem:"manage-role-modal-module__oQbjma__radioGroupItem",readOnlyItem:"manage-role-modal-module__oQbjma__readOnlyItem",removeButton:"manage-role-modal-module__oQbjma__removeButton",selectedItem:"manage-role-modal-module__oQbjma__selectedItem",teamRoleEntity:"manage-role-modal-module__oQbjma__teamRoleEntity"})},8786464,9791414,9440850,1521964,e=>{"use strict";var s=e.i(1146226),l=e.i(5169864),t=e.i(4585051),i=e.i(2504781),a=e.i(1848296),n=e.i(5468328),r=e.i(6891161),o=e.i(455575),c=e.i(8522580),d=e.i(2064047),m=e.i(4030453),u=e.i(3869281),x=e.i(9584456),p=e.i(9138164),h=e.i(2988836),j=e.i(9722978),f=e.i(4004502),g=e.i(277234),y=e.i(4244280),v=e.i(5338940),b=e.i(8129674),N=e.i(1235157),E=e.i(7750276),R=e.i(2720056),T=e.i(6989368),I=e.i(6468432),C=e.i(8248414),_=e.i(8615377),A=e.i(57106);let M="This Team Member is managed with Directory Sync.";function P(){return(0,s.jsxs)(s.Fragment,{children:["Additional permissions are required to manage Team members."," ",(0,s.jsx)(A.Link,{href:"/docs/rbac",variant:"highlight",children:"Learn More â†’"})]})}e.s(["AdditionalPermissionsMessage",()=>P,"directorySyncPermissionsMessage",0,M],9791414);var w=e.i(7957251),S=e.i(5756088),G=e.i(9220646),O=e.i(9689002),D=e.i(1492947),$=e.i(6318858),B=e.i(2331152),k=e.i(5883567),z=e.i(5610834),L=e.i(3322724),F=e.i(1236612),V=e.i(9261674),J=e.i(84614),W=e.i(8435318);function Q(e){let{accessGroupsData:t,value:a=[],onChange:n,isOpen:r,setIsOpen:o}=e,{teamSlug:c}=(0,v.useTeam)(),d=(0,z.useRouter)(),m=[...t].sort((e,s)=>e.isDsyncManaged&&!s.isDsyncManaged?1:!e.isDsyncManaged&&s.isDsyncManaged?-1:e.name.localeCompare(s.name)),u=(0,V.useCommand)(),[x,p]=(0,l.useState)(a),[h,f]=(0,l.useState)({}),g=(0,L.useIsMobile)(),y=u.setInputValue;return((0,l.useEffect)(()=>{if(!r){p(a),f(H(a));return}f(H(x))},[r,n,x,a]),g)?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(D.Drawer,{onDismiss:()=>{o(!1),y(""),q(x,a)||n?.(x)},show:r,children:(0,s.jsx)(U,{accessGroups:m,activeAccessGroupMap:h,commandProps:u,setSelectedAccessGroups:p})}),(0,s.jsx)(i.Button,{"aria-label":"Add access group",onClick:()=>o(!0),style:{padding:"0",width:"var(--geist-form-small-height)",height:"var(--geist-form-small-height)"},svgOnly:!0,type:"tertiary",children:(0,s.jsx)(k.PlusCircle,{})})]}):(0,s.jsxs)(G.Root,{onOpenChange:e=>{!e&&(y(""),q(x,a)||n?.(x)),o(e)},children:[(0,s.jsx)(G.Trigger,{asChild:!0,children:(0,s.jsx)(i.Button,{"aria-label":"Add access group",style:{padding:"0",width:"var(--geist-form-small-height)",height:"var(--geist-form-small-height)"},svgOnly:!0,type:"tertiary",children:(0,s.jsx)(k.PlusCircle,{})})}),(0,s.jsx)(G.Portal,{children:(0,s.jsx)(G.Content,{align:"start",className:W.default.content,side:"bottom",children:(0,s.jsx)(U,{accessGroups:m,activeAccessGroupMap:h,commandProps:u,setSelectedAccessGroups:p,children:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(F.Command.Separator,{}),(0,s.jsx)(F.Command.Item,{callback:()=>{d.push(`/${c}/~/settings/access-groups`)},className:(0,j.clsx)(W.default.item),children:(0,s.jsx)("div",{className:"flex flex-1 items-center",children:(0,s.jsx)("div",{className:"flex flex-1 flex-col",children:(0,s.jsx)("p",{className:"text-copy-14",children:"Manage Access Groups"})})})})]})})})})]})}function U(e){let{accessGroups:l,commandProps:t,activeAccessGroupMap:i,setSelectedAccessGroups:a,children:n}=e;return(0,s.jsx)("div",{className:(0,j.clsx)(J.default.command,J.default.primary,W.default.command),children:(0,s.jsxs)(F.Command,{...t,children:[(0,s.jsxs)("div",{className:(0,j.clsx)("flex flex-row items-center justify-start flex-initial",J.default.input),children:[(0,s.jsx)(B.MagnifyingGlass,{color:"gray-500",size:20}),(0,s.jsx)(F.Command.Input,{placeholder:"Filter access groups"}),(0,s.jsx)(O.Kbd,{className:J.default.kbd,children:"Esc"})]}),(0,s.jsxs)(F.Command.List,{className:`${J.default.list} tailwind`,disableDynamicHeight:!0,emptyMessage:(0,s.jsx)(K,{onClear:()=>{t.setInputValue("")},prompt:t.inputValue}),children:[l?.map(e=>(0,s.jsx)(F.Command.Item,{callback:()=>{e.isDsyncManaged||a(function(){let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return s.includes(e.accessGroupId)?s.filter(s=>s!==e.accessGroupId):[...s,e.accessGroupId]})},className:(0,j.clsx)(W.default.item,e.role&&W.default.itemWithRole,e.isDsyncManaged&&"opacity-50"),disabled:e.isDsyncManaged,value:e.name,children:(0,s.jsxs)("div",{className:"flex flex-1 items-center gap-4",children:[(0,s.jsxs)("div",{className:"flex flex-1 flex-col",children:[(0,s.jsx)("p",{className:(0,j.clsx)("text-copy-14 max-w-52 truncate",e.isDsyncManaged?"text-gray-900":"text-gray-1000"),children:e.name}),e.role?(0,s.jsx)("p",{className:"text-copy-14 text-gray-900",children:_.projectRolesMap[e.role].label}):null]}),i[e.accessGroupId]?(0,s.jsx)($.Check,{size:20}):null,e.isDsyncManaged?(0,s.jsx)(S.LockClosed,{size:20}):null]})},e.accessGroupId)),n]})]})})}function H(e){let s={};if(!e)return s;for(let l of e)s[l]=!0;return s}function q(e,s){if(e.length!==s.length)return!1;for(let l of e)if(!s.includes(l))return!1;return!0}function K(e){let{onClear:l,prompt:t}=e;return(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center gap-3 flex-initial p-4",children:[(0,s.jsxs)("p",{className:"text-copy-14 flex-1",children:['No results for "',t,'"']}),(0,s.jsx)(i.Button,{onClick:l,size:"small",type:"secondary",children:"Clear search"})]})}function Y(e){let{value:l=[],isOpen:t,setIsOpen:a,onChange:r,accessGroupsData:o}=e,c=l.map(e=>e.accessGroupId);return(0,s.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[(0,s.jsxs)("div",{className:"flex flex-row items-center justify-start gap-1 flex-initial",children:[(0,s.jsx)("p",{className:"text-[16px] leading-[24px] font-medium",children:"Access Groups"}),(0,s.jsx)(Q,{accessGroupsData:o,isOpen:t,onChange:e=>{r(e)},setIsOpen:a,value:c})]}),l.length?(0,s.jsx)(d.Entity.List,{children:l.map(e=>(0,s.jsx)(d.Entity,{paddingY:2,right:(0,s.jsx)(n.Tooltip,{desktopOnly:!0,disableTriggers:!e.isDsyncManaged,text:"This Access Group is Dsync Managed",children:(0,s.jsx)(i.Button,{"aria-label":"Remove Access Group",disabled:e.isDsyncManaged,onClick:()=>{r(c.filter(s=>s!==e.accessGroupId))},shape:"square",size:"small",svgOnly:!0,type:"tertiary",children:e.isDsyncManaged?(0,s.jsx)(S.LockClosed,{}):(0,s.jsx)(w.MinusCircle,{size:16})})}),children:(0,s.jsx)(d.Entity.Content,{description:e.role?_.projectRolesMap[e.role].label:void 0,title:e.name})},e.accessGroupId))}):(0,s.jsx)("p",{className:"text-copy-14 text-gray-900",children:"No access groups selected."})]})}function X(e){let{accessGroupsData:l,isOpen:t,setIsOpen:i,value:a=[],onChange:n}=e,r=l.filter(e=>a.includes(e.accessGroupId));return(0,s.jsx)(Y,{accessGroupsData:l,isOpen:t,onChange:n,setIsOpen:i,value:r})}e.s(["AccessGroupsManageSticky",()=>X],9440850);var Z=e.i(5099572);function ee(e){let{member:a,project:A,onClose:P,onClearProject:w,revalidateSearch:S,revalidateAccessGroups:G,accessGroupsData:O}=e,D=!!a.joinedFrom?.dsyncUserId,{canHaveProjectRole:$,isValidRoleCombination:B,getDefaultProjectRole:k}=(0,b.useRoleUtils)(),[z,L]=(0,l.useState)(D||A?"PROJECT":"TEAM"),[F,V]=(0,l.useState)(!0),[J,W]=(0,l.useState)(!1),[Q,U]=(0,l.useState)(!1),{team:H}=(0,v.useTeam)(),q=(0,o.useToasts)(),[K,Y]=(0,l.useState)(!1),[ee,ei]=(0,l.useState)(null),[ea,en]=(0,l.useState)(a.role),[er,eo]=(0,l.useState)([...new Set([...a.teamRoles||[],a.role])]),[ec,ed]=(0,l.useState)(a.teamPermissions||[]),[em,eu]=(0,l.useState)(a.projects?.map(e=>({project:{id:e.id,name:e.name},role:e.role}))||[]),[ex,ep]=(0,l.useState)(a.accessGroups?.map(e=>String(e.id))||[]),{value:eh}=(0,E.useEntitlement)("multi-role-selector"),ej=em.filter(e=>e.project.id),ef=A?em.find(e=>e.project.id===A.id)?.role:void 0,eg=O?.filter(e=>ex.includes(e.accessGroupId)).map(e=>e.role)||[],ey=function(e){let s=!1,l=!1;for(let t of e){if("ADMIN"===t)return"ADMIN";"PROJECT_DEVELOPER"===t&&(s=!0),"PROJECT_VIEWER"===t&&(l=!0)}return s?"PROJECT_DEVELOPER":l?"PROJECT_VIEWER":void 0}(["DEVELOPER"===a.role?"PROJECT_DEVELOPER":void 0,ef,...eg]),{teamRoles:ev,teamPermissions:eb,simplifyRoles:eN}=(0,b.useAvailableRolesInfo)({showLegacyRoles:!0}),eE=N.v0Roles.filter(e=>a.teamPermissions?.includes(e)),eR=eb.filter(e=>e.compatibleRoles.some(e=>er.includes(e))||e.includedIn.some(e=>er.includes(e))),eT=ev.find(e=>e.role===ea),eI=ey?_.projectRolesMap[ey]:void 0,eC=(0,b.getRolesInfo)({teamRoles:er,teamPermissions:ec}),e_=(0,I.isHobby)(H);async function eA(){ei(null),Y(!0);let{teamRoles:e,teamPermissions:s}=eN(er,ec),l=[...new Set([...s,...eE])];try{await eM(),await S(s=>s?.map(s=>({...s,members:s.members.map(s=>s.uid!==a.uid?s:{...s,role:eh?e[0]:ea,teamRoles:eh?e:void 0,teamPermissions:eh?l:void 0,projects:ej.map(e=>({id:e.project.id,name:e.project.name,role:e.role})),accessGroups:ex.map(e=>({id:e,name:O?.find(s=>s.accessGroupId===e)?.name}))})})),{revalidate:!1}),await G(),V(!1),q.success("User access has been updated.")}catch(e){ei(e)}Y(!1)}async function eM(){if(!H||e_)return;let e=[];for(let s of em)e.push({projectId:s.project.id,role:s.role||null});for(let s of a.projects??[])em.some(e=>e.project.id===s.id)||e.push({projectId:s.id,role:null});let s=a.accessGroups?.map(e=>e.id)||[],l=ex.filter(e=>!s.includes(e)),t=s.filter(e=>A?!ex.includes(e)&&O?.find(s=>s.accessGroupId===e):!ex.includes(e)),{teamRoles:i,teamPermissions:n}=eN(er,ec),r=[...new Set([...n,...eE])],o=e.length>0,c=l.length>0||t.length>0,d=a.role!==ea,m=new Set(a.teamRoles).size!==new Set(i).size||a.teamRoles?.some(e=>!i.includes(e)),u=new Set(a.teamPermissions).size!==new Set(r).size||a.teamPermissions?.some(e=>!r.includes(e));if(o||c||d||m||u)return(0,g.fetchAPI)(`${y.API_TEAMS_MEMBERS}/${H.id}/members/${a.uid}`,{body:JSON.stringify({role:eh?void 0:ea,teamRoles:eh?i:void 0,teamPermissions:eh?r:void 0,projects:$(ea)?e:void 0,accessGroupsToAdd:c?l:void 0,accessGroupsToRemove:c?t:void 0}),method:"PATCH",throwOnHTTPError:!0})}let eP=k(ea),ew=ej.filter(e=>$(ea)&&eP&&!B(ea,e.role??eP)),eS=ew.length>0,eG=!eS&&(er.length>0||!eh),eO=function(e){let{selectedTeamRole:s,projectCount:l,accessGroupCount:t}=e;if(0===l&&0===t)return"DEVELOPER"===s?"Optionally you can assign Project Admin roles":"No project role has been assigned";let i=[l>0?`${l} project role${1===l?"":"s"}`:null,t>0?`${t} access group${1===t?"":"s"}`:null].filter(Boolean).join(" and "),a=`${l+t>1?"have":"has"} been assigned`;return`${i} ${a}`}({selectedTeamRole:ea,projectCount:ej.length,accessGroupCount:ex.length}),{value:eD}=(0,E.useEntitlement)("v0-team-seats"),e$=a.entitlements?.some(e=>"v0"===e.entitlement),eB=eD&&H?.billing?.plan!=="enterprise",ek=(0,s.jsx)(i.Button,{align:"start",className:"tailwind-preflight",onClick:()=>{L("PROJECT")},size:"small",suffix:(0,s.jsx)(p.SettingsGear,{}),type:eS?"warning":"secondary",children:(0,s.jsxs)("div",{className:"flex flex-row items-center justify-stretch gap-2 flex-initial w-full",children:[(0,s.jsx)(C.ProjectAvatarGroup,{projectIds:ej.map(e=>e.project.id).filter(es)}),eS?(0,s.jsxs)("p",{className:"text-copy-14 text-inherit flex-1",children:[ew.length," project"," ",1===ew.length?"role is":"roles are"," ","unavailable"]}):(0,s.jsx)("p",{className:(0,j.clsx)("text-copy-14 flex-1",ej.length?"text-gray-1000":"text-gray-900"),children:eO})]})}),ez=(0,s.jsx)(i.Button,{align:"start",className:"tailwind-preflight",disabled:!0,size:"small",type:"warning",children:(0,s.jsxs)("div",{className:"flex flex-row items-center justify-stretch gap-2 flex-initial w-full",children:[(0,s.jsx)(C.ProjectAvatarGroup,{projectIds:a.projects?.map(e=>e.id)}),(0,s.jsxs)("p",{className:"text-copy-14",children:[a.projects?.length," project"," ",a.projects?.length===1?"role":"roles"," will be removed"]})]})}),eL=$(ea)?(0,s.jsx)(s.Fragment,{children:ek}):(0,s.jsx)(s.Fragment,{children:a.projects?.length?ez:null}),eF=(0,s.jsx)(i.Button,{align:"start",className:"w-full",disabled:!eG,onClick:()=>{L("PROJECT")},size:"small",suffix:(0,s.jsx)(p.SettingsGear,{}),type:eS?"warning":"secondary",children:(0,s.jsxs)("div",{className:"flex flex-row items-center justify-stretch gap-2 flex-initial w-full",children:[(0,s.jsx)(C.ProjectAvatarGroup,{projectIds:ej.map(e=>e.project.id).filter(es)}),eS?(0,s.jsxs)("p",{className:"text-copy-14 text-inherit flex-1",children:[ew.length," project"," ",1===ew.length?"role is":"roles are"," ","unavailable"]}):(0,s.jsx)("p",{className:(0,j.clsx)("text-copy-14 flex-1",ej.length?"text-gray-1000":"text-gray-900"),children:function(e){let{projectCount:s,accessGroupCount:l}=e;if(0===s&&0===l)return"Manage project access and additional permissions";let t=[s>0?`${s} project role${1===s?"":"s"}`:null,l>0?`${l} access group${1===l?"":"s"}`:null].filter(Boolean).join(" and "),i=`${s+l>1?"have":"has"} been assigned`;return`${t} ${i}`}({projectCount:ej.length,accessGroupCount:ex.length})})]})}),eV=eR.map(e=>{let s=e.includedIn.find(e=>er.includes(e));return{checked:!!s||ec.includes(e.role),disabled:!!(s||D),permission:e,includedIn:s}}),eJ=eV.some(e=>e.checked),eW=!D||eJ;return(0,s.jsxs)(r.Modal.Modal,{active:F,disableFocusTrap:!0,onAnimationDone:()=>{Y(!1),ei(null),P()},onClickOutside:e=>{J||Q||e?.target instanceof HTMLElement&&e.target.closest("[data-geist-menu-item]")||V(!1)},children:[(0,s.jsxs)(r.Modal.Body,{className:"tailwind-preflight",padding:0,children:[(0,s.jsxs)("div",{className:"flex flex-col gap-1 px-6 pb-5 pt-6",children:[(0,s.jsx)(r.Modal.Title,{children:A?"Manage Project Access":"Manage Team Access"}),(0,s.jsx)(r.Modal.Subtitle,{children:(0,s.jsxs)("div",{className:"flex flex-row items-center justify-start gap-1 flex-initial",children:[(0,s.jsx)("span",{className:"text-copy-14 text-gray-900",children:"Manage the roles "}),(0,s.jsxs)("div",{className:"flex content-center gap-1",children:[(0,s.jsx)(t.Avatar,{size:20,username:a.username}),(0,s.jsx)("span",{className:"text-[14px] leading-[20px] font-medium",children:a.name||a.username})]}),(0,s.jsx)("span",{className:"text-copy-14 text-gray-900",children:" has for "}),A?(0,s.jsxs)("div",{className:"flex content-center gap-1",children:[(0,s.jsx)(R.ProjectAvatar,{project:A,size:16}),(0,s.jsx)("span",{className:"text-[14px] leading-[20px] font-medium",children:A.name})]}):(0,s.jsxs)("div",{className:"flex content-center gap-1",children:[(0,s.jsx)(t.Avatar,{size:20,teamId:H?.id}),(0,s.jsx)("span",{className:"text-[14px] leading-[20px] font-medium",children:H?.name||"this team"})]})]})})]}),"TEAM"!==z&&A?(0,s.jsx)("div",{className:"flex flex-col items-stretch justify-start flex-initial px-6",children:(0,s.jsx)(d.Entity.List,{children:(0,s.jsx)(d.Entity,{paddingY:3,right:(0,s.jsxs)(s.Fragment,{children:[ef&&ey!==ef?(0,s.jsx)(n.Tooltip,{delayTime:300,position:"top",text:"An access group has overrided the selected project role.",children:(0,s.jsx)(x.StopFill,{color:"amber-900"})}):null,(0,s.jsx)(n.Tooltip,{delayTime:300,disableTriggers:!D,position:"bottom",text:M,children:(0,s.jsx)(i.Button,{className:Z.default.editButton,disabled:D,onClick:()=>{L("TEAM"),w?.()},size:"small",type:"secondary",children:"Edit"})})]}),children:eT?(0,s.jsx)(d.Entity.Content,{description:eT.label,fill:!0,title:eI?.label||"No access"}):null})})}):null,"TEAM"===z||A?null:(0,s.jsx)("div",{className:"flex flex-col items-stretch justify-start flex-initial px-6",children:(0,s.jsx)(d.Entity.List,{children:(0,s.jsx)(d.Entity,{paddingY:3,right:(0,s.jsx)(n.Tooltip,{delayTime:300,disableTriggers:!D,position:"bottom",text:M,children:(0,s.jsx)(i.Button,{className:Z.default.editButton,disabled:D,onClick:()=>{L("TEAM"),w?.()},size:"small",type:"secondary",children:"Edit"})}),children:eT?(0,s.jsx)(d.Entity.Content,{description:eC.teamRoles.map(e=>e.description).join(", "),fill:!0,title:eC.teamRoles.map(e=>e.label).join(", ")}):null})})}),"TEAM"===z&&eh?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(et,{disableRoles:{VIEWER:{disabled:!!(!e$&&eB&&1),message:"Requires a v0 seat."}},onChange:e=>{eo(e)},value:er}),(0,s.jsx)("div",{className:"w-full border-t border-gray-200 bg-gray-100/50 px-6 py-3",children:eF})]}):null,"TEAM"!==z||eh?null:(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(el,{disableRoles:{VIEWER:{disabled:!!(!e$&&eB&&1),message:"Requires a v0 seat."}},onChange:e=>{en(e)},persistedRole:a.role,projectRolesInfo:eL,value:ea})}),"PROJECT"===z&&eh&&eW?(0,s.jsxs)("div",{className:"flex flex-col gap-2 px-6 pt-4",children:[(0,s.jsx)("p",{className:"text-[16px] leading-[24px] font-medium",children:"Team Permissions"}),eV.map(e=>{let{permission:l,checked:t,disabled:i,includedIn:a}=e,r=l.includedIn.find(e=>er.includes(e)),o=[a&&`Already included in the ${r} role.`,D&&"This user permissions are managed by Directory Sync."].filter(Boolean).join("\n\n");return D&&!t?null:(0,s.jsxs)("div",{className:"flex gap-1",children:[(0,s.jsx)(n.Tooltip,{delayTime:300,disableTriggers:!i,position:"left",text:o,children:(0,s.jsx)(u.Checkbox,{checked:t,disabled:i,className:i?"text-gray-900":"",onChange:()=>{ec.includes(l.role)?ed(ec.filter(e=>e!==l.role)):ed([...ec,l.role])},children:l.label})}),l.description?(0,s.jsx)(n.Tooltip,{text:l.description,children:(0,s.jsx)(h.InformationFillSmall,{color:"gray-900",size:16})}):null]},l.role)})]}):null,"PROJECT"===z?(0,s.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-6 flex-initial p-6",children:[A?(0,s.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[(0,s.jsx)("p",{className:"text-[16px] leading-[24px] font-medium",children:"Project Role"}),(0,s.jsx)(_.ProjectRoleSelector,{allowSelectNoRole:!0,menuButtonWidth:170,menuWidth:"100%",onChange:e=>{let s=em.filter(e=>e.project.id!==A.id);"UNDEFINED"!==e&&s.push({project:{id:A.id,name:A.name},role:e}),eu(s)},teamRole:ea,value:ef||"UNDEFINED"})]}):(0,s.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[eS?(0,s.jsx)(c.Note,{fill:!0,type:"error",children:"Some selected Project Roles are not available for the Developer role and should be updated or removed."}):null,(0,s.jsx)(T.ProjectMultiselect,{isOpen:Q,onSetProjectRoles:eu,projectRoles:em,setIsOpen:U,teamRole:"CONTRIBUTOR"})]}),O?(0,s.jsx)(X,{accessGroupsData:O,isOpen:J,onChange:e=>{ep(e)},setIsOpen:W,value:ex}):null,ee?(0,s.jsx)("div",{className:"p-4",children:(0,s.jsx)(m.Error,{error:ee})}):null]}):null,"TEAM"===z&&ee?(0,s.jsx)("div",{className:"p-4",children:(0,s.jsx)(m.Error,{error:ee})}):null]}),(0,s.jsxs)(r.Modal.Actions,{children:[(0,s.jsx)(r.Modal.Action,{onClick:()=>V(!1),type:"secondary",children:"Cancel"}),(0,s.jsx)(n.Tooltip,{delayTime:300,disableTriggers:!eS,position:"top",text:"Some project roles are unavailable.",children:(0,s.jsx)(r.Modal.Action,{"data-testid":(0,f.tid)("members","manage-role-modal","save-button"),disabled:e_||!eG,loading:K,onClick:eA,children:"Save Changes"})})]})]})}function es(e){return null!=e}function el(e){let{value:l,onChange:t,projectRolesInfo:i,persistedRole:n,disableRoles:r}=e,{canHaveProjectRole:o}=(0,b.useRoleUtils)(),{teamRoles:c}=(0,b.useAvailableRolesInfo)({showLegacyRoles:"VIEWER"===n});return(0,s.jsx)(a.RadioGroup,{label:"Project Role Select",onChange:e=>{t(e)},value:l,children:c.map(e=>{let t=o(l)&&e.role===l,c=!o(l)&&e.role===n,d=r?.[e.role]?.disabled,m=r?.[e.role]?.message;return(0,s.jsx)(a.RadioGroup.Item,{className:(0,j.clsx)("tailwind",Z.default.radioGroupItem,l===e.role&&Z.default.selectedItem),disabled:d,fullWidth:!0,value:e.role,children:(0,s.jsx)("div",{"data-testid":(0,f.tid)("members","manage-role-modal","role-option",String(e.role)),className:(0,j.clsx)("flex flex-row items-center justify-stretch flex-initial",d?"opacity-50":""),children:(0,s.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-1",children:[(0,s.jsxs)("div",{className:"flex flex-col items-stretch justify-start flex-initial",children:[(0,s.jsx)("p",{className:"text-[14px] leading-[20px] font-medium",children:e.label}),(0,s.jsxs)("p",{className:"text-copy-14 text-gray-900",children:[e.description,d?`. ${m} `:null]})]}),t||c?i:null]})})},e.role)})})}function et(e){let{value:l,onChange:t,disableRoles:i}=e,{teamRoles:a}=(0,b.useAvailableRolesInfo)();return(0,s.jsx)(s.Fragment,{children:a.map(e=>{let r=e.role,o=i?.[r]?.disabled,c=i?.[r]?.message,d=l.find(e=>{let s=a.find(s=>s.role===e);return!!s&&s.includedTeamRoles.includes(r)});return(0,s.jsx)(n.Tooltip,{className:"w-full",delayTime:300,disableTriggers:!d,forceHide:!d,position:"left",text:`Already included in the ${d} role.`,children:(0,s.jsx)(u.Checkbox,{checked:!!d||l.includes(r),className:(0,j.clsx)("w-full border-t border-gray-200 px-6 py-3",l.includes(r)&&!d&&"bg-gray-100/50"),disabled:!!d||o,fullWidth:!0,onChange:()=>{l.includes(r)?t(l.filter(e=>e!==r)):t([...l,r])},value:r,children:(0,s.jsxs)("div",{className:"",children:[(0,s.jsx)("p",{className:"text-[14px] leading-[20px] font-medium",children:e.label}),(0,s.jsxs)("p",{className:"text-copy-14 text-gray-900",children:[e.description,o?`. ${c} `:null]})]})})},r)})})}function ei(e){return e.entitlements?e.entitlements.filter(e=>e.hasDirectAssignation).map(e=>e.entitlement):[]}async function ea(e){let{userId:s,teamId:l,existingEntitlements:t,newEntitlements:i}=e,a=i.filter(e=>!t.includes(e)),n=t.filter(e=>!i.includes(e));for(let e of a)await (0,g.fetchAPI)(`${y.API_TEAMS_MEMBERS}/${l}/members/${s}/entitlement?teamId=${l}`,{body:JSON.stringify({entitlement:e}),method:"POST",throwOnHTTPError:!0});for(let e of n)await (0,g.fetchAPI)(`${y.API_TEAMS_MEMBERS}/${l}/members/${s}/entitlement?teamId=${l}`,{body:JSON.stringify({entitlement:e}),method:"DELETE",throwOnHTTPError:!0})}e.s(["ManageRoleModal",()=>ee,"changeEntitlements",()=>ea,"getDirectEntitlementArray",()=>ei,"isTruthy",()=>es],8786464);var en=e.i(5585544),er=e.i(9068678),eo=e.i(6060673),ec=e.i(5056988);let ed={PROJECT_VIEWER:"Viewer",PROJECT_DEVELOPER:"Developer",ADMIN:"Admin"};function em(e){let{projectAccess:t,config:i={expanded:!1}}=e,{expanded:a}=i,r=t.projects?t.projects.map(e=>e.id).filter(Boolean):[],{accessGroups:o}=t,c=t.projects?.reduce((e,s)=>{if(!s.id)return e;let l=ed[s.role];return{...e,[s.id]:l}},{}),{data:d,isLoading:m}=(0,eo.useProjects)(r.length?r:[]);if(!r.length&&!o?.length)return null;let u=o?.length??0,x=r.length>4?3:r.length,p=r.length-x+(a?0:u);if(!d&&!u||m)return(0,s.jsxs)("div",{className:"flex flex-row items-stretch justify-start flex-initial",children:[r.slice(0,x).map(e=>(0,s.jsx)("div",{className:ec.default.placeholder},e)),p?(0,s.jsxs)("div",{className:ec.default.placeholder,children:["+",p]}):null]});let j=u>1?`${u} access groups`:o?.[0]?.name;return(0,s.jsxs)(s.Fragment,{children:[a&&o?.length?(0,s.jsxs)("div",{className:"flex flex-row items-center justify-start gap-0.5 flex-initial tailwind-preflight",children:[(0,s.jsx)("p",{className:"text-copy-14 text-gray-900 max-w-32 truncate",children:j}),(0,s.jsx)(n.Tooltip,{text:(0,s.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-1 flex-initial",children:[(0,s.jsx)("p",{className:"text-heading-14 text-left",children:"Access Groups"}),o.map(e=>(0,s.jsx)("p",{className:"text-copy-14 text-left geist-ellipsis",title:e.name,children:e.name},e.name))]}),children:(0,s.jsx)(h.InformationFillSmall,{color:"gray-900",size:16})})]}):null,(0,s.jsx)(n.Tooltip,{text:(0,s.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial tailwind-preflight max-h-[195px] overflow-auto pl-1",children:[d?.length?(0,s.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-1 flex-initial",children:[(0,s.jsx)("p",{className:"text-heading-14 text-left",children:"Project Roles"}),d.map(e=>(0,s.jsx)(l.Fragment,{children:(0,s.jsxs)("div",{className:"flex flex-row items-center justify-start gap-2 flex-initial",children:[(0,s.jsx)(er.ProjectWithDeploymentAvatar,{project:e,size:16}),(0,s.jsx)("p",{className:"text-copy-14 text-left geist-ellipsis flex-1",title:e.name,children:e.name}),c?.[e.id]?(0,s.jsx)("p",{className:"text-copy-14 whitespace-nowrap",children:c[e.id]}):null]})},e.id))]}):null,!a&&o?.length?(0,s.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-1 flex-initial",children:[(0,s.jsx)("p",{className:"text-heading-14 text-left",children:"Access Groups"}),o.map(e=>(0,s.jsx)("p",{className:"text-copy-14 text-left geist-ellipsis",title:e.name,children:e.name},e.name))]}):null]}),children:(0,s.jsxs)("div",{className:"flex flex-row items-stretch justify-start flex-initial",children:[d?.slice(0,x).map(e=>(0,s.jsx)(er.ProjectWithDeploymentAvatar,{className:ec.default.projectAvatar,project:e,size:20,title:e.name},e.id)),p?(0,s.jsx)("div",{className:ec.default.placeholder,children:d?`+${p}`:(0,s.jsx)(en.Users,{className:ec.default.placeholderIcon,color:"gray-900",size:12})}):null]})})]})}e.s(["ProjectAccessBadges",()=>em],1521964)}]);

//# debugId=ef43988b-09b0-ab6d-971d-4205bb320619
//# sourceMappingURL=27d5685ffa72a093.js.map