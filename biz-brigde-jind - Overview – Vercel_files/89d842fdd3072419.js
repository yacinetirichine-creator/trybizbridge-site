;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="37a84b8f-da83-7991-ff93-4325d2dc5af7")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,6671454,e=>{"use strict";var t=e.i(1146226),i=e.i(5169864),a=e.i(5169576),n=e.i(2504781),l=e.i(8161149),s=e.i(119294),r=e.i(6352514),o=e.i(5338940),c=e.i(57106),d=e.i(4004502),u=e.i(4011256),h=e.i(1017032),x=e.i(7594446),m=e.i(8087728),p=e.i(5669250),g=e.i(7759431),f=e.i(8573953),j=e.i(2486836),y=e.i(3748432);function b(e){let{teamSlug:i,configurations:n,testIdPrefix:s}=e,{team:r}=(0,o.useTeam)(),{data:d}=(0,h.useConfigurations)({skipBillingData:!0}),x=(0,m.useInstalledIntegrationsFilters)({integrationInstallations:d??n});return 0===n.length?(0,t.jsx)(t.Fragment,{children:(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start gap-5 flex-1 w-full",children:(0,t.jsx)(l.EmptyState.Root,{className:g.default.emptyState,description:"You don't have any integration installed.",icon:(0,t.jsx)(l.EmptyState.Icon,{icon:(0,t.jsx)(a.Information,{size:32})}),secondary:!0,title:"No Integrations Installed",children:(0,t.jsx)(c.ButtonLink,{href:(0,u.getBrowseMarketplaceLink)({teamSlugOrPublic:{teamSlug:i}}),type:"secondary",children:"Browse Marketplace"})})})}):(0,t.jsx)(N,{installationsWithFilters:x,team:r,teamSlug:i,testIdPrefix:s})}function v(e){let{externalCounter:i}=e;return(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start gap-20 flex-1 w-full",children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-5 flex-initial",children:[(0,t.jsx)(m.InstalledIntegrationsFiltersPlaceholder,{}),(0,t.jsx)("div",{className:g.default.integrationList,children:Array.from({length:i??3}).map((e,i)=>(0,t.jsx)(p.MarketplaceInstallationCardPlaceholder,{},`marketplace${i}`))})]})})}function N(e){let{teamSlug:o,team:c,installationsWithFilters:h,testIdPrefix:b}=e,{installationsByIntegration:v,legacyInstallations:N,search:C,onSearchChanged:I,onCategoryChanged:k,category:w,categories:T,onLoadNextPage:S,hasMorePages:A,installationType:P,onInstallationTypeChanged:M}=h,{isLoading:L,canCreateIntegrationConfiguration:_}=(0,x.useIntegrationPermissions)(),[R,E]=(0,i.useState)({active:!1,team:null}),D=e=>{let{id:t,slug:i}=e;s.analytics.track(r.AnalyticsEvent.INTEGRATION_OVERVIEW_MANAGE_CLICKED,{integration:{id:t,slug:i}})},O=(0,i.useCallback)(e=>E({active:!0,...e}),[]),F=(0,i.useCallback)(()=>E({...R,active:!1}),[R]);return(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-20 flex-1 w-full",children:[(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-5 flex-initial",children:[(0,t.jsx)(m.InstalledIntegrationsFilters,{categories:T,category:w,installationType:P,onCategoryChanged:k,onInstallationTypeChanged:M,onSearchChanged:I,search:C,searchInputTestId:b?(0,d.tid)(b,"search-input"):void 0}),v.length>0?(0,t.jsxs)("div",{className:g.default.integrationList,children:[(0,t.jsx)(f.ReinstallationModal,{onCancel:F,state:R}),v.map((e,i)=>{let a=function(e,t,i,a){if(a&&!i&&1===e.installations.length){let i=e.installations[0].id;return"scopes-review"===e.requiredAction?(0,u.getPermissionsLink)({teamSlug:t,configurationId:i}):(0,u.getInstallationDetailsLink)({teamSlug:t,configurationId:i,integrationSlug:e.slug,isMarketplace:e.isMarketplace})}return(0,u.getIntegrationDetailsLink)({integrationSlug:e.slug,teamSlugOrPublic:{teamSlug:t},installationHash:!0})}(e,o,L,_);return(0,t.jsx)(y.ConditionalNavigationMarker,{enabled:0===i,phase:"content",label:"MarketplaceInstalledIntegrationsContent",children:(0,t.jsx)(p.InstallationCard,{integrationWithInstallations:e,link:a,testId:b?(0,d.tid)(b,"entity",e.integrationId):void 0,onClick:()=>{switch(e.requiredAction){case"reinstall-log-drain":case"reinstall-log-drain-admin":O({configuration:{integrationId:e.integrationId,name:e.name,slug:e.slug,id:e.installations[0].id},team:c});break;default:D({id:e.integrationId,slug:e.slug})}}})},e.integrationId)})]}):(0,t.jsx)(l.EmptyState.Root,{className:g.default.emptyState,description:C?`Your search for "${C}" did not return any results.`:void 0,icon:(0,t.jsx)(l.EmptyState.Icon,{icon:(0,t.jsx)(a.Information,{size:32})}),secondary:!0,title:"No Results Found"}),A?(0,t.jsx)(n.Button,{onClick:S,type:"secondary",children:"Show More"}):null]}),N.length>0?(0,t.jsx)(j.LegacyIntegrations,{legacyInstallations:N,onCardClicked:D,teamSlug:o}):null]})}e.s(["InstalledIntegrations",()=>b,"MarketplaceInstalledIntegrationsPlaceholder",()=>v])},3999030,e=>{"use strict";var t=e.i(1146226),i=e.i(5169864),a=e.i(5255926),n=e.i(2504781),l=e.i(5610834),s=e.i(8544664);e.i(5628754);var r=e.i(9203481);e.i(5463680);var o=e.i(15312);e.i(553769);var c=e.i(3758860);e.i(6887680);var d=e.i(6810699),u=e.i(1909206),h=e.i(2483928),x=e.i(6315360),m=e.i(8525850),p=e.i(7594446),g=e.i(2704354);function f(e){let[a,n]=(0,i.useState)(4),l=e.integration,s=("products"in l?l.products:void 0)||[],{data:u}=(0,d.useResourceList)({integrationIdOrSlug:l.slug,integrationConfigurationId:e.configuration.id,skipMetadata:!0,fallbackData:e.resourcesData?{stores:e.resourcesData}:void 0}),h=(u?.stores?.length??0)>a,{isLoading:f,canCreateIntegrationConfiguration:y}=(0,p.useIntegrationPermissions)(),v=f||!y,C="single-product"===l.layout,I=u?.stores?.filter(t=>t.product.integrationConfigurationId===e.configuration?.id),k=I?.slice(0,a);return(I?.length===0||e.teamSlugOrPublic.isPublic)&&e.renderAllIntegrationProducts&&"products"in l&&(0,g.isMarketplaceIntegration)(l)?(0,t.jsx)(N,{title:`Products by ${l.createdBy}`,integration:l,products:s,teamSlugOrPublic:e.teamSlugOrPublic,disabled:e.disabled||!!e.configuration?.deleteRequestedAt,allowInstallation:!v,enableMarketplaceNewCheckout:e.enableMarketplaceNewCheckout||!1,configuration:e.configuration}):C?null:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-10 flex-initial",children:[I?(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-5 flex-initial",children:[(0,t.jsx)("p",{className:"text-heading-20",children:e.label}),(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:[(0,t.jsx)("div",{className:x.default.marketplaceDetailsProductsGrid,children:k?.map(i=>(0,t.jsx)(o.ResourceModalsProvider,{protocolType:(0,c.getPrimaryProtocolByProduct)(i.product),children:(0,t.jsx)(r.ResourceItem,{item:i,resourceLinkFunc:()=>(0,m.getResourceDetailsPath)(i,e.teamSlugOrPublic.teamSlug??""),showCreatedAt:!1})},i.id))}),h?(0,t.jsx)(j,{onClick:function(){n(a+4)}}):null]})]})}):(0,t.jsx)(b,{}),e.renderAllIntegrationProducts&&"products"in l&&(0,g.isMarketplaceIntegration)(l)?(0,t.jsx)(N,{configuration:e.configuration,title:"More Products",integration:l,products:s,teamSlugOrPublic:e.teamSlugOrPublic,disabled:e.disabled||!!e.configuration?.deleteRequestedAt,allowInstallation:!v,enableMarketplaceNewCheckout:e.enableMarketplaceNewCheckout||!1}):null]})}function j(e){return(0,t.jsx)(n.Button,{onClick:()=>{window.requestAnimationFrame(e.onClick)},type:"secondary",children:"Load More"})}function y(){let e=(0,l.useParams)();return(0,s.usePlaceholderCount)(`installed-products:${e?.teamSlug}-${e?.slug}`,void 0)?(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-10 flex-initial",children:[(0,t.jsx)(b,{}),(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-5 flex-initial",children:[(0,t.jsx)("p",{className:"text-heading-20",children:"More Products"}),(0,t.jsx)(v,{count:1,hasAvatar:!1,hasTitle:!0})]})]}):(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-5 flex-initial",children:[(0,t.jsx)("p",{className:"text-heading-20",children:(0,t.jsx)(a.Skeleton,{width:200})}),(0,t.jsx)(v,{count:4,hasAvatar:!1,hasTitle:!1}),(0,t.jsx)("div",{className:"h-[200px]"})]})}function b(){let e=(0,l.useParams)(),i=(0,s.usePlaceholderCount)(`installed-products:${e?.teamSlug}-${e?.slug}`,void 0);return i?(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-5 flex-initial",children:[(0,t.jsx)("p",{className:"text-heading-20",children:"Installed Products"}),(0,t.jsx)(v,{count:Math.min(i,4),hasAvatar:!0,hasTitle:!0}),i&&i>4?(0,t.jsx)("div",{className:"h-[40px]"}):null]}):null}function v(e){return(0,t.jsx)("div",{className:x.default.marketplaceDetailsProductsGrid,children:Array.from({length:e.count}).map((i,a)=>(0,t.jsx)(h.MarketplaceProductDetailsCardPlaceholder,{hasAvatar:e.hasAvatar,hasTitle:e.hasTitle},`product${a}`))})}function N(e){return(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-5 flex-initial",children:[(0,t.jsx)("p",{className:"text-heading-20",children:e.title}),(0,t.jsx)(u.InstallMarketplaceProductProvider,{configuration:e.configuration,teamSlugOrPublic:e.teamSlugOrPublic,displayModalsInline:!1,children:(0,t.jsx)("div",{className:x.default.marketplaceDetailsProductsGrid,children:e.products.map(i=>(0,t.jsx)(h.MarketplaceProductDetailsCard,{configuration:e.configuration,disabled:!e.allowInstallation||e.disabled,hasAvatar:!0,integration:e.integration,product:i,teamSlugOrPublic:e.teamSlugOrPublic,enableMarketplaceNewCheckout:e.enableMarketplaceNewCheckout,tooltip:e.allowInstallation?void 0:"You don't have permission to install this product"},i.id))})})]})}e.s(["MarketplaceDetailsProducts",()=>f,"ProductsOrResourcesPlaceholder",()=>y])},3690352,e=>{e.v({button:"integration-video-player-module__Gy_CcG__button",loading:"integration-video-player-module__Gy_CcG__loading",play:"integration-video-player-module__Gy_CcG__play","play-icon":"integration-video-player-module__Gy_CcG__play-icon",player:"integration-video-player-module__Gy_CcG__player"})},8447345,e=>{e.v({gallery:"details-gallery-module__uxYlVW__gallery",grayscale:"details-gallery-module__uxYlVW__grayscale",image:"details-gallery-module__uxYlVW__image","image-skeleton":"details-gallery-module__uxYlVW__image-skeleton","image-wrapper":"details-gallery-module__uxYlVW__image-wrapper",wrapper:"details-gallery-module__uxYlVW__wrapper"})},2434652,e=>{"use strict";var t=e.i(1146226),i=e.i(5255926),a=e.i(9739627),n=e.i(5169864);let l=(0,e.i(9334638).withNewIcon)('<path fill-rule="evenodd" clip-rule="evenodd" d="M13.4549 7.22745L13.3229 7.16146L2.5 1.74999L2.4583 1.72914L1.80902 1.4045L1.3618 1.18089C1.19558 1.09778 1 1.21865 1 1.4045L1 1.9045L1 2.63041L1 2.67704L1 13.3229L1 13.3696L1 14.0955L1 14.5955C1 14.7813 1.19558 14.9022 1.3618 14.8191L1.80902 14.5955L2.4583 14.2708L2.5 14.25L13.3229 8.83852L13.4549 8.77253L14.2546 8.37267L14.5528 8.2236C14.737 8.13147 14.737 7.86851 14.5528 7.77638L14.2546 7.62731L13.4549 7.22745ZM11.6459 7.99999L2.5 3.42704L2.5 12.5729L11.6459 7.99999Z" fill="currentColor"/>');var s=e.i(8735244),r=e.i(6891161),o=e.i(3690352);function c(e){let{videoId:i}=e,[a,c,d]=(()=>{let[e,t]=(0,n.useState)(!1);return[e,(0,n.useCallback)(()=>t(!0),[]),(0,n.useCallback)(()=>t(!1),[])]})(),[u,h]=(0,n.useState)(!0);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{className:o.default.button,onClick:c,type:"button",children:(0,t.jsx)("div",{className:o.default.play,children:(0,t.jsx)("div",{className:o.default["play-icon"],children:(0,t.jsx)(l,{})})})}),(0,t.jsx)(r.Modal.Modal,{active:a,drawer:!1,onClickOutside:d,width:"80vw",children:(0,t.jsxs)("div",{className:o.default.player,children:[u?(0,t.jsx)("div",{className:o.default.loading,children:(0,t.jsx)(s.Spinner,{size:64})}):null,(0,t.jsx)("iframe",{allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,frameBorder:"0",height:"100%",onLoad:()=>h(!1),referrerPolicy:"no-referrer",src:`https://www.youtube.com/embed/${i}`,title:"Integration video player",width:"100%"})]})})]})}function d(e){let{src:i}=e,a=i.startsWith("https://img.youtube.com/vi/")?(i.split("https://img.youtube.com/vi/").pop()||"").split("/0.jpg").shift():null;return a?(0,t.jsx)(c,{videoId:a}):null}var u=e.i(8447345),h=e.i(9722978);function x(e){let{images:n,grayscale:l}=e;return(0,t.jsx)("div",{className:u.default.gallery,children:(0,t.jsx)("div",{className:(0,h.default)("flex flex-row items-stretch justify-start gap-4 flex-initial",u.default.wrapper),style:{"--width":`${504*(n.length||1)}px`},children:0===n.length?(0,t.jsx)("div",{className:u.default["image-wrapper"],children:(0,t.jsx)("div",{className:u.default.image,children:(0,t.jsx)(i.Skeleton,{className:u.default["image-skeleton"],height:"var(--skeleton-height)",width:"var(--skeleton-width)"})})}):n.map((e,i)=>{let n="string"==typeof e?e:`https:${e.fields.file.url}`,s="string"==typeof e?"":e.fields.description,r={srcDark:n,srcLight:n,layout:"fill",objectFit:"cover",priority:i<=2};return(0,t.jsx)("div",{className:u.default["image-wrapper"],children:(0,t.jsx)("div",{className:u.default.image,children:"string"==typeof e?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d,{src:n}),(0,t.jsx)(a.Image,{...r,alt:s})]}):(0,t.jsx)(a.Image,{...r,alt:s,className:l?u.default.grayscale:void 0})})},n)})})})}e.s(["DetailsGallery",()=>x],2434652)},943709,e=>{"use strict";var t=e.i(1146226),i=e.i(5328446),a=e.i(4138437),n=e.i(2504781),l=e.i(6891161),s=e.i(455575),r=e.i(5169864),o=e.i(5338940),c=e.i(8797711),d=e.i(6111613),u=e.i(2333337),h=e.i(1914640),x=e.i(2452025);function m(e){let{configuration:i,billingPlan:a,header:n,onNext:s,onBack:r,cancelLabel:o}=e;return(0,t.jsx)(x.ModalWrapper,{SuccessAction:(0,t.jsx)(l.Modal.Action,{onClick:s,children:"Confirm"}),cancelLabel:o,header:n,onBack:r,children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:[(0,t.jsx)("p",{className:"text-[16px] leading-[24px] font-medium",children:"Billing Plan"}),(0,t.jsx)(h.ReadOnlyPanel,{title:"Selected Billing Plan",children:(0,t.jsx)(h.ReadOnlyBillingPlan,{billingPlan:a})})]})})}var p=e.i(5255926),g=e.i(9544652),f=e.i(8843717),j=e.i(4987761),y=e.i(7743427),b=e.i(9471356),v=e.i(9588822),N=e.i(57106);function C(e){let{integration:i,onAccept:a,onBack:n,cancelLabel:s}=e;return(0,t.jsx)(x.ModalWrapper,{SuccessAction:(0,t.jsx)(l.Modal.Action,{buttonType:"submit",onClick:()=>{let e=new Date().toISOString(),t={};i.eulaDocUri&&(t.eula=e),i.privacyDocUri&&(t.privacy=e),a(t)},children:"Accept and Continue"}),cancelLabel:s,header:(0,t.jsx)(x.ModalWrapperHeader,{title:"Accept Terms & Conditions",subtitle:"Please review the following policies."}),onBack:n,children:(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-1 flex-initial",children:[(0,t.jsx)("p",{children:'By clicking "Accept and Continue", you agree to:'}),(0,t.jsxs)("p",{className:"text-copy-14",children:[(0,t.jsx)("span",{className:"pr-1",children:"• "}),(0,t.jsx)(N.Link,{external:!0,href:"/legal/integration-marketplace-end-users-addendum",type:"primary",children:"Vercel Integration Marketplace End User Addendum"})]}),i.eulaDocUri?(0,t.jsxs)("p",{className:"text-copy-14",children:[(0,t.jsx)("span",{className:"pr-1",children:"• "}),(0,t.jsxs)(N.Link,{external:!0,href:i.eulaDocUri,type:"primary",children:[i.name," EULA"]})]}):null,i.privacyDocUri?(0,t.jsxs)("p",{className:"text-copy-14",children:[(0,t.jsx)("span",{className:"pr-1",children:"• "}),(0,t.jsxs)(N.Link,{external:!0,href:i.privacyDocUri,type:"primary",children:[i.name," Privacy Policy"]})]}):null]})})})}function I(e){let{configuration:i,transferRequest:a,onCancel:n,onDone:l}=e,s=(0,o.useTeam)(),{data:c,isLoading:d}=(0,y.useIntegration)(i.integrationId),u=s.team,h=s.isLoading||d,[x,m]=(0,r.useTransition)(),p=u&&c;return(0,t.jsx)(g.DisabledContext.Provider,{value:h||x,children:p?(0,t.jsx)(w,{configuration:i,transferRequest:a,team:u,integration:c,onCancel:n,onDone:l,isTransitioning:x,startTransition:m}):(0,t.jsx)(k,{cancelLabel:"Cancel",onBack:n})})}function k(e){let{onBack:i,cancelLabel:a}=e;return(0,t.jsx)(x.ModalWrapper,{SuccessAction:(0,t.jsx)(l.Modal.Action,{buttonType:"submit",disabled:!0,loading:!0,children:"..."}),cancelLabel:a,header:(0,t.jsx)(x.ModalWrapperHeader,{subtitle:(0,t.jsx)(p.Skeleton,{height:"20px",width:80}),title:"Transfer Your Account to Vercel"}),onBack:i,children:(0,t.jsx)(p.Skeleton,{height:"40px",width:400})})}let w=(0,v.withStripe)(function(e){let{configuration:i,transferRequest:a,team:n,integration:l,onCancel:s,onDone:o,isTransitioning:h,startTransition:p}=e,[g,y]=(0,r.useState)("policies"),[v,N]=(0,r.useState)({}),I=a.billingPlan,k=i.id,{data:w}=(0,f.useInstallationPaymentMethodState)({integrationConfigurationId:k}),{createAuthorization:T}=(0,j.useMarketplaceBillingAuthorizationApi)(),S=(0,j.useAwaitAuthorization)(),[A,P]=(0,r.useState)(null),[M,L]=(0,r.useState)(!1),[_,R]=(0,r.useState)(void 0),[E,D]=(0,r.useState)(!1),O=(0,t.jsx)(x.ModalWrapperHeader,{subtitle:(0,t.jsx)("span",{className:"flex flex-row items-center justify-start gap-1 flex-initial",children:i.name||i.slug}),title:"Transfer Your Account to Vercel"}),F=()=>{y("provisioning"),L(!1),R(void 0);let e=async()=>{try{let e=await T(n.id,{integrationIdOrSlug:i.integrationId,integrationConfigurationId:i.id,transferRequestId:a.requestId,billingPlanId:a.billingPlan.id,metadata:{},source:"marketplace"});if(P(e?.id??null),!e)throw Error("Authorization creation failed");let t=await S(n.id,e.id);if("succeeded"!==t.status)return;await (0,b.clientTypedFetchData)("/v1/integrations/installations/{integrationConfigurationId}/transfers/to-marketplace","post",{teamId:n.id,integrationConfigurationId:i.id},{requestId:a.requestId,authorizationId:e.id,acceptedPolicies:v}),L(!0)}catch(e){R("Failed to transfer account")}};p(()=>{e()})};switch(g){case"policies":return(0,t.jsx)(C,{integration:l,onAccept:e=>{N(e),y("confirm")},onBack:s,cancelLabel:"Cancel"});case"confirm":return(0,t.jsx)(m,{configuration:i,billingPlan:I,header:O,onNext:()=>{!w||(0,d.getIsPaymentMethodStepNeeded)(n,w,I)||E?y("payment-method"):F()},onBack:s,cancelLabel:"Cancel"});case"payment-method":return w?(0,t.jsx)(c.PaymentMethodStep,{header:O,installationId:k,onBack:()=>y("confirm"),onNext:()=>{D(!1),F()},paymentMethodState:w,requireNew:E,team:n}):null;case"provisioning":return(0,t.jsx)(u.ProvisioningStep,{authorizationId:A,complete:M,error:_,header:O,isTransitioning:!M||h,onBack:()=>y("payment-method"),onChangePaymentMethod:()=>{D(!0),y("payment-method")},onNext:()=>{p(()=>{o()})},successMessage:"Your account has been transferred successfully",teamId:n.id});default:return null}});var T=e.i(5610834),S=e.i(1509709),A=e.i(4011256);function P(e){let{integration:c,configurationId:d}=e,[u,h]=(0,r.useState)(!1),[x,m]=(0,r.useTransition)(),{data:p,mutate:g}=(0,i.default)(d),f=(0,s.useToasts)(),j=(0,T.useRouter)(),y=(0,o.useTeam)().team,v=p?.transferRequest;if(!p||v?.kind!=="transfer-to-marketplace")return null;let N=()=>{h(!1)},C=async()=>{try{await (0,b.clientTypedFetchData)("/v1/integrations/installations/{integrationConfigurationId}/transfers/discard","post",{teamId:y?.id,integrationConfigurationId:p.id},{requestId:v.requestId}),await g()}catch(e){(0,S.captureException)(e),f.error("Failed to discard transfer request. Please try again.")}};return(0,t.jsxs)("section",{className:"mx-auto my-0 max-w-[520px] rounded-lg p-4",children:[(0,t.jsxs)(a.Card,{border:!0,shadow:!0,className:"max-w-[600px] p-4",children:[(0,t.jsx)("p",{className:"text-heading-24",children:"Transfer your account from ACME to Vercel"}),(0,t.jsx)("p",{className:"text-copy-14",children:"All your resources will be transferred to Vercel. After the transfer is complete, your billing will be handled by Vercel and you’ll use their platform to manage your resources."}),(0,t.jsxs)("div",{className:"mt-4 flex gap-2",children:[(0,t.jsx)(n.Button,{onClick:()=>{C()},disabled:x,type:"secondary",children:"Discard"}),(0,t.jsx)(n.Button,{onClick:()=>{m(()=>{h(!0)})},loading:x,className:"ml-auto",children:"Proceed with transfer"})]})]}),(0,t.jsx)(l.Modal,{active:u,onClickOutside:N,children:(0,t.jsx)(I,{configuration:p,transferRequest:v,onDone:()=>{N(),j.replace((0,A.getIntegrationInstallationLink)(y?.slug||"",c.slug,p.id))},onCancel:N})})]})}e.s(["RequestTransferToVercelNotification",()=>P],943709)},417098,e=>{"use strict";var t=e.i(1146226),i=e.i(5328446),a=e.i(4138437),n=e.i(2504781),l=e.i(6891161),s=e.i(455575),r=e.i(5169864),o=e.i(5610834),c=e.i(5338940),d=e.i(9471356),u=e.i(1509709),h=e.i(2452025);function x(e){let{configuration:i,header:a,onNext:n,onBack:s,cancelLabel:r}=e;return(0,t.jsx)(h.ModalWrapper,{SuccessAction:(0,t.jsx)(l.Modal.Action,{onClick:n,children:"Confirm"}),cancelLabel:r,header:a,onBack:s,children:(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:(0,t.jsx)("p",{className:"text-[16px] leading-[24px] font-medium",children:"some information on the transfer"})})})}var m=e.i(5255926),p=e.i(9544652),g=e.i(8735244);function f(e){let{header:i,isTransitioning:a,onNext:n,onBack:s,complete:r,error:o}=e;return(0,t.jsx)(h.ModalWrapper,{SuccessAction:(0,t.jsx)(l.Modal.Action,{disabled:!r,loading:!r||a,onClick:n,children:r?"Done":"Processing"}),cancelLabel:"Back",disableCancel:!r,header:i,onBack:s,children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:[r?(0,t.jsx)("p",{className:"text-[14px] leading-[20px] font-medium",children:"Provisioning complete."}):(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-2 flex-initial",children:[(0,t.jsx)(g.Spinner,{size:16}),(0,t.jsx)("p",{className:"text-[16px] leading-[24px] font-medium",children:"Processing"})]}),o?(0,t.jsx)("p",{className:"text-copy-14",children:o}):null]})})}function j(e){let{configuration:i,transferRequest:a,onCancel:n,onDone:l}=e,s=(0,c.useTeam)(),o=s.team,d=s.isLoading,[u,h]=(0,r.useTransition)();return(0,t.jsx)(p.DisabledContext.Provider,{value:d||u,children:o?(0,t.jsx)(y,{configuration:i,transferRequest:a,team:o,onCancel:n,onDone:l,isTransitioning:u,startTransition:h}):(0,t.jsx)(b,{cancelLabel:"Cancel",onBack:n})})}function y(e){let{configuration:i,transferRequest:a,team:n,onCancel:l,onDone:s,isTransitioning:o,startTransition:c}=e,[u,m]=(0,r.useState)("confirm"),[p,g]=(0,r.useState)(!1),[j,y]=(0,r.useState)(void 0),b=(0,t.jsx)(h.ModalWrapperHeader,{subtitle:(0,t.jsx)("span",{className:"flex flex-row items-center justify-start gap-1 flex-initial",children:i.name||i.slug}),title:"Transfer Your Account from Vercel"});switch(u){case"confirm":return(0,t.jsx)(x,{configuration:i,header:b,onNext:()=>{m("processing"),g(!1),y(void 0);let e=async()=>{try{await (0,d.clientTypedFetchData)("/v1/integrations/installations/{integrationConfigurationId}/transfers/from-marketplace","post",{teamId:n.id,integrationConfigurationId:i.id},{requestId:a.requestId}),g(!0)}catch(e){y("Failed to transfer account")}};c(()=>{e()})},onBack:l,cancelLabel:"Cancel"});case"processing":return(0,t.jsx)(f,{header:b,isTransitioning:o,onNext:()=>{c(()=>{s()})},onBack:l,complete:p,error:j});default:return null}}function b(e){let{onBack:i,cancelLabel:a}=e;return(0,t.jsx)(h.ModalWrapper,{SuccessAction:(0,t.jsx)(l.Modal.Action,{buttonType:"submit",disabled:!0,loading:!0,children:"..."}),cancelLabel:a,header:(0,t.jsx)(h.ModalWrapperHeader,{subtitle:(0,t.jsx)(m.Skeleton,{height:"20px",width:80}),title:"Transfer Your Account from Vercel"}),onBack:i,children:(0,t.jsx)(m.Skeleton,{height:"40px",width:400})})}function v(e){let{integration:h,configurationId:x}=e,[m,p]=(0,r.useState)(!1),[g,f]=(0,r.useTransition)(),{data:y,mutate:b}=(0,i.default)(x),v=(0,s.useToasts)(),N=(0,o.useRouter)(),C=(0,c.useTeam)().team,I=y?.transferRequest;if(!y||I?.kind!=="transfer-from-marketplace")return null;let k=()=>{p(!1)},w=async()=>{try{await (0,d.clientTypedFetchData)("/v1/integrations/installations/{integrationConfigurationId}/transfers/discard","post",{teamId:C?.id,integrationConfigurationId:y.id},{requestId:I.requestId}),await b()}catch(e){(0,u.captureException)(e),v.error("Failed to discard transfer request. Please try again.")}};return(0,t.jsxs)("section",{className:"mx-auto my-0 max-w-[520px] rounded-lg p-4",children:[(0,t.jsxs)(a.Card,{border:!0,shadow:!0,className:"max-w-[600px] p-4",children:[(0,t.jsxs)("p",{className:"text-heading-24",children:["Transfer your account from ",h.name," to Vercel"]}),(0,t.jsxs)("p",{className:"text-copy-14",children:["All your resources will be transferred to ",h.name,". After the transfer is complete, your billing will be handled by"," ",h.name," and you’ll use their platform to manage your resources."]}),(0,t.jsxs)("div",{className:"mt-4 flex gap-2",children:[(0,t.jsx)(n.Button,{onClick:()=>{w()},disabled:g,type:"secondary",children:"Discard"}),(0,t.jsx)(n.Button,{onClick:()=>{f(()=>{p(!0)})},loading:g,className:"ml-auto",children:"Proceed with transfer"})]})]}),(0,t.jsx)(l.Modal,{active:m,onClickOutside:k,children:(0,t.jsx)(j,{configuration:y,transferRequest:I,onDone:()=>{k(),N.replace(`/${C?.slug}/~/integrations/${h.slug}/${x}`)},onCancel:k})})]})}e.s(["RequestTransferFromVercelNotification",()=>v],417098)},3942353,e=>{"use strict";var t=e.i(1146226),i=e.i(5169864),a=e.i(2504781),n=e.i(6318858),l=e.i(5366204),s=e.i(5339191),r=e.i(1098160);function o(e){let{integrationSlug:o}=e,[c,d]=(0,i.useState)(!1);async function u(){let e=`https://vercel.com/marketplace/${o}`;try{await navigator.clipboard.writeText(e),d(!0),setTimeout(()=>{d(!1)},2e3)}catch(e){}}return o?(0,t.jsx)(s.AnimatePresence,{mode:"wait",children:c?(0,t.jsxs)(r.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.1},className:"top-px flex h-4 items-center gap-1 p-1",children:[(0,t.jsx)(n.Check,{color:"green-700",size:12}),(0,t.jsx)("span",{className:"text-xs leading-none text-green-700",children:"URL copied"})]},"success"):(0,t.jsx)(r.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.1},className:"flex h-4 items-center",children:(0,t.jsx)(a.Button,{variant:"unstyled",className:"top-px flex items-center rounded p-1 text-[var(--accents-3)] transition-all duration-300 hover:bg-gray-200 disabled:hover:cursor-default disabled:hover:bg-transparent [&>span]:inline-flex [&>span]:h-fit [&>span]:items-center [&>span]:justify-center [&>span]:p-0",size:"tiny",onClick:()=>{u()},children:(0,t.jsx)(l.Link,{size:12})})},"normal")}):null}e.s(["IntegrationPublicUrlShareButton",()=>o])},3646190,e=>{"use strict";var t=e.i(1146226),i=e.i(5328446),a=e.i(7426968);function n(e){let{configurationId:n}=e,{data:l}=(0,i.default)(n);return(0,t.jsx)(a.NotificationCallout,{notification:l?.notification,ssoParams:{integrationConfigurationId:l?.id,teamIdOrSlug:l?.teamId}})}e.s(["InstallationStatus",()=>n])},2007186,e=>{e.v({detailsSection:"details-sidebar-module__IOjKpW__detailsSection",detailsWrapper:"details-sidebar-module__IOjKpW__detailsWrapper"})},2171370,e=>{"use strict";var t=e.i(1146226),i=e.i(5255926),a=e.i(5468328),n=e.i(4011256),l=e.i(57106);e.i(6887680);var s=e.i(9219571),r=e.i(6810699),o=e.i(2007186),c=e.i(9722978);function d(e){let{integration:i,Support:a}=e;if(!i)return(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[(0,t.jsx)(m,{}),(0,t.jsx)(m,{}),(0,t.jsx)(m,{}),(0,t.jsx)(m,{})]});let n="object"==typeof i&&"products"in i,s="single-product"===i.layout,r=[];if(n&&s){let e=i.products?.[0];r=e?.resourceLinks??[]}return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x,{title:"Developer",value:i.createdBy}),(0,t.jsx)(x,{title:"Website",truncate:!0,value:i.website?(0,t.jsx)(l.Link,{href:i.website,type:"highlight",children:i.website.replace(/https?:\/\//,"").replace(/\/$/,"")}):null}),(0,t.jsx)(x,{title:"Documentation",value:i.documentationUri?(0,t.jsx)(l.Link,{external:!0,href:i.documentationUri,type:"highlight",children:"Read"}):null}),(0,t.jsx)(x,{title:"EULA",value:i.eulaDocUri?(0,t.jsx)(l.Link,{external:!0,href:i.eulaDocUri,type:"highlight",children:"Read"}):null}),(0,t.jsx)(x,{title:"Privacy Policy",value:i.privacyDocUri?(0,t.jsx)(l.Link,{external:!0,href:i.privacyDocUri,type:"highlight",children:"Read"}):null}),a??(0,t.jsx)(x,{title:"Support",tooltip:"Need help? Reach out to your integration partner for support.",truncate:!0,value:i.supportUri?(0,t.jsxs)(l.Link,{external:!0,href:i.supportUri,prefetch:!1,type:"highlight",children:["Open in ",i.name]}):i.supportContactEmail?(0,t.jsx)(l.Link,{external:!0,href:i.supportContactEmail.includes("@")?`mailto:${i.supportContactEmail}`:i.supportContactEmail,type:"highlight",children:i.supportContactEmail}):null,wrapTitle:!0}),r.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-heading-20 mt-6",children:"Resources"}),(0,t.jsx)("div",{children:r.map(e=>(0,t.jsx)(x,{title:e.title,value:(0,t.jsx)(l.Link,{href:e.href,type:"highlight",external:!0,children:"Read"})},e.title))})]})]})}function u(e){let{configuration:i}=e,{data:a}=(0,s.useMarketplaceBillingBalance)(i.id),l=a?.balance?.currencyValueInCents??i.billingData?.credit?.balanceTotalCent;return void 0===l?null:(0,t.jsx)(x,{title:"Prepaid Balance",value:(0,n.formatMarketplaceBillingTotal)(l/100)})}function h(e){let{integrationIdOrSlug:a,integrationConfigurationId:n,teamSlug:l}=e,{data:s}=(0,r.useResourceList)({teamSlug:l,integrationIdOrSlug:a,integrationConfigurationId:n});return(0,t.jsx)(x,{title:"Installed products",value:s?.stores.length??(0,t.jsx)(i.Skeleton,{height:20,width:10})})}function x(e){let{title:i,value:n,truncate:l,wrapTitle:s,tooltip:r}=e;return n?(0,t.jsx)("div",{className:o.default.detailsSection,children:(0,t.jsxs)("div",{className:"flex flex-row items-stretch justify-between gap-4 flex-initial",children:[(0,t.jsx)(a.Tooltip,{text:r,children:(0,t.jsx)("p",{className:(0,c.default)("text-copy-14",s&&"text-wrap"),children:i})}),(0,t.jsx)("p",{className:(0,c.default)("text-copy-14",l&&"truncate"),children:n})]})}):null}function m(){return(0,t.jsx)("div",{className:o.default.detailsSection,children:(0,t.jsxs)("div",{className:"flex flex-row items-stretch justify-between gap-4 flex-initial",children:[(0,t.jsx)(i.Skeleton,{height:18,width:"40%"}),(0,t.jsx)(i.Skeleton,{height:18,width:"40%"})]})})}e.s(["DetailSidebar",()=>d,"MarketplaceSidebarBalance",()=>u,"MarketplaceSidebarDetailSection",()=>x,"MarketplaceSidebarResourceCount",()=>h])},3967785,e=>{"use strict";var t=e.i(1146226),i=e.i(5169864),a=e.i(8248823),n=e.i(8761240),l=e.i(2504781),s=e.i(455575),r=e.i(5140444),o=e.i(1857939),c=e.i(57106),d=e.i(1119178),u=e.i(2704354);function h(e){let{integration:i}=e,{isLoggedOut:a}=(0,o.useIsLoggedIn)();return(0,u.isCodeRepository)(i)?(0,t.jsxs)(c.ButtonLink,{href:a?"/signup":"/new",children:["Continue with ",i.name]}):null}function x(e){let{integration:i}=e;return(0,u.hasCustomCta)(i)&&i.ctaUrl?(0,t.jsx)(c.ButtonLink,{href:i.ctaUrl,children:i.ctaText}):null}function m(e){let{integration:o}=e,{user:h}=(0,r.useUser)(),x=(0,s.useToasts)(),[m,p]=(0,i.useState)(!1),[g,f]=(0,i.useState)(!1),j=async()=>{if(h?.email&&h.uid){f(!0);try{await (0,u.requestIntegration)({userId:h.uid,email:h.email,slug:o.slug}),x.success("Request submitted successfully."),p(!0)}catch(e){x.error((0,a.errorToString)(e))}finally{f(!1)}}};return h?(0,t.jsx)(l.Button,{disabled:g||m,loading:g,onClick:(0,d.promiseToCallback)(j),prefix:m?(0,t.jsx)(n.CheckCircleFill,{color:"green-700"}):void 0,children:m?"Requested":"Request Integration"}):(0,t.jsx)(c.ButtonLink,{href:"#request",children:"Request Integration"})}function p(e){let{integration:i}=e;return(0,u.isCodeRepository)(i)||(0,u.hasCustomCta)(i)?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h,{integration:i}),(0,t.jsx)(x,{integration:i})]}):(0,t.jsx)(m,{integration:i})}e.s(["ContentfulIntegrationButton",()=>p])},9811698,e=>{e.v({button:"request-form-module__8eWAma__button",label:"request-form-module__8eWAma__label",wrapper:"request-form-module__8eWAma__wrapper"})},3252593,e=>{e.v({content:"contentful-integration-details-module__10dLUa__content","mdx-container":"contentful-integration-details-module__10dLUa__mdx-container"})},5267109,e=>{"use strict";var t=e.i(1146226),i=e.i(1857939),a=e.i(7775029),n=e.i(2704354),l=e.i(5169864),s=e.i(8248823),r=e.i(2504781),o=e.i(3500331),c=e.i(9318197),d=e.i(455575),u=e.i(9811698);function h(e){let{children:i}=e;return(0,t.jsx)("span",{className:u.default.label,children:i})}let x={background:"var(--input-background)"};function m(e){let{slug:i}=e,[a,m]=(0,l.useState)(""),[p,g]=(0,l.useState)(""),[f,j]=(0,l.useState)(""),[y,b]=(0,l.useState)(!1),v=(0,d.useToasts)(),N=async e=>{e.preventDefault(),b(!0);try{await (0,n.requestIntegration)({firstName:a,lastName:p,email:f,slug:i}),m(""),g(""),j(""),v.success("Request submitted successfully.")}catch(e){v.error((0,s.errorToString)(e))}finally{b(!1)}};return(0,t.jsx)("div",{className:u.default.wrapper,children:(0,t.jsxs)("form",{onSubmit:N,children:[(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-6 flex-initial",children:[(0,t.jsxs)("div",{className:"flex flex-col md:flex-row items-stretch justify-start gap-6 flex-initial",children:[(0,t.jsx)(o.Input,{disabled:y,id:"integrations-first-name",label:(0,t.jsx)(h,{children:"First Name"}),maxLength:40,name:"firstName",onChange:e=>m(e.target.value),pattern:".*\\S+.*",placeholder:"Jane",required:!0,style:x,title:"This field cannot be blank.",value:a,width:"100%"}),(0,t.jsx)(o.Input,{disabled:y,id:"integrations-last-name",label:(0,t.jsx)(h,{children:"Last Name"}),maxLength:40,name:"lastName",onChange:e=>g(e.target.value),pattern:".*\\S+.*",placeholder:"Doe",required:!0,style:x,title:"This field cannot be blank.",value:p,width:"100%"})]}),(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start flex-initial",children:(0,t.jsx)(o.Input,{disabled:y,id:"integrations-email",label:(0,t.jsx)(h,{children:"Email"}),maxLength:40,name:"email",onChange:e=>j(e.target.value),placeholder:"janedoe@example.com",required:!0,style:x,title:"This field cannot be blank.",typeName:"email",value:f,width:"100%"})})]}),(0,t.jsx)(c.Spacer,{y:2}),(0,t.jsx)("div",{className:u.default.button,children:(0,t.jsx)(r.Button,{loading:y,size:"large",children:"Request Integration"})})]})})}var p=e.i(3252593);function g(e){let{integration:l}=e,{isLoading:s,isLoggedOut:r}=(0,i.useIsLoggedIn)();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:[(0,t.jsx)("p",{className:"text-heading-20",children:"Overview"}),(0,t.jsx)("div",{className:p.default["mdx-container"],children:(0,a.renderContentfulDocument)(l.overview)})]}),s||!r||(0,n.isCodeRepository)(l)?null:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:[(0,t.jsx)("div",{id:"request",children:(0,t.jsx)("p",{className:"text-heading-20",children:"Request Integration"})}),(0,t.jsx)(m,{slug:l.slug})]})]})}e.s(["RequestContentfulIntegration",()=>g],5267109)},1003898,e=>{"use strict";var t=e.i(1146226),i=e.i(5169864),a=e.i(5338940),n=e.i(7275883),l=e.i(6881349),s=e.i(8161149);e.i(2815631);var r=e.i(5225151),o=e.i(2800132),c=e.i(266062),d=e.i(1091997),u=e.i(2405338),h=e.i(277234),x=e.i(4244280);e.i(3092247);var m=e.i(397510),p=e.i(4011256);function g(e){var p;let{integration:g,stores:y,teamSlug:b,integrationConfigurationId:v,integrationSlug:N,resourceId:C}=e,[I,k]=(0,i.useState)("week"),{team:w}=(0,a.useTeam)(),T=(p=w?{integrationConfigurationId:v,teamId:w.id,period:I}:null,(0,u.default)(()=>{if(!p)return null;let{integrationConfigurationId:e,teamId:t,period:i}=p,a=new URLSearchParams;return a.append("teamId",t),a.append("period",i),`${x.API_INTEGRATION_CONTROLLER_V2}/installations/${e}/billing/data/series?${a.toString()}`},h.fetchAPI)),S=(0,i.useMemo)(()=>{let e,t,i;if(!T.data?.byResource||!T.data.installation)return null;if(T.data.installation.credit?.balanceTotalCent.length){let t=new Map;T.data.installation.credit.balanceTotalCent.forEach(e=>{let i=new Date(e.timestamp).getTime();t.has(i)||t.set(i,{date:i,records:{}});let a=t.get(i);a&&(a.records.Total=e.value/100)}),T.data.byResource.forEach(e=>{let i=e.externalResourceId;i&&e.credit?.balanceTotalCent.length&&e.credit.balanceTotalCent.forEach(e=>{let a=new Date(e.timestamp).getTime();t.has(a)||t.set(a,{date:a,records:{}});let n=t.get(a),l=y.find(e=>e.externalResourceId===i)?.name;n&&l&&(n.records[l]=e.value/100)})}),e=t.size>0?Array.from(t.values()):void 0}if(T.data.installation.spending?.totalCent.length){let e=new Map;T.data.installation.spending.totalCent.forEach(t=>{let i=new Date(t.timestamp).getTime();e.has(i)||e.set(i,{date:i,records:{}});let a=e.get(i);a&&(a.records.Total=t.value/100)}),T.data.byResource.forEach(t=>{let i=t.externalResourceId;i&&t.spending?.totalCent.length&&t.spending.totalCent.forEach(t=>{let a=new Date(t.timestamp).getTime();e.has(a)||e.set(a,{date:a,records:{}});let n=e.get(a),l=y.find(e=>e.externalResourceId===i)?.name;n&&l&&(n.records[l]=t.value/100)})}),t=e.size>0?Array.from(e.values()):void 0}if(T.data.installation.usage?.byMetrics.length){let e=new Map;T.data.installation.usage.byMetrics.forEach(t=>{t.usageItems.forEach(i=>{let a=e.get(t.name)?.map;a||(a=new Map,e.set(t.name,{type:t.type,units:t.units,map:a}));let n=new Date(i.timestamp).getTime();a.has(n)||a.set(n,{date:n,records:{}});let l=a.get(n);l&&(l.records.Total=i.value)})}),i=Array.from(e.entries()).map(e=>{let[t,{type:i,units:a,map:n}]=e;return{metric:{name:t,type:i,units:a},data:Array.from(n.values())}})}return{noData:!e&&!t&&!i,prepayment:e,subscription:t,usageByMetric:i}},[T.data,y]);return T.isLoading?(0,t.jsx)(j,{dimensions:y.length}):!S||S.noData?(0,t.jsx)(s.EmptyState.Root,{description:"edgedb"===N?"There are no data available yet for this period.":"Usage tracking is not yet available for this service.",icon:(0,t.jsx)(s.EmptyState.Icon,{icon:(0,t.jsx)(n.ChartBarPeak,{}),size:32}),paddingY:200,secondary:!0,title:"No data available",children:(0,t.jsx)(m.OpenInPartnerDashboardButton,{componentType:"button",buttonVariant:"secondary",integrationConfigurationId:v,label:`See usage in ${g.name}`,teamIdOrSlug:w?.id,path:"usage"})}):(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-5 flex-initial",children:[C?(0,t.jsx)(o.ResourceUsageCharts,{resourceId:C}):(0,t.jsxs)("div",{className:"flex flex-row items-center justify-between gap-2 flex-initial",children:[(0,t.jsx)("p",{className:"text-heading-20",children:"Usage Report"}),(0,t.jsxs)(l.Combobox,{clearable:!1,noInputPrefix:!0,onChange:e=>{e&&k(e)},value:I,width:140,children:[(0,t.jsx)(l.Combobox.Input,{}),(0,t.jsxs)(l.Combobox.List,{children:[(0,t.jsx)(l.Combobox.Option,{value:"week",children:"Last 7 days"}),(0,t.jsx)(l.Combobox.Option,{value:"month",children:"Last month"}),(0,t.jsx)(l.Combobox.Option,{value:"year",children:"Last year"})]})]})]}),S.prepayment?(0,t.jsx)(d.MarketplaceLineChart,{chartData:S.prepayment,description:"This chart shows the balance over time.",formatter:(0,c.formatUsageValueByUnit)("$"),legendSuffix:"Balance",linkMapper:e=>f(y,e,b),title:"Balance"}):null,S.subscription?(0,t.jsx)(d.MarketplaceLineChart,{chartData:S.subscription,description:"This chart shows the cost per product over time.",formatter:(0,c.formatUsageValueByUnit)("$"),legendSuffix:"Total Cost",linkMapper:e=>f(y,e,b),title:"Cost per Product"}):null,S.usageByMetric?.map(e=>"total"===e.metric.type?(0,t.jsx)(d.MarketplaceLineChart,{chartData:e.data,description:`This chart shows the ${e.metric.name} over time.`,formatter:(0,c.formatUsageValueByUnit)(e.metric.units),legendSuffix:`Total ${e.metric.name}`,title:e.metric.name},e.metric.name):(0,t.jsx)(r.MarketplaceBarChart,{chartData:e.data,description:`This chart shows the ${e.metric.name} over time.`,formatter:(0,c.formatUsageValueByUnit)(e.metric.units),legendSuffix:`Total ${e.metric.name}`,title:e.metric.name},e.metric.name))]})}function f(e,t,i){let a=e.find(e=>e.name===t);return a?(0,p.getResourceDashboardLink)(a,{teamSlug:i,path:"usage"}):""}function j(e){let{dimensions:i=4}=e;return(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-5 flex-initial",children:[(0,t.jsxs)("div",{className:"flex flex-row items-center justify-between gap-2 flex-initial",children:[(0,t.jsx)("p",{className:"text-heading-20",children:"Usage Report"}),(0,t.jsxs)(l.Combobox,{clearable:!1,noInputPrefix:!0,value:"week",width:140,children:[(0,t.jsx)(l.Combobox.Input,{}),(0,t.jsx)(l.Combobox.List,{children:(0,t.jsx)(l.Combobox.Option,{value:"week",children:"Last 7 days"})})]})]}),(0,t.jsx)(r.MarketplaceChartPlaceholder,{description:"This chart shows the cost per product over time.",dimensions:i,title:"Cost per Product"})]})}e.s(["MarketplaceBillingChart",()=>g,"MarketplaceBillingChartPlaceholder",()=>j],1003898)},773959,e=>{"use strict";var t=e.i(1146226),i=e.i(2504781),a=e.i(3869281),n=e.i(7137884),l=e.i(8517043),s=e.i(1232681),r=e.i(3500331),o=e.i(3895030),c=e.i(9792418),d=e.i(5468328),u=e.i(455575),h=e.i(4585051),x=e.i(8735244),m=e.i(8522580),p=e.i(5806401),g=e.i(762945),f=e.i(5169576),j=e.i(2560270),y=e.i(7807066),b=e.i(7399351),v=e.i(923772),N=e.i(6942035),C=e.i(5761705),I=e.i(6143247),k=e.i(9220646),w=e.i(9598279),T=e.i(5169864),S=e.i(5610834),A=e.i(119294),P=e.i(6352514),M=e.i(8042625),L=e.i(277234),_=e.i(4244280),R=e.i(1119178),E=e.i(4004502),D=e.i(4011256),O=e.i(57106);e.i(6887680);var F=e.i(6810699),B=e.i(553769),U=e.i(3758860),q=e.i(9349058),$=e.i(8525850),V=e.i(9243747);e.i(7037808);var W=e.i(5098510),z=e.i(1574218),G=e.i(5074599),Y=e.i(9186321);function H(e){let{integration:a,configuration:r,team:x,canDelete:m,singleResource:p}=e,{data:g}=(0,F.useResourceList)({skip:"marketplace"!==r.installationType,integrationIdOrSlug:a.slug,integrationConfigurationId:r.id}),{deleteResource:j}=(0,q.useMutateResource)(),y=!!r.deleteRequestedAt,b=g?.stores.length??0,v=b>0,N=!m,C=(0,u.useToasts)(),I=(0,S.useRouter)(),[B,W]=(0,T.useState)(!1),[z,G]=(0,T.useState)(!1),[H,J]=(0,T.useState)(!1),[Q,X]=(0,T.useState)(!1),[ee,et]=(0,T.useState)(""),ei=(0,T.useCallback)(()=>{let e=(0,D.getMarketplaceInstallationsLink)({teamSlug:x.slug});I.push(e)},[I,x.slug]),ea=(0,T.useCallback)(()=>{W(!1),X(!1),J(!1),et("")},[]),en=(0,T.useCallback)(()=>{ea(),ei()},[ea,ei]),el=(0,T.useCallback)(()=>{X(!1),et("")},[]),es=(0,T.useCallback)(()=>W(!0),[]),er=(0,T.useCallback)(async()=>{if(N||z)return;G(!0);let e=(0,M.encode)({teamId:x.id});try{if("marketplace"===r.installationType&&g?.stores){let e=g.stores.map(async e=>{try{await j(e.id)}catch(t){console.warn(`Failed to delete resource ${e.id}:`,t)}});await Promise.allSettled(e)}"marketplace"===r.installationType?await (0,L.fetchAPI)(`${_.API_INTEGRATION_CONTROLLER_V2}/installations/${r.id}/uninstall${e}`,{method:"POST",body:{},throwOnHTTPError:!0}):await (0,L.fetchAPI)(`${_.API_INTEGRATION_CONTROLLER}/configuration/${r.id}${e}`,{method:"DELETE"}),A.analytics.track(P.AnalyticsEvent.INTEGRATION_CONFIGURATION_REMOVE_SUCCEEDED),A.analytics.track(P.AnalyticsEvent.INTEGRATION_UNINSTALLED,{integration_id:a.id,integration_slug:a.slug,source:"installation view",target:"team"}),J(!0)}catch(t){let e=(0,U.showRenderIntegrationError)(t)?t.message:"Failed to uninstall integration";et(e),X(!0),C.error(e)}finally{G(!1)}},[r,a.id,a.slug,x,C,ea,ei,g?.stores,j,N,z]);(0,T.useEffect)(()=>{B&&A.analytics.track(P.AnalyticsEvent.INTEGRATION_CONFIGURATION_REMOVE_MODAL_OPENED)},[B]);let eo="marketplace"===r.installationType?r.billingPlan?.type:void 0,ec="marketplace"===r.installationType&&a.flags?.includes(Y.LaunchDarklyIntegrationFlags.MarketplaceInstallationDeletePendingAt)&&r.billingData?.spending?.periodEnd?K(new Date(r.billingData.spending.periodEnd)):void 0,ed=r.deleteRequestedAt&&r.deleteRequestedAt>Date.now()?K((0,w.addDays)(r.deleteRequestedAt,1)):void 0,eu="marketplace"===r.installationType&&(0,V.getIntegrationOps)({integration:a}).isSingleProductLayout();return(0,t.jsxs)(l.Fieldset,{children:[(0,t.jsxs)(n.FieldsetContent,{children:[(0,t.jsx)(c.FieldsetTitle,{children:"Uninstall Integration"}),!eu&&v?(0,t.jsxs)(o.FieldsetSubtitle,{color:"gray-900",children:["This integration has"," ",(0,t.jsxs)(k.Root,{children:[(0,t.jsx)(k.Trigger,{asChild:!0,children:(0,t.jsxs)(O.Link,{className:"inline-flex items-center gap-1 underline-offset-4 hover:underline bg-transparent border-none cursor-pointer p-0 font-inherit",children:[(0,t.jsxs)("span",{children:[b," connected product",1!==b?"s":""]}),(0,t.jsx)(f.Information,{className:"w-3 h-3"})]})}),(0,t.jsx)(k.Portal,{children:(0,t.jsxs)(k.Content,{className:"bg-white rounded-[8px] shadow-[0_8px_30px_rgb(0,0,0,0.12)] p-4 max-w-[280px] z-50",sideOffset:8,children:[(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("div",{className:"font-medium text-[14px] text-[var(--geist-foreground)]",children:"Connected Products"}),g?.stores.length?(0,t.jsx)("div",{className:"space-y-2 max-h-[320px] overflow-y-auto",children:g.stores.map(e=>(0,t.jsxs)(O.Link,{href:(0,$.getResourceDetailsPath)(e,x.slug),className:"flex items-center gap-2 p-1 hover:bg-gray-50 rounded transition-colors",target:"_blank",rel:"noopener noreferrer",children:[(0,t.jsx)("div",{className:"w-4 h-4 flex items-center justify-center flex-shrink-0",children:(0,t.jsx)(h.Avatar,{hash:e.product.iconUrl,size:24})}),(0,t.jsx)("span",{className:"text-[14px] text-[var(--geist-foreground)] truncate flex-1",children:e.name})]},e.id))}):(0,t.jsx)("div",{className:"text-[14px] text-[var(--geist-gray)]",children:"No products found"})]}),(0,t.jsx)(k.Arrow,{className:"fill-white"})]})})]})," ","that will be automatically removed when you uninstall."]}):null,y?(0,t.jsxs)("p",{className:"text-copy-14",children:["This integration is scheduled to be uninstalled",ed?` on ${ed}`:" within 24 hours","."]}):null]}),(0,t.jsx)(s.FieldsetFooter,{children:(0,t.jsx)(s.FieldsetFooter.Actions,{children:(0,t.jsxs)(d.Tooltip,{disableTriggers:!N,text:function(e){let{isDeleteRequested:t}=e;return t?"This integration is scheduled to be uninstalled.":"You need additional permissions to uninstall integration."}({isDeleteRequested:y}),children:[(0,t.jsx)(i.Button,{"data-testid":(0,E.tid)("integration","uninstall"),disabled:N,onClick:es,children:"Uninstall Integration"}),(0,t.jsx)(Z,{open:B,onOpenChange:W,billingType:eo,eulaLink:a.eulaDocUri,integration:a,loading:z,onCancel:()=>{A.analytics.track(P.AnalyticsEvent.INTEGRATION_CONFIGURATION_REMOVE_CANCELED),ea()},onConfirm:(0,R.promiseToCallback)(er),singleResource:g?.stores.find(e=>e.id===p?.id)??p,subscriptionEndDate:ec,team:x,resourceStores:g?.stores,showSuccess:H,onDone:en,showError:Q,errorMessage:ee,onRetry:el,onClose:ea})]})})})]})}function K(e){return e.toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"})}function Z(e){let{loading:n,integration:l,open:s,onOpenChange:o,onCancel:c,onConfirm:d,billingType:u,eulaLink:h,singleResource:m,subscriptionEndDate:f,team:j,resourceStores:y,showSuccess:b,onDone:v,showError:I,errorMessage:k,onRetry:w,onClose:S}=e,A=(0,T.useRef)(null),[P,M]=(0,T.useState)(!1),[L,_]=(0,T.useState)("");(0,T.useEffect)(()=>{s&&requestAnimationFrame(()=>{let e=Array.from(A.current?.elements??[]);e.find(e=>"INPUT"===e.tagName)?.focus()})},[s]);let R=(0,T.useCallback)(e=>{e.preventDefault(),!n&&A.current?.checkValidity()&&P&&d()},[d,P,L,n]);return(0,t.jsx)(p.Sheet,{onOpenChange:o,open:s,children:(0,t.jsxs)(p.SheetContent,{className:"m-3 h-[calc(100%-1.5rem)] w-[calc(100%-1.5rem)] overflow-visible rounded-[1rem] bg-white p-0 lg:w-[600px] xl:w-[640px] sm:max-w-[auto]",side:"right",children:[(0,t.jsx)(p.SheetClose,{asChild:!0,children:(0,t.jsx)(i.Button,{"aria-label":"Close",shape:"square",size:"medium",svgOnly:!0,type:"tertiary",className:"absolute top-4 right-4 z-20",children:(0,t.jsx)(N.Cross,{})})}),(0,t.jsxs)("div",{className:"flex h-full flex-col overflow-hidden rounded-[1rem]",children:[(0,t.jsx)(p.SheetHeader,{className:"sticky top-0 z-10 bg-white p-6 border-b",children:(0,t.jsx)(p.SheetTitle,{children:"Uninstall Integration"})}),b?(0,t.jsx)("div",{className:"flex h-full flex-col items-center justify-center p-6",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(C.CheckCircle,{className:"w-16 h-16 text-green-600 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-heading-20 mb-2",children:"Integration Uninstalled"}),(0,t.jsx)("p",{className:"text-copy-14 text-gray-700 mb-6 max-w-md",children:"The integration and all associated resources have been successfully removed from your account."}),(0,t.jsx)("div",{className:"flex justify-center",children:(0,t.jsx)(i.Button,{onClick:v,children:"Done"})})]})}):I?(0,t.jsx)("div",{className:"flex h-full flex-col items-center justify-center p-6",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(g.Warning,{className:"w-16 h-16 text-red-600 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-heading-20 mb-2",children:"Uninstall Failed"}),(0,t.jsx)("p",{className:"text-copy-14 text-gray-700 mb-6 max-w-md",children:k||"An unexpected error occurred while uninstalling the integration. Please try again."}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)(i.Button,{onClick:w,type:"default",children:"Try Again"}),(0,t.jsx)(i.Button,{onClick:S,type:"secondary",children:"Close"})]})]})}):n?(0,t.jsx)("div",{className:"flex h-full flex-col items-center justify-center p-6",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"flex justify-center mb-4",children:(0,t.jsx)(x.Spinner,{})}),(0,t.jsx)("p",{className:"text-[18px] leading-[24px] font-semibold mb-2",children:"Uninstalling Integration"}),(0,t.jsx)("p",{className:"text-copy-14 text-gray-700",children:"Removing resources and cleaning up your account..."})]})}):(0,t.jsx)("form",{onSubmit:R,ref:A,className:"flex flex-1 min-h-0 flex-col",children:(0,t.jsx)("div",{className:"flex-1 overflow-y-auto p-6",children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-6 flex-initial",children:[(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[(0,t.jsx)("p",{className:"text-copy-14",children:"This integration will be uninstalled and all associated products will be automatically removed. Any projects connected to these products will lose access to their resources."}),(0,t.jsxs)("p",{className:"text-copy-14",children:["By clicking to uninstall, I acknowledge that I have read the"," ",(0,t.jsx)(O.Link,{external:!0,href:h,prefetch:!1,type:"primary",children:"EULA"}),"and understand my rights upon termination.","prepayment"===u?" Unused or prepaid credits may not be refunded in accordance with this provider's terms and policies.":"",f?` Your active subscription ends on ${f}. The provider may terminate it at any time in accordance with their terms and policies. The remaining period may not be refunded.`:""]}),y&&y.length>0&&(0,t.jsx)(ee,{resourceStores:y,teamSlug:j.slug})]}),m?(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-6 flex-initial",children:[(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[(0,t.jsxs)("p",{className:"text-copy-14",children:[z.PRODUCT," will"," ",(0,t.jsxs)("b",{children:["delete your"," ",(0,G.getProductNameAndResourceTitle)(m.product)]}),", along with all of its items. Any projects connected to this"," ",(0,G.getResourceTitleByProductForDeletion)(m.product)," ","will no longer be able to read its contents."]}),(0,t.jsxs)("p",{className:"text-copy-14",children:[z.PRODUCT," recommends that you ensure this"," ",(0,G.getResourceTitleByProductForDeletion)(m.product)," ","is no longer used by any projects before continuing."]})]}),m.projectsMetadata.length?(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-3 flex-initial",children:[(0,t.jsx)("p",{className:"text-copy-14 text-gray-900",children:"Deleting the database will cause the deletion of connections to the following projects"}),(0,t.jsx)(W.ProjectConnectionsListInModal,{connections:m.projectsMetadata})]}):null]}):null,(0,t.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg border",children:(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start gap-6 flex-initial",children:(0,t.jsx)("label",{children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[(0,t.jsxs)("p",{className:"text-copy-14 text-gray-900",children:["Enter the integration name"," ",(0,t.jsx)("b",{style:{overflowWrap:"anywhere"},children:l.slug})," ","to continue:"]}),(0,t.jsx)(r.Input,{"aria-label":"Resource Name",name:"resourceName",pattern:`\\s*${l.slug}\\s*`,required:!0,onChange:e=>_(e.target.value)})]})})})}),(0,t.jsx)(Q,{children:(0,t.jsx)(a.Checkbox,{checked:P,onChange:e=>M(e.target.checked),labelClassName:"font-medium text-sm",children:(0,B.isAwsIntegration)(l)?(0,t.jsxs)(t.Fragment,{children:["I understand that this action is not reversible and will permanently remove this integration, all associated resources, and my ability to view AWS billing and account information. I understand that my AWS account will close and my content will be deleted in accordance with"," ",(0,t.jsx)(O.Link,{external:!0,href:"https://aws.amazon.com/agreement/",prefetch:!1,type:"primary",children:"AWS documentation"}),", and that this Vercel user will not be able to create another AWS integration."]}):(0,t.jsx)(t.Fragment,{children:"I understand that this action is not reversible and will permanently remove this integration and all associated resources."})})}),(0,t.jsxs)("div",{className:"border-t bg-white pt-4 flex justify-end gap-2",children:[(0,t.jsx)(i.Button,{disabled:n,onClick:n?void 0:c,type:"secondary",typeName:"button",className:n?"opacity-50 cursor-not-allowed":"",children:"Cancel"}),(0,t.jsx)(i.Button,{typeName:"submit",disabled:n||!P||L!==l.slug,className:`inline-flex items-center justify-center rounded-md bg-red-600 px-4 py-2 text-sm font-medium text-white shadow ${n||!P||L!==l.slug?"opacity-50 cursor-not-allowed":"hover:bg-red-700"}`,children:n?"Uninstalling...":"Uninstall"})]})]})})})]})]})})}let J={"--note-border-color":"var(--geist-warning)",borderRadius:"12px",lineHeight:"normal",padding:"1rem"};function Q(e){let{children:i}=e;return(0,t.jsx)(m.Note,{fill:!0,style:J,type:"warning",children:i})}function X(e){let{expanded:i,onClick:a,loading:n}=e;return(0,t.jsx)("div",{className:"flex -my-4 items-center",children:(0,t.jsx)("div",{className:"bg-background",children:(0,t.jsx)("button",{type:"button",onClick:a,disabled:n,className:"flex size-8 items-center justify-center rounded-full border border-solid border-gray-alpha-400 bg-white shadow-sm hover:bg-gray-50 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:(0,t.jsx)("span",{className:(0,I.cn)("flex items-center justify-center transition-transform duration-200 ease-in-out",i&&"rotate-180"),children:(0,t.jsx)(j.ChevronDown,{color:"gray-900",size:16})})})})})}function ee(e){let{resourceStores:i,teamSlug:a}=e,[n,l]=(0,T.useState)(new Set),[s,r]=(0,T.useState)(!1),o=(0,T.useCallback)(e=>{l(t=>{let i=new Set(t);return i.has(e)?i.delete(e):i.add(e),i})},[]);if(0===i.length)return(0,t.jsx)(t.Fragment,{});let c=s?i:i.slice(0,3),d=i.length>3;return(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-3 flex-initial",children:[(0,t.jsx)("p",{className:"text-[14px] leading-[20px] font-medium",children:"Installed Products"}),(0,t.jsx)(Q,{children:(0,t.jsx)("p",{className:"font-medium",children:"The following products will be automatically deleted when you uninstall this integration"})}),(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[c.map(e=>{let i=e.projectsMetadata&&e.projectsMetadata.length>0,l=n.has(e.id);return(0,t.jsxs)("div",{className:"border border-gray-200 rounded-md",children:[(0,t.jsxs)("div",{className:"w-full flex items-center justify-between text-left bg-white relative",children:[(0,t.jsxs)(O.Link,{href:(0,$.getResourceDetailsPath)(e,a),target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 min-w-0 flex-1 p-3 hover:bg-gray-50 transition-colors",children:[(0,t.jsx)(v.Trash,{className:"w-4 h-4 text-red-500 flex-shrink-0"}),(0,t.jsx)("div",{className:"w-4 h-4 flex items-center justify-center flex-shrink-0",children:(0,t.jsx)(h.Avatar,{hash:e.product.integration.icon,size:24})}),(0,t.jsx)("p",{className:"text-copy-14 truncate flex-1 min-w-0",title:e.name,children:e.name})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 flex-shrink-0 p-3 relative z-10",children:[(0,t.jsxs)("p",{className:"text-label-12 text-gray-700",children:["(",e.projectsMetadata?.length||0," project",e.projectsMetadata?.length!==1?"s":"",")"]}),i&&(0,t.jsx)("button",{type:"button","aria-label":l?"Collapse project list":"Expand project list",onClick:()=>o(e.id),className:"p-0.5 w-6 h-6 flex items-center justify-center rounded border border-gray-300 bg-white hover:bg-gray-50 transition-colors",children:l?(0,t.jsx)(b.ChevronUp,{className:"w-3 h-3"}):(0,t.jsx)(j.ChevronDown,{className:"w-3 h-3"})})]})]}),i&&l&&(0,t.jsx)("div",{className:"border-t border-gray-200 p-3 bg-gray-50",children:(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:e.projectsMetadata?.map(e=>(0,t.jsxs)(O.Link,{href:`https://vercel.com/${a}/${e.name}`,className:"flex items-center gap-2 text-blue-600 hover:text-blue-800 text-sm",children:[(0,t.jsx)("p",{className:"text-copy-14 truncate",title:e.name,children:e.name}),(0,t.jsx)(y.ChevronRight,{className:"w-4 h-4"})]},e.id))})})]},e.id)}),d&&(0,t.jsx)("div",{className:"flex items-center justify-center",children:(0,t.jsx)(X,{expanded:s,onClick:()=>r(!s)})})]})]})}function et(){return(0,t.jsxs)(l.Fieldset,{type:"error",children:[(0,t.jsxs)(n.FieldsetContent,{children:[(0,t.jsx)(c.FieldsetTitle,{children:"Uninstall Integration"}),(0,t.jsx)(o.FieldsetSubtitle,{color:"gray-900",children:"Uninstalling your integration deletes all products linked to it."})]}),(0,t.jsx)(s.FieldsetFooter,{children:(0,t.jsx)(s.FieldsetFooter.Actions,{children:(0,t.jsx)(i.Button,{disabled:!0,type:"error",children:"Uninstall Integration"})})})]})}e.s(["MarketplaceUninstallIntegration",()=>H,"MarketplaceUninstallIntegrationPlaceholder",()=>et])},1452390,e=>{"use strict";var t=e.i(1146226),i=e.i(2504781),a=e.i(7137884),n=e.i(8517043),l=e.i(1232681),s=e.i(3500331),r=e.i(6891161),o=e.i(8522580),c=e.i(3895030),d=e.i(9792418),u=e.i(5468328),h=e.i(455575),x=e.i(5169864),m=e.i(5610834),p=e.i(119294),g=e.i(6352514),f=e.i(8042625),j=e.i(277234),y=e.i(4244280),b=e.i(1119178),v=e.i(4004502),N=e.i(4011256),C=e.i(588428),I=e.i(134877),k=e.i(8843717),w=e.i(7164486),T=e.i(5561425),S=e.i(2704354),A=e.i(4987761),P=e.i(2333337);function M(){return(0,t.jsxs)(n.Fieldset,{children:[(0,t.jsxs)(a.FieldsetContent,{children:[(0,t.jsx)(d.FieldsetTitle,{children:"Transfer Integration"}),(0,t.jsx)(c.FieldsetSubtitle,{color:"gray-900",children:"To transfer this integration please disconnect all the projects linked to this this integration's resources."})]}),(0,t.jsx)(l.FieldsetFooter,{children:(0,t.jsx)(l.FieldsetFooter.Actions,{children:(0,t.jsx)(i.Button,{disabled:!0,children:"Transfer Integration"})})})]})}function L(e){let{loading:i,originatingTeam:a,configuration:n,resources:l,active:s,complete:o,error:c,onCancel:d,transferInstallation:u,onCompleted:h}=e,[m,p]=(0,x.useState)(null),[g,f]=(0,x.useState)(),[j,y]=(0,x.useState)("Team"),[v,N]=(0,x.useState)(),{data:C}=(0,k.useInstallationPaymentMethodState)({integrationConfigurationId:n.id}),{createAuthorization:I}=(0,A.useMarketplaceBillingAuthorizationApi)(),w=(0,A.useAwaitAuthorization)(),T=(0,x.useCallback)(async()=>{if(!g)throw Error("Invalid state, no team selected");y("Provision");let e=function(e,t){let i,a,n,l,s=e.billingPlan?.scope||"resource",r=e.billingPlan?.id??e.lastAuthorization?.billingPlanId,o=e.billingPlan?.type==="prepayment"?0:void 0;if("resource"===s){for(let e of t){if(!l){l=e,a=e.metadata;continue}e.billingPlan?.preauthorizationAmount&&e.billingPlan.preauthorizationAmount>(l.billingPlan?.preauthorizationAmount??0)&&(l=e,a=e.metadata)}l&&(l.billingPlan?.type==="prepayment"&&(o=0),r=l.billingPlan?.id,i=l.id,a=l.metadata,n=l.product.id)}return{billingPlanId:r??"",metadata:a??{},resourceId:i,productId:n,integrationIdOrSlug:e.integrationId,integrationConfigurationId:e.id,prepaymentAmountCents:o}}(n,l),t=await I(a.id,{...e,overrideTeamForInstallationTransfer:g.id,paymentMethodId:v,overwritePreviousAuthorization:!0,source:"resource-claims"});if(p(t?.id??null),t){if("succeeded"!==(await w(g.id,t.id)).status)return;await u(g.id,t.id,v)}},[u,n,l,a,g,v,I,w]);return(0,t.jsxs)(r.Modal.Modal,{active:s,onClickOutside:function(){f(void 0),N(void 0),y("Team"),d()},width:500,children:["Team"!==j&&g?null:(0,t.jsx)(R,{integrationId:n.integrationId,loading:i,onCancel:d,onContinue:function(){N(void 0),C?.required?y("Card"):y("Confirm")},setTargetTeam:f,targetTeam:g,sourceTeamId:a.id}),"Card"===j&&g?(0,t.jsx)(E,{onBack:function(){y("Team")},onContinue:function(e){N(e),y("Confirm")},targetTeam:g}):null,"Confirm"===j&&g?(0,t.jsx)(D,{integrationSlug:n.slug,loading:i,onBack:function(){y("Card")},onConfirm:(0,b.promiseToCallback)(T)}):null,"Provision"===j&&g?(0,t.jsx)(P.ProvisioningStep,{authorizationId:m,complete:o,error:c,header:(0,t.jsx)(_,{}),isTransitioning:!1,onBack:()=>y("Confirm"),onChangePaymentMethod:function(){y("Card")},onNext:h,successMessage:"Funds have been added",teamId:g.id}):null]})}function _(){return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.Modal.Title,{children:"Transfer Integration"}),(0,t.jsx)(r.Modal.Subtitle,{children:"This integration will be transferred to the selected team."}),(0,t.jsx)(o.Note,{center:!0,fill:!0,label:"Warning",type:"error",variant:"contrast",children:"This action is only reversible from the selected team."})]})}function R(e){let{loading:i,integrationId:a,targetTeam:n,setTargetTeam:l,onCancel:s,onContinue:o,sourceTeamId:c}=e;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.Modal.Body,{children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-6 flex-initial",children:[(0,t.jsx)(_,{}),(0,t.jsx)(r.Modal.Inset,{last:!0,children:(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start gap-6 flex-initial",children:(0,t.jsx)("label",{children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[(0,t.jsx)("p",{className:"text-copy-14 text-gray-900",children:"Select a Vercel team to transfer the integration to:"}),(0,t.jsx)(T.TeamSelect,{account:n??void 0,integrationId:a,onChange:e=>{l(e)},type:"marketplace",excludeTeamId:c})]})})})})]})}),(0,t.jsxs)(r.Modal.Actions,{children:[(0,t.jsx)(r.Modal.Action,{disabled:i,onClick:s,type:"secondary",children:"Cancel"}),(0,t.jsx)(r.Modal.Action,{disabled:i||!n,loading:i,onClick:o,type:"default",children:"Continue"})]})]})}function E(e){let{targetTeam:i,onBack:a,onContinue:n}=e;return(0,t.jsx)(w.SelectPaymentMethodActionForTeam,{cancelLabel:"Back",continueLabel:"Continue",onAbort:a,onContinue:n,team:i})}function D(e){let{active:i,integrationSlug:a,loading:n,onBack:l,onConfirm:o}=e,c=(0,x.useRef)(null),d="transfer my integration";(0,x.useEffect)(()=>{i&&requestAnimationFrame(()=>{let e=Array.from(c.current?.elements??[]);e.find(e=>"INPUT"===e.tagName)?.focus()})},[i]);let u=(0,x.useCallback)(e=>{e.preventDefault(),c.current?.checkValidity()&&o()},[o]);return(0,t.jsxs)("form",{onSubmit:u,ref:c,children:[(0,t.jsx)(r.Modal.Body,{children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-6 flex-initial",children:[(0,t.jsx)(_,{}),(0,t.jsx)(r.Modal.Inset,{last:!0,children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-6 flex-initial",children:[(0,t.jsx)("label",{children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[(0,t.jsxs)("p",{className:"text-copy-14 text-gray-900",children:["Enter the integration slug"," ",(0,t.jsx)("b",{style:{overflowWrap:"anywhere"},children:a})," ","to continue:"]}),(0,t.jsx)(s.Input,{"aria-label":"Integration Slug",name:"integrationSlug",pattern:`\\s*${a}\\s*`,required:!0})]})}),(0,t.jsx)("label",{children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[(0,t.jsxs)("p",{className:"text-copy-14 text-gray-900",children:["To verify, type ",(0,t.jsx)("b",{children:d})," below:"]}),(0,t.jsx)(s.Input,{"aria-label":"Verification Code",name:"verificationText",pattern:`\\s*${d}\\s*`,required:!0})]})})]})})]})}),(0,t.jsxs)(r.Modal.Actions,{children:[(0,t.jsx)(r.Modal.Action,{disabled:n,onClick:l,type:"secondary",children:"Back"}),(0,t.jsx)(r.Modal.Action,{buttonType:"submit",disabled:n,loading:n,children:"Continue"})]})]})}let O=(0,e.i(9588822).withStripe)(function(e){let{integration:s,configuration:r,resources:o,team:b,canTransfer:k}=e,w="marketplace"===r.installationType,T=!k||!w,A=(0,h.useToasts)(),P=(0,m.useRouter)(),[M,_]=(0,x.useState)(!1),[R,E]=(0,x.useState)(!1),[D,O]=(0,x.useState)(!1),F=(0,x.useCallback)(()=>_(!0),[]),B=(0,x.useCallback)(()=>_(!1),[]),[U,q]=(0,x.useState)(void 0),{value:$,isReady:V}=(0,C.useMarketplaceIntegrationConfigurationTransferToTeam)(),W=(0,x.useCallback)(()=>{let e=(0,N.getMarketplaceInstallationsLink)({teamSlug:b.slug});P.push(e)},[P,b.slug]),z=(0,x.useCallback)(async(e,t,i)=>{E(!0);let a=(0,f.encode)({teamId:b.id});try{if("marketplace"!==r.installationType)throw Error("Integration is not from the marketplace");await (0,j.fetchAPI)(`${y.API_INTEGRATION_CONTROLLER_V2}/installations/${r.id}/transfer${a}`,{method:"POST",body:{toTeamId:e,authorizationId:t,newInstallationPaymentMethodId:i},throwOnHTTPError:!0}),p.analytics.track(g.AnalyticsEvent.INTEGRATION_CONFIGURATION_TEAM_TRANSFER_SUCCEEDED),p.analytics.track(g.AnalyticsEvent.INTEGRATION_UNINSTALLED,{integration_id:s.id,integration_slug:s.slug,source:"installation view",target:"team"}),O(!0),W()}catch(t){let e="Failed to transfer integration";(0,I.isAPIError)(t)&&(e=t.message),A.error(e),q(e),E(!1)}},[r,s.id,s.slug,b,A,W]);return((0,x.useEffect)(()=>{M&&p.analytics.track(g.AnalyticsEvent.INTEGRATION_CONFIGURATION_REMOVE_MODAL_OPENED)},[M]),(0,S.isMarketplaceInstallation)(r)&&V&&$)?(0,t.jsxs)(n.Fieldset,{children:[(0,t.jsxs)(a.FieldsetContent,{children:[(0,t.jsx)(d.FieldsetTitle,{children:"Transfer Integration"}),(0,t.jsx)(c.FieldsetSubtitle,{color:"gray-900",children:"To transfer this integration please delete all the projects linked to this integration's resources."})]}),(0,t.jsx)(l.FieldsetFooter,{children:(0,t.jsx)(l.FieldsetFooter.Actions,{children:(0,t.jsxs)(u.Tooltip,{disableTriggers:!T,text:function(e){let{canTransferIntegration:t}=e;return t?"You need additional permissions to transfer integrations.":"Delete all the project connections before transferring the integration"}({canTransferIntegration:w}),children:[(0,t.jsx)(i.Button,{"data-testid":(0,v.tid)("integration","transfer"),disabled:T,onClick:F,children:"Transfer Integration"}),(0,t.jsx)(L,{active:M,originatingTeam:b,configuration:r,resources:o,loading:R,onCancel:()=>{p.analytics.track(g.AnalyticsEvent.INTEGRATION_CONFIGURATION_REMOVE_CANCELED),B()},transferInstallation:z,onCompleted:W,complete:D,error:U})]})})})]}):null});e.s(["MarketplaceTransferIntegration",0,O,"MarketplaceTransferIntegrationPlaceholder",()=>M])}]);

//# debugId=37a84b8f-da83-7991-ff93-4325d2dc5af7
//# sourceMappingURL=39c8bf88bceba07d.js.map