;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="d75efa2e-381c-fd99-6568-601de68e92cd")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,5978342,9947482,e=>{"use strict";var t=e.i(1146226),i=e.i(5468328),s=e.i(8459493),r=e.i(5169864),n=e.i(6625227),a=e.i(9719784),o=e.i(57106),l=e.i(9668517),c=e.i(1857939),d=e.i(5229375),p=e.i(5709282),u=e.i(2695633),h=e.i(8518548),m=e.i(6318858),x=e.i(2560270),f=e.i(8674454),y=e.i(6694387),g=e.i(4991687),j=e.i(5326905),v=e.i(9722978);function b(e){let{values:n,selectedValue:a,onChange:o,disabled:l,ariaLabel:c,width:d,className:p,children:u}=e,[h,b]=(0,r.useState)(!1),I=Object.entries(n).map(e=>{let[t,i]=e;return{value:t,...i}});return(0,t.jsxs)(g.MenuContainer,{position:"bottom-end",children:[(0,t.jsx)(y.MenuButton,{align:"start","aria-label":c,disabled:l,onClick:()=>b(!1),shape:"square",style:{padding:"0 var(--geist-gap-half)",width:d},suffix:(0,t.jsx)(x.ChevronDown,{}),svgOnly:!0,type:"secondary",typeName:"button",className:p,children:(0,t.jsx)("p",{className:"text-copy-14",children:n[a].label})}),(0,t.jsxs)(f.Menu,{style:{display:h?"none":void 0},width:d+160,children:[I.map(e=>{let{value:n,label:l,description:c,disabledDescription:d,legacy:p,upgradeButton:u,divider:x}=e;return x?(0,t.jsx)(j.MenuDivider,{},n):(0,t.jsx)(s.MenuItem,{disabled:!!d,onClick:()=>{n!==a&&o(n)},style:{height:"auto",padding:"var(--geist-space-gap-quarter)",pointerEvents:d?"auto":"inherit",cursor:d?"not-allowed":"pointer"},suffix:a===n?(0,t.jsx)(m.Check,{}):null,children:(0,t.jsx)(i.Tooltip,{delay:!1,desktopOnly:!0,disableTriggers:!d,forceHide:h,maxWidth:324,position:"right",style:{width:"100%"},text:d,children:(0,t.jsxs)("div",{className:"flex flex-row items-center justify-between gap-2 flex-initial",style:{width:"100%"},children:[(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-center flex-initial",children:[(0,t.jsx)("p",{className:(0,v.default)("text-copy-14",d||p?"text-gray-700":"text-gray-1000"),children:l}),(0,t.jsx)("p",{className:(0,v.default)("text-copy-14",d||p?"text-gray-700":"text-gray-900"),children:c})]}),u?(0,r.cloneElement)(u,{onClick:()=>{b(!0),u.props?.onClick?.()}}):null]})})},n)}),u]})]})}e.s(["Selector",()=>b],9947482);let I={legacy:!0,label:"(Legacy) Pre-Production Deployments",description:"Protect only Pre-Production Deployments. This does not include past production deployments."},w={label:"Production Deployments",description:"Protect only production deployments."},P={label:"All Deployments",description:"Protect all domains."};function N(e){let{overrides:m,project:x,selectedValue:f,currentValue:y,...g}=e,{data:j}=(0,n.default)(x?.targets?.production?.id),{allAliases:v}=function(e,t){let{isLoggedOut:i}=(0,c.useIsLoggedIn)(),s=(0,l.useTeamSlug)()??void 0,{data:n,mutate:a,isLoading:o}=(0,d.useAliasesV2)({deploymentId:e?.id,teamId:s},void 0),m=o?void 0:n||{aliases:[]},x=(0,r.useRef)({branchDomain:"",otherDomains:[],allAliases:[],isLoading:!i,mutate:a}),f=(0,u.getGitMeta)(e?.meta)?.branchName,{data:y,isLoading:g}=(0,h.useProjectDomains)(f&&e?.projectId,{gitBranch:f});if(m?.aliases&&(x.current.isLoading||m.aliases.length)){let t=m.aliases.slice(),i=e?.meta.branchAlias||"";for(let{name:e}of(i&&!t.some(e=>e.alias===i)&&t.push({alias:i,uid:"",createdAt:0,updatedAt:0}),(g?void 0:y||[])??[]))t.some(t=>t.alias===e)||t.push({alias:e,uid:"",createdAt:0,updatedAt:0});let s=(0,p.getSortedNonRedirectDomains)(t.map(e=>({name:e.alias,...e}))),r=s.map(e=>e.name);if(e?.meta.branchAlias){let e=r.indexOf(i);-1!==e&&r.splice(e,1)}x.current={branchAlias:t.find(e=>e.alias===i),branchDomain:i,otherDomains:r,allAliases:s,isLoading:o&&!n||g&&!y,mutate:a}}return x.current.mutate=a,x.current}(j),N=v.map(e=>{let{alias:t}=e;return t}),[C,{domains:k}]=(0,h.useProjectDomainsInfinite)(x?.id,{production:!0,redirects:!1}),A="prod_deployment_urls_and_all_previews"===y||"preview"===y,T=A||x?.createdAt&&new Date(x.createdAt)<new Date("2025-07-21"),[S,E]=(0,r.useState)(A),D={all_except_custom_domains:{...(e=>{let{protectedDomains:s}=e,r=s?.length||0;return{label:"Standard Protection",description:(0,t.jsxs)("span",{className:"text-copy-14 text-inherit",children:["Protect all except production"," ",(0,t.jsx)(i.Tooltip,{desktopOnly:!0,maxWidth:350,text:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[(0,t.jsxs)("p",{className:"text-copy-14",children:["Only ",r>1?`these ${r} domains`:"this domain"," will be publicly accessible."]}),(0,t.jsx)("span",{className:"flex flex-wrap gap-1",children:s?.slice(0,20)?.map(e=>(0,t.jsx)(a.default,{icon:!0,title:e,truncate:!0,url:e}))}),r>20?(0,t.jsx)("p",{className:"text-copy-14",children:(0,t.jsx)(o.Link,{href:"domains",variant:"underline",children:"See all project domains"})}):null]}),children:(0,t.jsx)("u",{style:{cursor:"help",textDecorationStyle:"dotted",textUnderlineOffset:2},children:"Custom Domains"})})," ","for your project."]})}})({protectedDomains:k.map(e=>{let{name:t}=e;return t})}),...m?.all_except_custom_domains},...m?.production?{production:{...w,...m.production}}:{},all:{...P,...m?.all},...S?{divider:{divider:!0},prod_deployment_urls_and_all_previews:{...(e=>{let{productionAliases:s}=e,r=s?.length||0,n="Standard Protection";n="(Legacy) Standard Protection";let l=s?.find(e=>e.includes("-git-"));return{label:n,legacy:!0,description:(0,t.jsxs)("span",{className:"text-copy-14 text-inherit",children:["Protect all except the"," ",(0,t.jsx)(i.Tooltip,{desktopOnly:!0,maxWidth:350,text:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[(0,t.jsxs)("p",{className:"text-copy-14",children:["Only"," ",r>1?`these ${r} domains`:"this domain"," ","will be publicly accessible."]}),(0,t.jsx)("span",{className:"flex flex-wrap gap-1",children:s?.slice(0,20)?.map(e=>(0,t.jsx)(a.default,{icon:!0,title:e,truncate:!0,url:e}))}),r>20?(0,t.jsx)("p",{className:"text-copy-14",children:(0,t.jsx)(o.Link,{href:"domains",variant:"underline",children:"See all project domains"})}):null]}),children:(0,t.jsx)("u",{style:{cursor:"help",textDecorationStyle:"dotted",textUnderlineOffset:2},children:"up-to-date Production Domains"})})," ","for your project. This does not include auto-generated production domains",l?`, such as ${l}`:"","."]})}})({productionAliases:N}),...m?.prod_deployment_urls_and_all_previews},preview:{...I,...m?.preview}}:void 0};return(0,t.jsx)(b,{ariaLabel:"Select the deployment type for the protection",values:D,width:300,selectedValue:f,...g,children:T&&!S?(0,t.jsx)(s.MenuItem,{onClick:e=>{e.preventDefault(),E(!0)},innerMenuItemClassName:"h-8",children:(0,t.jsx)("span",{className:"text-center w-full inline-block text-gray-900 text-sm cursor-pointer",role:"button",children:"See legacy options"})}):null})}e.s(["DeploymentTypeSelector",()=>N],5978342)},7799383,e=>{"use strict";var t=e.i(1146226),i=e.i(2988836),s=e.i(5169864),r=e.i(5468328),n=e.i(9722978);function a(e){let{project:a,className:o}=e,l=(0,s.useMemo)(()=>{if(!a)return null;let e=[];return a.trustedIps&&("additional"===a.trustedIps.protectionMode?e.push("Additionally, only visitors from an IP address in Trusted IPs can access deployments."):e.push("Visitors from an allowed IP address in Trusted IPs will bypass protection.")),e.push("Shareable Links, Protection Bypass for Automation, and Deployment Protection Exceptions will bypass protection."),e.join(" ")},[a]);return(0,t.jsx)(r.Tooltip,{text:l,className:(0,n.clsx)("cursor-pointer",o),children:(0,t.jsx)(i.InformationFillSmall,{})})}e.s(["ExceptionsInfo",()=>a])},3154500,e=>{"use strict";var t=e.i(1146226),i=e.i(5169864),s=e.i(1906681),r=e.i(455575),n=e.i(8522580),a=e.i(57106),o=e.i(119294),l=e.i(6352514),c=e.i(7917902),d=e.i(1717203),p=e.i(7557283),u=e.i(3802983),h=e.i(5807088),m=e.i(8188735),x=e.i(6060673),f=e.i(3555274),y=e.i(1138941),g=e.i(9068719),j=e.i(185801),v=e.i(5978342),b=e.i(7799383),I=e.i(9367781),w=e.i(9722978);let P="__VERCEL_PASS__";function N(){let e=(0,r.useToasts)(),h=(0,y.useProjectIdOrName)(),{data:N,mutate:k}=(0,x.useProject)(h),A=(0,c.useAccount)(),{can:T,isLoading:S}=(0,d.default)(),{user:E,team:D}=A,[R,_]=(0,i.useState)(!!N?.passwordProtection),[M,O]=(0,i.useState)(""),L="all_except_custom_domains",[$,B]=(0,i.useState)(N?.passwordProtection?.deploymentType||L),[V,F]=(0,i.useState)(!1),[H,z]=(0,i.useState)(null),[U,q]=(0,i.useState)(!1),W=(0,i.useCallback)(async()=>{F(!0);try{o.analytics.track(l.AnalyticsEvent.DEPLOYMENT_PROTECTION_TOGGLE_PASSWORD_PROTECTION,{enabled:R,protectProductionEnvironment:"all"===$,projectId:h}),z(null);let t=M&&M!==P?M:null;await (0,m.default)(h,D?.id,{passwordProtection:R?{deploymentType:$,password:t||void 0}:null}),e.success("Updated Password Protection successfully."),await k()}catch(e){z(e.message)}F(!1),q(!1)},[h,k,D,e,R,$,M]),Y=(0,i.useCallback)(e=>{_(e),q(!0)},[]),G=(0,i.useCallback)(()=>{M===P&&O("")},[M]),J=(0,i.useCallback)(()=>{""===M&&N?.passwordProtection&&O(P)},[N?.passwordProtection,M]),K=(0,i.useCallback)(e=>{O(e),q(!0)},[]),Z=(0,i.useCallback)(e=>{B(e),q(!0)},[]);(0,i.useEffect)(()=>{_(!!N?.passwordProtection),O(N?.passwordProtection?P:""),B(N?.passwordProtection?.deploymentType||L)},[N?.passwordProtection,L]);let{addOn:Q,isADPEnabled:X,enableADP:ee,ADPModal:et}=(0,g.useToggleAdvancedDeploymentProtection)("project-settings-password-protection"),{enabled:ei,message:es,action:er}=(0,f.default)({addOn:Q,isEnabled:X,enable:ee,modal:et}),en=!N||!(D||E)||S,ea=T(p.Action.Update,p.Resource.Project),eo=T(p.Action.Create,p.Resource.PasswordProtection),el=ea&&M&&U,ec=(0,i.useCallback)(()=>ea?ei?(0,t.jsxs)("p",{className:"text-copy-14 text-gray-900",children:["Learn more about"," ",(0,t.jsx)(a.Link,{external:!0,href:"/docs/security/deployment-protection/methods-to-protect-deployments/password-protection",type:"highlight",children:"Password Protection"})]}):eo?es:(0,t.jsxs)("p",{className:"text-copy-14 text-gray-900",children:["You need additional permissions to enable"," ",(0,t.jsx)(a.Link,{external:!0,href:"/docs/security/deployment-protection/methods-to-protect-deployments/password-protection",type:"highlight",children:"Password Protection"})," ","for your project."]}):(0,t.jsxs)("p",{className:"text-copy-14 text-gray-900",children:["You need additional permissions to manage your project's"," ",(0,t.jsx)(a.Link,{external:!0,href:"/docs/security/deployment-protection/methods-to-protect-deployments/password-protection",type:"highlight",children:"Password Protection"}),"."]}),[ea,ei,es,eo]);if(en)return(0,t.jsx)(C,{});let ed=V||!R,ep=!ea||!ei;return(0,t.jsx)(j.ProjectSettingsFieldset,{action:eo?er:void 0,description:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:[(0,t.jsx)("span",{className:"text-copy-14",children:"Ensures visitors to your deployments must enter a password in order to gain access."}),N.appliedCve55182Migration&&N.passwordProtection?.deploymentType==="prod_deployment_urls_and_all_previews"?(0,t.jsxs)(n.Note,{label:!1,type:"warning",children:["Password protection was automatically upgraded for this project due to"," ",(0,t.jsx)(a.Link,{href:"/changelog/cve-2025-55182",external:!0,variant:"highlight",children:"CVE-2025-55182"}),"to protect old deployments. To override this, this setting can be updated to a new value."]}):null]}),disabled:!ea,disabledForBilling:ep,error:H,highlightNote:!ea,headerNote:R?(0,t.jsx)(I.MicrofrontendsHelpBadge,{childHelp:"This configuration only applies to domains belonging to this project.",parentHelp:"This configuration applies to production and pre-production deployments for the group."}):null,note:ec(),onSave:ei?W:null,saveDisabled:!el,saveLoading:V,title:"Password Protection",children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:[(0,t.jsxs)("div",{className:"flex flex-row items-center gap-2 md:gap-4 flex-initial flex-wrap justify-between md:justify-start",children:[(0,t.jsx)("div",{className:"flex flex-row items-center justify-start gap-2 flex-initial",style:{padding:"var(--geist-gap-quarter) 0"},children:(0,t.jsx)(s.Toggle,{"aria-labelledby":"label-for-password-protection-enabled-toggle",checked:R,direction:"switch-first",onChange:Y,size:"large",children:(0,t.jsx)("p",{className:(0,w.default)("text-[14px] leading-[20px] font-medium normal-case",R?"text-gray-1000":"text-gray-900",ep?"text-gray-800":void 0),id:"label-for-password-protection-enabled-toggle",children:R?"Enabled for":"Disabled"})})}),R?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(v.DeploymentTypeSelector,{disabled:ed,onChange:Z,currentValue:N?.passwordProtection?.deploymentType,project:N,selectedValue:$,className:"order-3 md:order-none"}),(0,t.jsx)(b.ExceptionsInfo,{project:N,className:"order-2 md:order-none"})]}):null]}),(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[(0,t.jsx)("p",{className:"text-[12px] leading-[16px] font-medium text-gray-900 uppercase",id:"label-for-password-protection-password-input",children:"Password"}),(0,t.jsx)(u.default,{"aria-labelledby":"label-for-password-protection-password-input",autoFocus:U,disabled:ed,maxLength:72,onBlur:J,onChange:e=>K(e.target.value),onFocus:G,placeholder:ed?"":"Enter password",typeName:"password",value:M,width:"290px"},`input-focus-on-change-${R.toString()}`)]})})]})})}function C(){return(0,t.jsx)(h.default,{height:170})}function k(){return(0,t.jsx)(i.Suspense,{fallback:(0,t.jsx)(C,{}),children:(0,t.jsx)(N,{})})}e.s(["PasswordProtection",()=>k])},9300544,e=>{"use strict";var t=e.i(1146226),i=e.i(5169864),s=e.i(8522580),r=e.i(1906681),n=e.i(5468328),a=e.i(455575),o=e.i(57106),l=e.i(119294),c=e.i(6352514),d=e.i(7837522),p=e.i(7780974),u=e.i(7917902),h=e.i(1717203),m=e.i(7557283),x=e.i(5807088),f=e.i(8188735),y=e.i(6060673),g=e.i(1138941),j=e.i(3555274),v=e.i(9068719),b=e.i(185801),I=e.i(5978342),w=e.i(7799383),P=e.i(9367781),N=e.i(9722978);function C(){let e=(0,g.useProjectIdOrName)(),{data:x,mutate:C}=(0,y.useProject)(e),{user:A,team:T}=(0,u.useAccount)(),{can:S,isLoading:E}=(0,h.default)(),[D,R]=(0,i.useState)(!!x?.ssoProtection),_="all_except_custom_domains",[M,O]=(0,i.useState)(x?.ssoProtection?.deploymentType||_),[L,$]=(0,i.useState)(!1),[B,V]=(0,i.useState)(null),F=(0,a.useToasts)(),{track:H}=(0,d.useTrackActivity)(),z=T?.standaloneTrustedIps?.enabled||!1,U=x?.trustedIps?.deploymentType&&"production"!==x.trustedIps.deploymentType,q=(0,i.useCallback)(async()=>{$(!0),V(null);try{l.analytics.track(c.AnalyticsEvent.DEPLOYMENT_PROTECTION_TOGGLE_VERCEL_AUTHENTICATION,{enabled:D,protectProductionEnvironment:"all"===M,projectId:e}),H(p.VercelActivityAction.ProjectSettingsUpdated,{name:"vercel-authentication",projectId:e,teamId:T?.id||"",value:{enabled:D,deploymentType:M}}),await (0,f.default)(e,T?.id,{ssoProtection:D?{deploymentType:M}:null}),F.success("Updated Vercel Authentication successfully."),await C()}catch(e){V(e.message)}$(!1)},[e,C,T,F,D,M,H]),W=(0,i.useCallback)(()=>{R(!D)},[R,D]),Y=(0,i.useCallback)(e=>{O(e)},[]);(0,i.useEffect)(()=>{R(!!x?.ssoProtection),O(x?.ssoProtection?.deploymentType||_)},[x?.ssoProtection,_]);let{addOn:G,isADPEnabled:J,enableADP:K,ADPModal:Z}=(0,v.useToggleAdvancedDeploymentProtection)("project-settings-vercel-auth"),{message:Q,action:X}=(0,j.default)({addOn:G,isEnabled:J,enable:K,modal:Z}),ee=!x||!(T||A)||E,et=S(m.Action.Update,m.Resource.Project);if(ee)return(0,t.jsx)(k,{});let ei=null===T&&A?.billing?.plan==="hobby",es=!!x.ssoProtection!==D||x.ssoProtection?.deploymentType&&x.ssoProtection.deploymentType!==M,er=!z&&U;return(0,t.jsx)(b.ProjectSettingsFieldset,{description:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:[ei?(0,t.jsx)("span",{className:"text-copy-14",children:"Ensures visitors to your deployments are logged in to Vercel."}):(0,t.jsx)("span",{className:"text-copy-14",children:"Ensures visitors to your deployments are logged in to Vercel and are a member of your team."}),x.appliedCve55182Migration&&x.ssoProtection?.deploymentType==="prod_deployment_urls_and_all_previews"?(0,t.jsxs)(s.Note,{label:!1,type:"warning",children:["Deployment protection was automatically enabled for this project due to"," ",(0,t.jsx)(o.Link,{href:"/changelog/cve-2025-55182",external:!0,variant:"highlight",children:"CVE-2025-55182"}),"to protect old deployments. To override this, this setting can be updated to a new value."]}):null]}),disabled:!et,error:B,highlightNote:!et,note:et?(0,t.jsxs)("p",{className:"text-copy-14 text-gray-900",children:["Learn more about"," ",(0,t.jsx)(o.Link,{external:!0,href:"/docs/security/deployment-protection/methods-to-protect-deployments/vercel-authentication",type:"highlight",children:"Vercel Authentication"})]}):(0,t.jsxs)("p",{className:"text-copy-14 text-gray-900",children:["You need additional permissions to manage your project's"," ",(0,t.jsx)(o.Link,{external:!0,href:"/docs/security/deployment-protection/methods-to-protect-deployments/vercel-authentication",type:"highlight",children:"Vercel Authentication"})]}),onSave:q,saveDisabled:!es,saveLoading:L,title:"Vercel Authentication",headerNote:(0,t.jsx)(P.MicrofrontendsHelpBadge,{childHelp:(0,t.jsxs)(t.Fragment,{children:["This configuration applies only to this project's domains. It's recommended to protect"," ",(0,t.jsx)("span",{className:"text-[14px] leading-[20px] font-medium text-inherit",children:"All Deployments"})," ","for a child microfrontends project."]}),parentHelp:(0,t.jsxs)(t.Fragment,{children:["This configuration applies to production and pre-production deployments for the group. It's recommended to use"," ",(0,t.jsx)("span",{className:"text-[14px] leading-[20px] font-medium text-inherit",children:"Standard Protection"})," ","for the default app microfrontends project."]})}),children:(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:(0,t.jsxs)("div",{className:"flex flex-row items-center gap-2 md:gap-4 flex-initial flex-wrap justify-between md:justify-start",children:[(0,t.jsx)("div",{className:"flex flex-row items-center justify-start gap-2 flex-initial",style:{padding:"var(--geist-gap-quarter) 0"},children:(0,t.jsx)(n.Tooltip,{desktopOnly:!0,forceHide:!D||!er,text:"Trusted IPs can not be enabled in preview environments without Vercel Authentication.",children:(0,t.jsx)(r.Toggle,{"aria-labelledby":"label-for-vercel-auth-enabled-toggle",checked:D,direction:"switch-first",disabled:!!(D&&er),onChange:W,size:"large",children:(0,t.jsx)("p",{className:(0,N.default)("text-[14px] leading-[20px] font-medium normal-case",D?"text-gray-1000":"text-gray-900"),id:"label-for-vercel-auth-enabled-toggle",children:D?"Enabled for":"Disabled"})})})}),D?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(I.DeploymentTypeSelector,{disabled:L,onChange:Y,currentValue:x?.ssoProtection?.deploymentType,overrides:{all:{disabledDescription:Q,upgradeButton:X}},project:x,selectedValue:M,className:"order-3 md:order-none"}),(0,t.jsx)(w.ExceptionsInfo,{project:x,className:"order-2 md:order-none"})]}):null]})})})}function k(){return(0,t.jsx)(x.default,{height:88})}function A(){return(0,t.jsx)(i.Suspense,{fallback:(0,t.jsx)(k,{}),children:(0,t.jsx)(C,{})})}e.s(["VercelAuth",()=>A])},8532682,e=>{e.v({autoHeight:"deployment-protection-module__HaauuW__autoHeight",minHeight:"deployment-protection-module__HaauuW__minHeight",noBorder:"deployment-protection-module__HaauuW__noBorder",snippetButton:"deployment-protection-module__HaauuW__snippetButton"})},4999769,e=>{"use strict";var t=e.i(1146226),i=e.i(5169576),s=e.i(762945),r=e.i(8522580),n=e.i(1900556),a=e.i(5339191);function o(e){let{type:o,keyName:l,children:c}=e;return(0,t.jsx)(a.AnimatePresence,{children:c?(0,t.jsx)(n.m.div,{animate:{height:"auto",opacity:1,marginTop:0},exit:{height:0,opacity:0,marginTop:"var(--geist-space-4x-negative)"},initial:{height:0,opacity:0,marginTop:"var(--geist-space-4x-negative)"},style:{overflow:"hidden"},transition:{ease:"easeInOut"},children:(0,t.jsx)(r.Note,{fill:!0,label:!1,style:{backgroundColor:"warning"===o?void 0:"var(--ds-gray-100)",border:"none",color:"warning"===o?void 0:"var(--accents-6)"},type:o,variant:"contrast",children:(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-2 flex-initial",children:["warning"===o?(0,t.jsx)(s.Warning,{className:"-mb-px shrink-0"}):(0,t.jsx)(i.Information,{className:"shrink-0"}),c]})})},l):null})}e.s(["AnimatedNote",()=>o])},3982440,e=>{"use strict";var t=e.i(1146226),i=e.i(5169864),s=e.i(9722978),r=e.i(2504781),n=e.i(6891161),a=e.i(455575),o=e.i(5468328),l=e.i(8459493),c=e.i(3500331),d=e.i(7448864),p=e.i(5255926),u=e.i(4585051),h=e.i(3973638),m=e.i(1933683),x=e.i(57106),f=e.i(119294),y=e.i(6352514),g=e.i(7917902),j=e.i(5927860),v=e.i(6198010),b=e.i(1717203),I=e.i(7557283),w=e.i(5819220),P=e.i(4712634),N=e.i(979715),C=e.i(6060673),k=e.i(1138941),A=e.i(4595422),T=e.i(2882012),S=e.i(7188996),E=e.i(6899807),D=e.i(7188420),R=e.i(5807088),_=e.i(185801),M=e.i(8532682),O=e.i(4999769),L=e.i(7743427),$=e.i(1991452),B=e.i(4011256),V=e.i(9668517),F=e.i(9367781);let H="VERCEL_AUTOMATION_BYPASS_SECRET";function z(){let e=(0,k.useProjectIdOrName)(),{data:n,mutate:p}=(0,C.useProject)(e),{can:u,isLoading:h}=(0,b.default)(),{user:m,team:w}=(0,g.useAccount)(),P=n?(0,A.getProtectionBypass)(n,"automation-bypass"):null,[N,S]=(0,i.useState)(null),[R,_]=(0,i.useState)(!1),[L,$]=(0,i.useState)(null),[B,V]=(0,i.useState)(!1),z=(0,i.useRef)(null),[G,J]=(0,i.useState)(null),K=!n||!(w||m)||h,Z=u(I.Action.Update,I.Resource.Project),Q=u(I.Action.Read,I.Resource.ProjectProtectionBypass),X=Z&&u(I.Action.Delete,I.Resource.ProjectProtectionBypass),ee=Z&&u(I.Action.Update,I.Resource.ProjectProtectionBypass),et=Z&&u(I.Action.Create,I.Resource.ProjectProtectionBypass),ei=(0,i.useCallback)(async t=>{S(null),_(!0);try{let i="Created";switch(t.revoke&&(i=t.generate?.secret?"Updated":t.revoke.regenerate?"Regenerated":"Deleted"),i){case"Deleted":case"Created":f.analytics.track(y.AnalyticsEvent.DEPLOYMENT_PROTECTION_TOGGLE_BYPASS_FOR_AUTOMATION,{enabled:"Created"===i,projectId:e});break;case"Updated":case"Regenerated":f.analytics.track(y.AnalyticsEvent.DEPLOYMENT_PROTECTION_REGENERATE_BYPASS_HEADER,{projectId:e})}await (0,T.updateProjectProtectionBypass)({teamId:w?.id,projectIdOrName:e,body:t}),a.toasts.success(`${i} Automation Bypass successfully.`)}catch(e){S(`Request failed: ${e.message}`)}await p(),_(!1)},[e,w?.id,p]),es=async(e,t)=>{let{value:i}=t;if(!i)throw Error("Please enter a 32 character secret.");if(32!==i.length)throw Error(`Secret must be 32 characters long. Currently it is ${i.length} characters long.`);if(!/^[a-zA-Z0-9]{32}$/.test(i))throw Error("Secret can only contain letters and numbers.");return ei({revoke:{secret:e,regenerate:!0},generate:i?{secret:i}:void 0})},er=(0,i.useCallback)(async()=>{L&&(await ei({revoke:L}),$(null))},[L,ei]),en=(0,i.useCallback)(async()=>{let e=z.current?.value;await ei({generate:e?{secret:e}:void 0}),V(!1)},[ei,z]),ea=(0,i.useCallback)(()=>K?null:Z?(0,t.jsxs)("p",{className:"text-copy-14 text-gray-900",children:["Learn more about"," ",(0,t.jsx)(x.Link,{external:!0,href:"/docs/security/deployment-protection/methods-to-bypass-deployment-protection/protection-bypass-automation",type:"highlight",children:"Protection Bypass for Automation"})]}):(0,t.jsxs)("p",{className:"text-copy-14 text-gray-900",children:["You need additional permissions to manage your project's"," ",(0,t.jsx)(x.Link,{external:!0,href:"/docs/security/deployment-protection/methods-to-bypass-deployment-protection/protection-bypass-automation",type:"highlight",children:"Protection Bypass for Automation"}),"."]}),[Z,K]);if(K)return(0,t.jsx)(Y,{});let eo=!!(n.ssoProtection||n.passwordProtection||n.trustedIps),el={noPermission:et?null:"Missing the required permissions to create a secret.",noProtectionEnabled:eo||P?null:"No protections currently enabled for the project."},ec=el.noPermission||el.noProtectionEnabled,ed=Object.entries(n.protectionBypass||{}),ep=ed.filter(e=>{let[t,i]=e;return"automation-bypass"===i.scope}),eu=ed.filter(e=>{let[t,i]=e;return"integration-automation-bypass"===i.scope});return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(W,{action:P?null:(0,t.jsx)(r.Button,{disabled:!!ec,loading:R,onClick:()=>V(!0),prefix:(0,t.jsx)(v.Plus,{}),size:"small",children:(0,t.jsx)(o.Tooltip,{forceHide:!ec,text:ec,children:"Add Secret"})}),disabled:!(Q&&Z),disabledForBilling:!Q||!et&&!P,error:N,highlightNote:!Q,note:ea(),headerNote:(0,t.jsx)(F.MicrofrontendsHelpBadge,{childHelp:"This secret bypasses deployment protection for this project's routes. The default app's secret also applies to this project.",parentHelp:"This secret bypasses deployment protection for all projects in the microfrontends group."}),children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial mt-5",children:[(0,t.jsx)(O.AnimatedNote,{keyName:"automation-bypass-no-protection-enabled-note",children:P&&!eo?(0,t.jsx)("span",{children:"Protection Bypass for Automation with no protections enabled has no effect."}):null}),(0,t.jsx)(D.EntityCollapsible,{disableAnimation:!!G,disabled:!Z,emptyDescription:"Add a secret that can be used to bypass Deployment Protection for this project.",entities:ep.map(e=>{let[i,r]=e,n=G===i;return{key:`protection-bypass-${r.createdAt}`,component:(0,t.jsx)(E.EnvVarEntity,{additionalMenuItems:ee?(0,t.jsx)(l.MenuItem,{onClick:()=>{$({regenerate:!0,secret:i})},children:"Regenerate secret"}):(0,t.jsx)(d.MenuItemLocked,{children:"Regenerate secret"}),canReadProductionValues:Q,className:(0,s.clsx)(M.default.noBorder,M.default.minHeight),customSave:e=>es(i,e),disableComment:!0,disableDeleteEnvVariable:!X,disableEditEnvVariable:!ee,disableEnvironmentInput:!0,disableNameInput:!0,editTextareaValueProps:{rows:1,className:M.default.autoHeight,wrapperClassName:M.default.autoHeight},env:{id:"protection-bypass",type:j.EnvType.Encrypted,key:H,value:i,decrypted:!0,createdAt:r.createdAt,target:[j.EnvTarget.Preview,j.EnvTarget.Production],applyToAllCustomEnvironments:!0},isEditing:n,onRemove:()=>{$({regenerate:!1,secret:i})},setIsEditing:e=>J(e?i:null),team:w})}}),isLoading:K,title:"Secrets"}),eu.length>0?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{className:"text-copy-14 text-gray-900",style:{marginTop:"20px"},children:"Automation Protection Bypass created by integrations"}),(0,t.jsx)(D.EntityCollapsible,{disableAnimation:!!G,disabled:!Z,emptyDescription:"",entities:eu.map(e=>{let[i,s]=e;return{key:`integration-protection-bypass-${s.createdAt}`,component:(0,t.jsx)(U,{integrationAutomationBypass:s,secret:i})}}),isLoading:K,title:"Integration Secrets"})]}):null]})}),(0,t.jsxs)(q,{active:!!L,close:()=>$(null),loading:R,onConfirm:()=>void er(),title:L?.regenerate?"Regenerate Protection Bypass Secret":"Delete Protection Bypass Secret",children:[(0,t.jsx)("p",{className:"text-copy-14 text-gray-900",children:L?.regenerate?"Regenerating this secret will mean any automation services using the current secret will no longer work and may report errors until they are switched to the new secret.":"Deleting this secret will mean any automation services currently using it will no longer work and may report errors."}),(0,t.jsx)("p",{className:"text-copy-14 text-gray-900",children:"Are you sure you want to continue?"})]}),(0,t.jsxs)(q,{active:B,close:()=>V(!1),confirmButtonTitle:"Save",loading:R,onConfirm:()=>void en(),title:"Add Secret",children:[(0,t.jsx)("p",{className:"text-copy-14 text-gray-900",children:"Add a new secret to bypass Deployment Protection for this project."}),(0,t.jsx)(c.Input,{disabled:!0,label:"Environment Variable",title:"Environment Variable",value:H}),(0,t.jsx)(c.Input,{label:"Value",maxLength:32,minLength:32,placeholder:"Optionally specify a 32-character value",ref:z,title:"Value"})]})]})}function U(e){let{integrationAutomationBypass:s,secret:n}=e,{integration:a}=(0,L.useIntegration)(s.integrationId),o=(0,$.useRouter)(),[c,d]=(0,i.useState)(!1),p=`Click to ${c?"hide":"show"}`,x=(0,V.useTeamSlug)();return(0,t.jsxs)(w.Entity,{className:"!border-0",menuItems:[(0,t.jsx)(l.MenuItem,{onClick:()=>{x&&o.push((0,B.getInstallationDetailsLink)({teamSlug:x,integrationSlug:s.integrationId,configurationId:s.configurationId,isMarketplace:!0}))},children:"Manage"},"manage-integration")],thumbnail:(0,t.jsx)(P.EntityThumbnail,{size:24,children:(0,t.jsx)(u.Avatar,{size:24,hash:a?.icon})}),children:[(0,t.jsx)(N.EntityField,{width:"40%",title:a?.name}),(0,t.jsx)(N.EntityField,{children:(0,t.jsx)("div",{className:"flex flex-row items-stretch justify-start gap-2 flex-initial",children:(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-2 flex-initial",children:[(0,t.jsx)(r.Button,{"aria-label":p,onClick:()=>d(!c),svgOnly:!0,title:p,variant:"unstyled",children:c?(0,t.jsx)(h.EyeOff,{size:16}):(0,t.jsx)(m.Eye,{size:16})}),c?(0,t.jsx)(S.CopyInlineCode,{value:n}):(0,t.jsx)("p",{className:"text-copy-14 text-gray-900",children:"â€¢".repeat(15)})]})})})]})}function q(e){let{active:i,close:s,onConfirm:r,loading:a,title:o,children:l,confirmButtonTitle:c="Confirm"}=e;return(0,t.jsx)(n.Modal.Modal,{active:i,onClickOutside:s,width:480,children:(0,t.jsxs)("form",{onSubmit:e=>{e.preventDefault(),r()},children:[(0,t.jsx)(n.Modal.Body,{children:(0,t.jsx)(n.Modal.Header,{children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:[(0,t.jsx)("p",{className:"text-[20px] leading-[24px] tracking-[-0.33px] font-medium",children:o}),(0,t.jsx)(n.Modal.Subtitle,{children:(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:l})})]})})}),(0,t.jsxs)(n.Modal.Actions,{children:[(0,t.jsx)(n.Modal.Action,{onClick:s,type:"secondary",children:"Cancel"}),(0,t.jsx)(n.Modal.Action,{buttonType:"submit",loading:a,children:c})]})]})})}function W(e){let{children:i,note:s,...r}=e;return(0,t.jsx)(_.ProjectSettingsFieldset,{description:(0,t.jsxs)(t.Fragment,{children:["Enable access for automation services to protected deployments on this project. The secret is available as a"," ",(0,t.jsx)(x.Link,{href:"/docs/environment-variables/system-environment-variables",variant:"highlight",children:"System Environment Variable"})," ","in all deployments after the value is created. You can bypass Deployment Protection by setting an HTTP header or query parameter with the secret provided below named"," ",(0,t.jsx)(S.CopyInlineCode,{value:"x-vercel-protection-bypass"}),"."]}),note:s||(0,t.jsx)(p.Skeleton,{height:16,width:240}),title:"Protection Bypass for Automation",...r,children:i})}function Y(){return(0,t.jsx)(W,{note:"",children:(0,t.jsx)(D.LoadingState,{})})}function G(){return(0,t.jsx)(i.Suspense,{fallback:(0,t.jsx)(R.default,{}),children:(0,t.jsx)(z,{})})}e.s(["AutomationBypass",()=>G])},6827216,(e,t,i)=>{!function(e){"use strict";let i="(0?\\d+|0x[a-f0-9]+)",s={fourOctet:RegExp(`^${i}\\.${i}\\.${i}\\.${i}$`,"i"),threeOctet:RegExp(`^${i}\\.${i}\\.${i}$`,"i"),twoOctet:RegExp(`^${i}\\.${i}$`,"i"),longValue:RegExp(`^${i}$`,"i")},r=RegExp("^0[0-7]+$","i"),n=RegExp("^0x[a-f0-9]+$","i"),a="%[0-9a-z]{1,}",o="(?:[0-9a-f]+::?)+",l={zoneIndex:RegExp(a,"i"),native:RegExp(`^(::)?(${o})?([0-9a-f]+)?(::)?(${a})?$`,"i"),deprecatedTransitional:RegExp(`^(?:::)(${i}\\.${i}\\.${i}\\.${i}(${a})?)$`,"i"),transitional:RegExp(`^((?:${o})|(?:::)(?:${o})?)${i}\\.${i}\\.${i}\\.${i}(${a})?$`,"i")};function c(e,t){let i,s;if(e.indexOf("::")!==e.lastIndexOf("::"))return null;let r=0,n=-1,a=(e.match(l.zoneIndex)||[])[0];for(a&&(a=a.substring(1),e=e.replace(/%.+$/,""));(n=e.indexOf(":",n+1))>=0;)r++;if("::"===e.substr(0,2)&&r--,"::"===e.substr(-2,2)&&r--,r>t)return null;for(s=t-r,i=":";s--;)i+="0:";return":"===(e=e.replace("::",i))[0]&&(e=e.slice(1)),":"===e[e.length-1]&&(e=e.slice(0,-1)),{parts:t=function(){let t=e.split(":"),i=[];for(let e=0;e<t.length;e++)i.push(parseInt(t[e],16));return i}(),zoneId:a}}function d(e,t,i,s){let r;if(e.length!==t.length)throw Error("ipaddr: cannot match CIDR for objects with different lengths");let n=0;for(;s>0;){if((r=i-s)<0&&(r=0),e[n]>>r!=t[n]>>r)return!1;s-=i,n+=1}return!0}function p(e){if(n.test(e))return parseInt(e,16);if("0"===e[0]&&!isNaN(parseInt(e[1],10))){if(r.test(e))return parseInt(e,8);throw Error(`ipaddr: cannot parse ${e} as octal`)}return parseInt(e,10)}let u={};u.IPv4=function(){function e(e){let t,i;if(4!==e.length)throw Error("ipaddr: ipv4 octet count should be 4");for(t=0;t<e.length;t++)if(!(0<=(i=e[t])&&i<=255))throw Error("ipaddr: ipv4 octet should fit in 8 bits");this.octets=e}return e.prototype.SpecialRanges={unspecified:[[new e([0,0,0,0]),8]],broadcast:[[new e([255,255,255,255]),32]],multicast:[[new e([224,0,0,0]),4]],linkLocal:[[new e([169,254,0,0]),16]],loopback:[[new e([127,0,0,0]),8]],carrierGradeNat:[[new e([100,64,0,0]),10]],private:[[new e([10,0,0,0]),8],[new e([172,16,0,0]),12],[new e([192,168,0,0]),16]],reserved:[[new e([192,0,0,0]),24],[new e([192,0,2,0]),24],[new e([192,88,99,0]),24],[new e([198,18,0,0]),15],[new e([198,51,100,0]),24],[new e([203,0,113,0]),24],[new e([240,0,0,0]),4]],as112:[[new e([192,175,48,0]),24],[new e([192,31,196,0]),24]],amt:[[new e([192,52,193,0]),24]]},e.prototype.kind=function(){return"ipv4"},e.prototype.match=function(e,t){let i;if(void 0===t&&(e=(i=e)[0],t=i[1]),"ipv4"!==e.kind())throw Error("ipaddr: cannot match ipv4 address with non-ipv4 one");return d(this.octets,e.octets,8,t)},e.prototype.prefixLengthFromSubnetMask=function(){let e,t,i,s=0,r=!1,n={0:8,128:7,192:6,224:5,240:4,248:3,252:2,254:1,255:0};for(e=3;e>=0;e-=1){if(!((t=this.octets[e])in n)||(i=n[t],r&&0!==i))return null;8!==i&&(r=!0),s+=i}return 32-s},e.prototype.range=function(){return u.subnetMatch(this,this.SpecialRanges)},e.prototype.toByteArray=function(){return this.octets.slice(0)},e.prototype.toIPv4MappedAddress=function(){return u.IPv6.parse(`::ffff:${this.toString()}`)},e.prototype.toNormalizedString=function(){return this.toString()},e.prototype.toString=function(){return this.octets.join(".")},e}(),u.IPv4.broadcastAddressFromCIDR=function(e){try{let t=this.parseCIDR(e),i=t[0].toByteArray(),s=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),r=[],n=0;for(;n<4;)r.push(parseInt(i[n],10)|255^parseInt(s[n],10)),n++;return new this(r)}catch(e){throw Error("ipaddr: the address does not have IPv4 CIDR format")}},u.IPv4.isIPv4=function(e){return null!==this.parser(e)},u.IPv4.isValid=function(e){try{return new this(this.parser(e)),!0}catch(e){return!1}},u.IPv4.isValidCIDR=function(e){try{return this.parseCIDR(e),!0}catch(e){return!1}},u.IPv4.isValidFourPartDecimal=function(e){return!!(u.IPv4.isValid(e)&&e.match(/^(0|[1-9]\d*)(\.(0|[1-9]\d*)){3}$/))},u.IPv4.networkAddressFromCIDR=function(e){let t,i,s,r,n;try{for(s=(t=this.parseCIDR(e))[0].toByteArray(),n=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),r=[],i=0;i<4;)r.push(parseInt(s[i],10)&parseInt(n[i],10)),i++;return new this(r)}catch(e){throw Error("ipaddr: the address does not have IPv4 CIDR format")}},u.IPv4.parse=function(e){let t=this.parser(e);if(null===t)throw Error("ipaddr: string is not formatted like an IPv4 Address");return new this(t)},u.IPv4.parseCIDR=function(e){let t;if(t=e.match(/^(.+)\/(\d+)$/)){let e=parseInt(t[2]);if(e>=0&&e<=32){let i=[this.parse(t[1]),e];return Object.defineProperty(i,"toString",{value:function(){return this.join("/")}}),i}}throw Error("ipaddr: string is not formatted like an IPv4 CIDR range")},u.IPv4.parser=function(e){let t,i;if(t=e.match(s.fourOctet)){let e=t.slice(1,6),i=[];for(let t=0;t<e.length;t++)i.push(p(e[t]));return i}if(t=e.match(s.longValue)){if((i=p(t[1]))>0xffffffff||i<0)throw Error("ipaddr: address outside defined range");return(function(){let e,t=[];for(e=0;e<=24;e+=8)t.push(i>>e&255);return t})().reverse()}if(t=e.match(s.twoOctet)){let e=t.slice(1,4),s=[];if((i=p(e[1]))>0xffffff||i<0)throw Error("ipaddr: address outside defined range");return s.push(p(e[0])),s.push(i>>16&255),s.push(i>>8&255),s.push(255&i),s}{if(!(t=e.match(s.threeOctet)))return null;let r=t.slice(1,5),n=[];if((i=p(r[2]))>65535||i<0)throw Error("ipaddr: address outside defined range");return n.push(p(r[0])),n.push(p(r[1])),n.push(i>>8&255),n.push(255&i),n}},u.IPv4.subnetMaskFromPrefixLength=function(e){if((e=parseInt(e))<0||e>32)throw Error("ipaddr: invalid IPv4 prefix length");let t=[0,0,0,0],i=0,s=Math.floor(e/8);for(;i<s;)t[i]=255,i++;return s<4&&(t[s]=Math.pow(2,e%8)-1<<8-e%8),new this(t)},u.IPv6=function(){function e(e,t){let i,s;if(16===e.length)for(i=0,this.parts=[];i<=14;i+=2)this.parts.push(e[i]<<8|e[i+1]);else if(8===e.length)this.parts=e;else throw Error("ipaddr: ipv6 part count should be 8 or 16");for(i=0;i<this.parts.length;i++)if(!(0<=(s=this.parts[i])&&s<=65535))throw Error("ipaddr: ipv6 part should fit in 16 bits");t&&(this.zoneId=t)}return e.prototype.SpecialRanges={unspecified:[new e([0,0,0,0,0,0,0,0]),128],linkLocal:[new e([65152,0,0,0,0,0,0,0]),10],multicast:[new e([65280,0,0,0,0,0,0,0]),8],loopback:[new e([0,0,0,0,0,0,0,1]),128],uniqueLocal:[new e([64512,0,0,0,0,0,0,0]),7],ipv4Mapped:[new e([0,0,0,0,0,65535,0,0]),96],discard:[new e([256,0,0,0,0,0,0,0]),64],rfc6145:[new e([0,0,0,0,65535,0,0,0]),96],rfc6052:[new e([100,65435,0,0,0,0,0,0]),96],"6to4":[new e([8194,0,0,0,0,0,0,0]),16],teredo:[new e([8193,0,0,0,0,0,0,0]),32],benchmarking:[new e([8193,2,0,0,0,0,0,0]),48],amt:[new e([8193,3,0,0,0,0,0,0]),32],as112v6:[[new e([8193,4,274,0,0,0,0,0]),48],[new e([9760,79,32768,0,0,0,0,0]),48]],deprecated:[new e([8193,16,0,0,0,0,0,0]),28],orchid2:[new e([8193,32,0,0,0,0,0,0]),28],droneRemoteIdProtocolEntityTags:[new e([8193,48,0,0,0,0,0,0]),28],reserved:[[new e([8193,0,0,0,0,0,0,0]),23],[new e([8193,3512,0,0,0,0,0,0]),32]]},e.prototype.isIPv4MappedAddress=function(){return"ipv4Mapped"===this.range()},e.prototype.kind=function(){return"ipv6"},e.prototype.match=function(e,t){let i;if(void 0===t&&(e=(i=e)[0],t=i[1]),"ipv6"!==e.kind())throw Error("ipaddr: cannot match ipv6 address with non-ipv6 one");return d(this.parts,e.parts,16,t)},e.prototype.prefixLengthFromSubnetMask=function(){let e,t,i=0,s=!1,r={0:16,32768:15,49152:14,57344:13,61440:12,63488:11,64512:10,65024:9,65280:8,65408:7,65472:6,65504:5,65520:4,65528:3,65532:2,65534:1,65535:0};for(let n=7;n>=0;n-=1){if(!((e=this.parts[n])in r)||(t=r[e],s&&0!==t))return null;16!==t&&(s=!0),i+=t}return 128-i},e.prototype.range=function(){return u.subnetMatch(this,this.SpecialRanges)},e.prototype.toByteArray=function(){let e,t=[],i=this.parts;for(let s=0;s<i.length;s++)t.push((e=i[s])>>8),t.push(255&e);return t},e.prototype.toFixedLengthString=function(){let e=(function(){let e=[];for(let t=0;t<this.parts.length;t++)e.push(function(e,t){for(;e.length<4;)e=`0${e}`;return e}(this.parts[t].toString(16),0));return e}).call(this).join(":"),t="";return this.zoneId&&(t=`%${this.zoneId}`),e+t},e.prototype.toIPv4Address=function(){if(!this.isIPv4MappedAddress())throw Error("ipaddr: trying to convert a generic ipv6 address to ipv4");let e=this.parts.slice(-2),t=e[0],i=e[1];return new u.IPv4([t>>8,255&t,i>>8,255&i])},e.prototype.toNormalizedString=function(){let e=(function(){let e=[];for(let t=0;t<this.parts.length;t++)e.push(this.parts[t].toString(16));return e}).call(this).join(":"),t="";return this.zoneId&&(t=`%${this.zoneId}`),e+t},e.prototype.toRFC5952String=function(){let e,t=/((^|:)(0(:|$)){2,})/g,i=this.toNormalizedString(),s=0,r=-1;for(;e=t.exec(i);)e[0].length>r&&(s=e.index,r=e[0].length);return r<0?i:`${i.substring(0,s)}::${i.substring(s+r)}`},e.prototype.toString=function(){return this.toRFC5952String()},e}(),u.IPv6.broadcastAddressFromCIDR=function(e){try{let t=this.parseCIDR(e),i=t[0].toByteArray(),s=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),r=[],n=0;for(;n<16;)r.push(parseInt(i[n],10)|255^parseInt(s[n],10)),n++;return new this(r)}catch(e){throw Error(`ipaddr: the address does not have IPv6 CIDR format (${e})`)}},u.IPv6.isIPv6=function(e){return null!==this.parser(e)},u.IPv6.isValid=function(e){if("string"==typeof e&&-1===e.indexOf(":"))return!1;try{let t=this.parser(e);return new this(t.parts,t.zoneId),!0}catch(e){return!1}},u.IPv6.isValidCIDR=function(e){if("string"==typeof e&&-1===e.indexOf(":"))return!1;try{return this.parseCIDR(e),!0}catch(e){return!1}},u.IPv6.networkAddressFromCIDR=function(e){let t,i,s,r,n;try{for(s=(t=this.parseCIDR(e))[0].toByteArray(),n=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),r=[],i=0;i<16;)r.push(parseInt(s[i],10)&parseInt(n[i],10)),i++;return new this(r)}catch(e){throw Error(`ipaddr: the address does not have IPv6 CIDR format (${e})`)}},u.IPv6.parse=function(e){let t=this.parser(e);if(null===t.parts)throw Error("ipaddr: string is not formatted like an IPv6 Address");return new this(t.parts,t.zoneId)},u.IPv6.parseCIDR=function(e){let t,i,s;if((i=e.match(/^(.+)\/(\d+)$/))&&(t=parseInt(i[2]))>=0&&t<=128)return Object.defineProperty(s=[this.parse(i[1]),t],"toString",{value:function(){return this.join("/")}}),s;throw Error("ipaddr: string is not formatted like an IPv6 CIDR range")},u.IPv6.parser=function(e){let t,i,s,r,n,a;if(s=e.match(l.deprecatedTransitional))return this.parser(`::ffff:${s[1]}`);if(l.native.test(e))return c(e,8);if((s=e.match(l.transitional))&&(a=s[6]||"",t=s[1],s[1].endsWith("::")||(t=t.slice(0,-1)),(t=c(t+a,6)).parts)){for(i=0,n=[parseInt(s[2]),parseInt(s[3]),parseInt(s[4]),parseInt(s[5])];i<n.length;i++)if(!(0<=(r=n[i])&&r<=255))return null;return t.parts.push(n[0]<<8|n[1]),t.parts.push(n[2]<<8|n[3]),{parts:t.parts,zoneId:t.zoneId}}return null},u.IPv6.subnetMaskFromPrefixLength=function(e){if((e=parseInt(e))<0||e>128)throw Error("ipaddr: invalid IPv6 prefix length");let t=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],i=0,s=Math.floor(e/8);for(;i<s;)t[i]=255,i++;return s<16&&(t[s]=Math.pow(2,e%8)-1<<8-e%8),new this(t)},u.fromByteArray=function(e){let t=e.length;if(4===t)return new u.IPv4(e);if(16===t)return new u.IPv6(e);throw Error("ipaddr: the binary input is neither an IPv6 nor IPv4 address")},u.isValid=function(e){return u.IPv6.isValid(e)||u.IPv4.isValid(e)},u.isValidCIDR=function(e){return u.IPv6.isValidCIDR(e)||u.IPv4.isValidCIDR(e)},u.parse=function(e){if(u.IPv6.isValid(e))return u.IPv6.parse(e);if(u.IPv4.isValid(e))return u.IPv4.parse(e);throw Error("ipaddr: the address has neither IPv6 nor IPv4 format")},u.parseCIDR=function(e){try{return u.IPv6.parseCIDR(e)}catch(t){try{return u.IPv4.parseCIDR(e)}catch(e){throw Error("ipaddr: the address has neither IPv6 nor IPv4 CIDR format")}}},u.process=function(e){let t=this.parse(e);return"ipv6"===t.kind()&&t.isIPv4MappedAddress()?t.toIPv4Address():t},u.subnetMatch=function(e,t,i){let s,r,n,a;for(r in null==i&&(i="unicast"),t)if(Object.prototype.hasOwnProperty.call(t,r)){for(!(n=t[r])[0]||n[0]instanceof Array||(n=[n]),s=0;s<n.length;s++)if(a=n[s],e.kind()===a[0].kind()&&e.match.apply(e,a))return r}return i},t.exports?t.exports=u:e.ipaddr=u}(e.e)},8270368,e=>{e.v({input:"trusted-ips-module__2PgDza__input",ipInput:"trusted-ips-module__2PgDza__ipInput",list:"trusted-ips-module__2PgDza__list",noteInput:"trusted-ips-module__2PgDza__noteInput"})},9855670,e=>{"use strict";var t=e.i(1146226),i=e.i(5169864),s=e.i(2504781),r=e.i(5468328),n=e.i(6891161),a=e.i(455575),o=e.i(1906681),l=e.i(3500331),c=e.i(2064047),d=e.i(5169576),p=e.i(7957251),u=e.i(5883567),h=e.i(6401841),m=e.i(762945),x=e.i(9722978),f=e.i(4004502),y=e.i(7917902),g=e.i(7812221),j=e.i(57106),v=e.i(1717203),b=e.i(7557283),I=e.i(588428),w=e.i(4670733),P=e.i(5807088),N=e.i(8188735),C=e.i(6060673),k=e.i(1138941),A=e.i(6673134),T=e.i(185801),S=e.i(4999769),E=e.i(6827216);let D=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=[];for(let s of t)try{if((0,E.isValid)(e)&&(0,E.isValid)(s))e===s&&i.push(s);else if((0,E.isValid)(e))(0,E.parse)(e).match((0,E.parseCIDR)(s))&&i.push(s);else if((0,E.isValid)(s))(0,E.parse)(s).match((0,E.parseCIDR)(e))&&i.push(s);else{let t=(0,E.parseCIDR)(e),r=(0,E.parseCIDR)(s);(t[0].match(r)||r[0].match(t))&&i.push(s)}}catch{}return i};var R=e.i(5978342),_=e.i(9947482);function M(e){let{overrides:i,...s}=e,r={additional:{label:"Trusted IP Required",description:(0,t.jsxs)("span",{className:"text-copy-14 text-inherit",children:["Visitors"," ",(0,t.jsx)("span",{className:"text-[14px] leading-[20px] font-medium text-inherit",children:"must"})," ","come from a Trusted IP address, and satisfy Vercel Authentication or Password Protection if enabled."]}),...i?.additional},exclusive:{label:"Trusted IP Optional",description:(0,t.jsxs)("span",{className:"text-copy-14 text-inherit",children:["Visitors from a Trusted IP address will automatically"," ",(0,t.jsx)("span",{className:"text-[14px] leading-[20px] font-medium text-inherit",children:"bypass"})," ","Vercel Authentication and Password Protection. Other users will be prompted with the enabled Deployment Protection methods."]}),...i?.exclusive}};return(0,t.jsx)(_.Selector,{ariaLabel:"Select the protection mode for Trusted IPs.",values:r,width:280,...s})}var O=e.i(8270368),L=e.i(9367781);function $(){let e=(0,a.useToasts)(),P=(0,k.useProjectIdOrName)(),{data:_,mutate:$}=(0,C.useProject)(P),F=(0,y.useAccount)(),{can:H,isLoading:z}=(0,v.default)(),U=H(b.Action.Update,b.Resource.Project)&&H(b.Action.Update,b.Resource.TrustedIps),q=H(b.Action.Read,b.Resource.TrustedIps),{user:W,team:Y}=F,{value:G}=(0,w.useTrustedIpsCustomLimitFlag)(),J=B(G),K=Y?.standaloneTrustedIps?.enabled||!1,Z=(0,i.useMemo)(()=>!!(q&&_?.trustedIps),[q,_?.trustedIps]),[Q,X]=(0,i.useState)(Z),ee=(0,i.useMemo)(()=>q&&_?.trustedIps?.deploymentType||"production",[q,_?.trustedIps?.deploymentType]),[et,ei]=(0,i.useState)(ee),es=(0,i.useMemo)(()=>q&&_?.trustedIps?.protectionMode||"additional",[q,_?.trustedIps?.protectionMode]),[er,en]=(0,i.useState)(es),[ea,eo]=(0,i.useState)(!1),[el,ec]=(0,i.useState)(null),[ed,ep]=(0,i.useState)(!1),{value:eu}=(0,I.useIPBlockingTeamFlag)(),eh=H(b.Action.Read,b.Resource.IpBlocking),{data:em}=(0,A.useIPBlocking)({limit:128}),ex=(0,i.useCallback)(e=>e.map((i,s)=>{let r,{value:n,note:a}=i;if(!n&&a)return{...i,error:"Please enter a value."};let o=(r=(e=>{try{return(0,E.parse)(e)}catch{return null}})(n)||(e=>{try{let[t]=(0,E.parseCIDR)(e);return t}catch{return null}})(n))&&"ipv4"===r.kind()?["private","unspecified","loopback"].includes(r.range())?"unsupported-range":"valid":"unsupported-format";if(n&&"unsupported-format"===o)return{...i,error:"Unsupported format: Must be an IPv4 address or IPv4 CIDR block."};if(n&&"unsupported-range"===o)return{...i,error:"Unsupported range"};if(n&&e.slice(0,s).filter(e=>{let{value:t}=e;return t===n}).length>0)return{...i,error:"Address already in the list."};if(Y?.slug){let e=eu&&eh?em?.result.map(e=>{let{ip:t}=e;return t}):void 0,s=`/${Y.slug}/~/settings/security#ip-blocking`,r=D(n,e);if(r.length>0)return{...i,warning:(0,t.jsxs)(t.Fragment,{children:["Potential conflict with"," ",(0,t.jsx)(j.Link,{href:s,variant:"blend",children:"Blocked IPs"})," ","(",r.join(", "),"). Blocked addresses will not be trusted."]})}}return{...i,error:null,warning:null}}),[em,eu,eh,Y?.slug]),ef=(0,i.useMemo)(()=>{let e=Date.now();return q&&_?.trustedIps?.addresses&&0!==_.trustedIps.addresses.length?ex(_.trustedIps.addresses.map((t,i)=>{let{value:s,note:r}=t;return{renderingId:e+i,value:s,note:r,error:null,warning:null}})):[{renderingId:e,value:"",error:null,warning:null}]},[q,_?.trustedIps,ex]),[ey,eg]=(0,i.useState)(ef),ej=(0,i.useMemo)(()=>({trustedIps:Q?{deploymentType:et,addresses:ey.map(e=>{let{value:t,note:i}=e;return{value:t,note:i}}).filter(e=>{let{value:t}=e;return!!t}),protectionMode:er}:null}),[Q,et,ey,er]),ev=(0,i.useCallback)(async()=>{eo(!0);try{ec(null),await (0,N.default)(P,Y?.id,ej),e.success("Updated Trusted IPs successfully."),await $()}catch(e){ec(e.message)}eo(!1)},[P,$,Y,e,ej]),eb=(0,i.useCallback)(e=>{X(e),eg(e=>{let[t,...i]=e;return[{...t,renderingId:t.renderingId-1},...i]})},[]),eI=(0,i.useCallback)(e=>{ei(e)},[]),ew=(0,i.useCallback)(()=>{eg(e=>[...e,{renderingId:Date.now(),value:"",error:null,warning:null}])},[]),eP=(0,i.useCallback)(e=>{eg(t=>{if(t.length<=1)return[{renderingId:Date.now(),value:"",error:null,warning:null}];let i=t.findIndex(t=>{let{renderingId:i}=t;return i===e});return[...t.slice(0,i),...t.slice(i+1)]})},[]),eN=(0,i.useCallback)((e,t)=>{let{value:i,note:s}=t;eg(t=>t.map(t=>t.renderingId===e?{...t,value:i??t.value,note:s??t.note}:t))},[]),eC=(0,i.useCallback)((e,t)=>{t.relatedTarget?.id!==`remove-input-${e}`&&eg(ex)},[ex]);(0,i.useEffect)(()=>{X(Z),ei(ee),eg(ef),en(es)},[es,ef,Z,ee]);let ek=!_||!(Y||W)||z,eA=JSON.stringify(_?.trustedIps?.addresses)!==JSON.stringify(ej.trustedIps?.addresses),eT=(_?.trustedIps||ej.trustedIps)&&(_?.trustedIps?.deploymentType!==ej.trustedIps?.deploymentType||_?.trustedIps?.protectionMode!==ej.trustedIps?.protectionMode||eA),eS=Q&&ey.find(e=>{let{error:t}=e;return!!t}),eE=U&&eT&&!eS&&(!ej.trustedIps||ej.trustedIps.addresses.length>0),eD=Y?.billing?.plan==="enterprise"&&U,eR=(0,i.useCallback)(()=>U?eD?(0,t.jsxs)("p",{className:"text-copy-14 text-gray-900",children:["Learn more about"," ",(0,t.jsx)(j.Link,{external:!0,href:"/docs/security/deployment-protection/methods-to-protect-deployments/trusted-ips",type:"highlight",children:"Trusted IPs"})]}):(0,t.jsxs)("span",{className:"text-copy-14 text-gray-900",children:["This feature is available on the"," ",(0,t.jsx)(j.Link,{external:!0,href:"/pricing",type:"highlight",children:"Enterprise plan"}),"."]}):(0,t.jsxs)("p",{className:"text-copy-14 text-gray-900",children:["You need additional permissions to manage your project's"," ",(0,t.jsx)(j.Link,{external:!0,href:"/docs/security/deployment-protection/methods-to-protect-deployments/trusted-ips",type:"highlight",children:"Trusted IPs"}),"."]}),[U,eD]);if(ek)return(0,t.jsx)(V,{});let e_=ea||!Q||!q,eM=!(_.ssoProtection||_.passwordProtection||_.trustedIps?.protectionMode==="exclusive"),eO=ey.length>=J,eL=()=>{ep(!1)},e$=!U||!eD,eB=_.ssoProtection?.deploymentType||K?null:"Vercel Authentication must also enabled to enable Trusted IPs in preview environments.";return(0,t.jsxs)(T.ProjectSettingsFieldset,{action:eD?null:(0,t.jsx)(j.ButtonLink,{"data-testid":(0,f.tid)("project-settings","paid-feature","contact-sales"),href:g.CONTACT_SALES_DASHBOARD_HREF,size:"small",tab:!0,children:"Contact Sales"}),description:(0,t.jsxs)(t.Fragment,{children:["Restrict access to deployments to visitors from specific IP addresses only. A maximum of ",J," IP addresses can be added."]}),disabled:!U,disabledForBilling:e$,error:el,highlightNote:!U,note:eR(),onSave:eD?async()=>{Q?await ev():ep(!0)}:null,saveDisabled:!eE,saveLoading:ea,title:"Trusted IPs",headerNote:Q?(0,t.jsx)(L.MicrofrontendsHelpBadge,{childHelp:(0,t.jsxs)(t.Fragment,{children:["This configuration applies only to this project's domains. It's recommended to protect"," ",(0,t.jsx)("span",{className:"text-[14px] leading-[20px] font-medium text-inherit",children:"All Deployments"})," ","for a child microfrontends project."]}),parentHelp:"This configuration applies to production and pre-production deployments for the group."}):null,children:[(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:[(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-2 md:gap-4 flex-initial flex-wrap",children:[(0,t.jsx)("div",{className:"flex flex-row items-center justify-start gap-2 flex-initial",children:(0,t.jsx)(o.Toggle,{"aria-labelledby":"label-for-trusted-ips-enabled-toggle",checked:Q,direction:"switch-first",onChange:eb,size:"large",style:{padding:"var(--geist-gap-quarter) 0"},children:(0,t.jsx)("p",{className:(0,x.clsx)("text-[14px] leading-[20px] font-medium normal-case",e$?"text-gray-800":void 0),id:"label-for-trusted-ips-enabled-toggle",children:Q?"Enabled for":"Disabled"})})}),Q?(0,t.jsx)(R.DeploymentTypeSelector,{disabled:e_,onChange:eI,overrides:{preview:{disabledDescription:eB},production:{},all:{disabledDescription:eB},all_except_custom_domains:{disabledDescription:eB},prod_deployment_urls_and_all_previews:{disabledDescription:eB}},currentValue:_?.trustedIps?.deploymentType,project:_,selectedValue:et}):null]}),(0,t.jsx)("hr",{className:(0,x.clsx)("geist-hr-reset","geist-show-on-mobile")}),(0,t.jsxs)("form",{autoComplete:"off",className:"flex flex-col items-stretch justify-start gap-3 flex-initial",children:[(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-1 flex-initial",children:[(0,t.jsx)("p",{className:(0,x.clsx)("text-[14px] leading-[20px] font-medium uppercase",e$?"text-gray-800":"text-gray-900"),id:"label-for-trusted-ips-trusted-ips-input",children:"IP / CIDR"}),(0,t.jsx)(r.Tooltip,{text:"Supported formats: IPv4 and IPv4 CIDR.",children:(0,t.jsx)(d.Information,{})})]}),(0,t.jsx)(c.Entity.List,{className:O.default.list,children:ey.sort((e,t)=>e.renderingId>t.renderingId?1:-1).map((e,i)=>{let{renderingId:n,value:a,note:o,error:d,warning:u}=e,f=!e_&&(d||u)&&a?(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-2 flex-initial",children:[d?(0,t.jsx)(h.Stop,{color:"red-900",size:14,style:{flexShrink:0}}):(0,t.jsx)(m.Warning,{color:"amber-900",size:14,style:{flexShrink:0}}),(0,t.jsx)("span",{className:(0,x.clsx)("text-copy-14",d?"text-red-900":"text-amber-900"),children:d||u})]}):null;return(0,t.jsx)(c.Entity,{footer:f,left:(0,t.jsxs)("p",{className:"text-copy-14",style:{width:"20px",marginTop:"-2px"},children:[i+1,"."]}),right:(0,t.jsx)(r.Tooltip,{disableTriggers:e_,text:"Remove",children:(0,t.jsx)(s.Button,{"aria-label":"Remove IP Address",disabled:e_,id:`remove-input-${n}`,onClick:()=>eP(n),shape:"circle",size:"small",style:{border:"none",background:"none"},svgOnly:!0,type:"tertiary",children:(0,t.jsx)(p.MinusCircle,{})})}),children:(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-4 flex-initial w-full",children:[(0,t.jsx)(l.Input,{"aria-labelledby":"label-for-trusted-ips-trusted-ips-input",autoComplete:"one-time-code",autoFocus:eA,disabled:e_,error:e_?null:d,innerWrapperClassName:(0,x.clsx)(O.default.input,O.default.ipInput),onBlur:e=>eC(n,e),onChange:e=>eN(n,{value:e.target.value}),placeholder:e_?"":d||"85.146.82.237",showErrorMessage:!1,size:"small",type:u?"warning":void 0,value:a}),(0,t.jsx)(l.Input,{"aria-labelledby":"label-for-trusted-ips-trusted-ips-input",autoComplete:"one-time-code",disabled:e_,innerWrapperClassName:(0,x.clsx)(O.default.input,O.default.noteInput),maxLength:20,onBlur:e=>eC(n,e),onChange:e=>eN(n,{note:e.target.value}),placeholder:e_?"":"Note",size:"small",value:o})]})},n)})})]}),(0,t.jsx)(r.Tooltip,{disableTriggers:!eO,position:"right",style:{alignSelf:"flex-start"},text:`Maximum ${J} addresses allowed.`,children:(0,t.jsx)(s.Button,{disabled:e_||eO,onClick:ew,prefix:(0,t.jsx)(u.PlusCircle,{}),size:"small",style:{alignSelf:"flex-start"},type:"secondary",children:"Add another"})}),K?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("hr",{className:"geist-hr-reset"}),(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-2 flex-initial",children:[(0,t.jsx)("p",{className:(0,x.clsx)("text-[14px] leading-[20px] font-medium",e_?"text-gray-900":void 0),children:"Protection mode"}),(0,t.jsx)(M,{disabled:e_,onChange:en,overrides:{exclusive:{disabledDescription:eM?"No additional protections currently enabled.":null}},selectedValue:er})]})]}):null,(0,t.jsx)(S.AnimatedNote,{keyName:"trusted-ips-ip-note",children:Q&&"exclusive"===er&&!(_.passwordProtection||_.ssoProtection)?(0,t.jsx)("span",{children:"Configuration of Trusted IP Optional with no other protections enabled has no effect."}):null})]}),(0,t.jsxs)(n.Modal.Modal,{active:ed,onClickOutside:eL,children:[(0,t.jsx)(n.Modal.Body,{children:(0,t.jsxs)("div",{className:"flex flex-col items-start justify-start gap-4 flex-initial",children:[(0,t.jsx)(n.Modal.Title,{children:"Disable Trusted IPs"}),(0,t.jsx)(n.Modal.Subtitle,{children:"If you disable Trusted IPs, you will lose any previous values."}),(0,t.jsx)(n.Modal.Subtitle,{children:"Are you sure you want to continue?"})]})}),(0,t.jsxs)(n.Modal.Actions,{children:[(0,t.jsx)(n.Modal.Action,{onClick:eL,type:"secondary",children:"Cancel"}),(0,t.jsx)(n.Modal.Action,{onClick:async()=>{ep(!1),await ev()},children:"Continue"})]})]})]})}let B=e=>"number"!=typeof e?20:e>200?200:e<20?20:e;function V(){return(0,t.jsx)(P.default,{height:280})}function F(){return(0,t.jsx)(i.Suspense,{fallback:(0,t.jsx)(V,{}),children:(0,t.jsx)($,{})})}e.s(["TrustedIps",()=>F],9855670)},7912,e=>{"use strict";var t=e.i(1146226),i=e.i(5169864),s=e.i(4585051),r=e.i(2504781),n=e.i(3500331),a=e.i(8459493),o=e.i(6891161),l=e.i(8522580),c=e.i(5255926),d=e.i(455575),p=e.i(57106),u=e.i(8042625),h=e.i(277234),m=e.i(4244280),x=e.i(7917902),f=e.i(1717203),y=e.i(7557283),g=e.i(7218483),j=e.i(3802983),v=e.i(1452806),b=e.i(3555274),I=e.i(1138941),w=e.i(6060673),P=e.i(5807088),N=e.i(2882012),C=e.i(2405338),k=e.i(9068719),A=e.i(4470704),T=e.i(185801),S=e.i(1475969),E=e.i(9367781);function D(e){let{value:i}=e;return(0,t.jsx)(s.Avatar,{size:30,uid:i})}function R(e){let{value:t}=e;return(0,g.useAge)(t,{justNowThreshold:6e4})}function _(){let e=(0,d.useToasts)(),s=(0,I.useProjectIdOrName)(),{data:g}=(0,w.useProject)(s),{user:P,team:_}=(0,x.useAccount)(),{can:O,isLoading:L}=(0,f.default)(),[$,B]=(0,i.useState)(!1),[V,F]=(0,i.useState)(null),[H,z]=(0,i.useState)(null),[U,q]=(0,i.useState)(!1),[W,Y]=(0,i.useState)(null),[G,J]=(0,i.useState)(null),{data:{exceptions:K=[]}={},mutate:Z}=function(e,t){let{projectId:i,teamId:s}=e;return(0,C.default)(()=>i?`${(0,m.API_PROJECTS_VERSION)("v10")}/${i}/deployment-protection-exceptions${(0,u.encode)({teamId:s})}`:null,e=>(0,h.fetchAPI)(e),void 0)}({teamId:_?.id,projectId:g?.id}),Q=(0,i.useCallback)(async(i,s)=>{if(!U&&("create"!==i||W)&&g){z(null),q(!0);try{let[r,n]=await Promise.all([(0,h.fetchAPI)(`${m.API_ALIASES}/${s}${(0,u.encode)({teamId:_?.id,projectId:g.id})}`,{throwOnHTTPError:!0}),(0,h.fetchAPI)((0,A.getDeploymentKey)(s,_?.id),{throwOnHTTPError:!1})]),a=(r?{id:r.uid,url:r.alias}:void 0)??(n&&n.url===s&&n.projectId===g.id?n:void 0);a?(await (0,N.updateAliasProtectionBypass)({teamId:_?.id,aliasId:a.id,body:{override:{scope:"alias-protection-override",action:i}}}),e.success("create"===i?`Successfully unprotected ${a.url}`:`Successfully removed ${a.url} from Deployment Protection Exceptions`),Y(null)):z((0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("b",{children:s})," not found in project ",(0,t.jsx)("b",{children:g.name}),"."]}))}catch(e){z(e.message||"An error occured, please try again later.")}B(!1),await Z(),q(!1)}},[W,_?.id,U,g,e,Z]),{addOn:X,isADPEnabled:ee,enableADP:et,ADPModal:ei}=(0,k.useToggleAdvancedDeploymentProtection)("project-settings-deployment-protection-exceptions"),{enabled:es,message:er,action:en}=(0,b.default)({addOn:X,isEnabled:ee,enable:et,modal:ei}),ea=!g||!(_||P)||L,eo=O(y.Action.Update,y.Resource.Project),el=O(y.Action.Update,y.Resource.AliasProtectionBypass),ec=O(y.Action.List,y.Resource.AliasProtectionBypass),ed=O(y.Action.Create,y.Resource.PasswordProtection),ep=(0,i.useCallback)(()=>eo&&el&&ec?es?(0,t.jsxs)("p",{className:"text-copy-14 text-gray-900",children:["Learn more about"," ",(0,t.jsx)(p.Link,{external:!0,href:"/docs/security/deployment-protection/methods-to-bypass-deployment-protection/deployment-protection-exceptions",type:"highlight",children:"Deployment Protection Exceptions"})]}):ed?er:(0,t.jsxs)("p",{className:"text-copy-14 text-gray-900",children:["You need additional permissions to enable"," ",(0,t.jsx)(p.Link,{external:!0,href:"/docs/security/deployment-protection/methods-to-bypass-deployment-protection/deployment-protection-exceptions",type:"highlight",children:"Deployment Protection Exceptions"})," ","for your project."]}):(0,t.jsxs)("p",{className:"text-copy-14 text-gray-900",children:["You need additional permissions to manage your project's"," ",(0,t.jsx)(p.Link,{external:!0,href:"/docs/security/deployment-protection/methods-to-bypass-deployment-protection/deployment-protection-exceptions",type:"highlight",children:"Deployment Protection Exceptions"}),"."]}),[eo,es,er,ed,el,ec]),eu=(0,i.useCallback)(()=>(F(null),!!W&&(!K.map(e=>{let{alias:t}=e;return t}).includes(W)||(F((0,t.jsxs)(t.Fragment,{children:["Invalid Input: ",(0,t.jsx)("b",{children:W})," is already included in Deployment Protection Exceptions."]})),!1))),[W,K]),eh=()=>{z(null),Y(null),B("add")},em=(0,i.useCallback)(e=>{e.preventDefault(),eu()&&B("confirm-add")},[eu]),ex=(0,i.useCallback)(async e=>{e.preventDefault(),W&&await Q("create",W)},[W,Q]),ef=(0,i.useCallback)(async e=>{e.preventDefault(),G&&await Q("revoke",G)},[G,Q]),ey=(0,i.useCallback)(()=>{F(null),W||Y("")},[W]),eg=(0,i.useCallback)(()=>{eu(),W||Y(null)},[W,eu]),ej=(0,i.useMemo)(()=>{switch($){case"add":return{title:"Unprotect Domain",description:"Enter the preview domain that you would like to unprotect.",body:(0,t.jsx)(j.default,{error:V,id:"alias",name:"alias",onBlur:eg,onChange:e=>Y(e.target.value),onFocus:ey,placeholder:"domain.vercel.app",required:!0,value:W||"",width:"100%"}),actionTitle:"Continue",action:em};case"confirm-add":return{title:"Unprotect Domain",description:(0,t.jsxs)(l.Note,{fill:!0,type:"warning",variant:"contrast",children:["This action will remove any deployent protection for the domain, making it ",(0,t.jsx)("b",{children:"publicly accessible"}),", until the domain is manually removed from this list."]}),body:(0,t.jsx)(o.Modal.Inset,{last:!0,children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-6 flex-initial",children:[(0,t.jsx)("label",{children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[(0,t.jsxs)("p",{className:"text-copy-14 text-gray-900",children:["Enter the domain"," ",(0,t.jsx)("b",{style:{overflowWrap:"anywhere"},children:W})," ","to continue:"]}),(0,t.jsx)(n.Input,{"aria-label":"Domain Name",disabled:U,pattern:`\\s*${W||""}\\s*`,required:!0})]})}),(0,t.jsx)("label",{children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[(0,t.jsxs)("p",{className:"text-copy-14 text-gray-900",children:["To verify, type ",(0,t.jsx)("b",{children:"unprotect my domain"})," below:"]}),(0,t.jsx)(n.Input,{"aria-label":"Verification Code",disabled:U,pattern:"\\s*unprotect my domain\\s*",required:!0})]})})]})}),actionTitle:"Confirm",action:ex};case"confirm-remove":return{title:"Reprotect Domain",description:(0,t.jsxs)(l.Note,{fill:!0,type:"warning",variant:"contrast",children:["This action will reprotect the domain with Deployment Protection, making it ",(0,t.jsx)("b",{children:"no longer publicly accessible"}),"."]}),body:(0,t.jsx)(o.Modal.Inset,{last:!0,children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-6 flex-initial",children:[(0,t.jsx)("label",{children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[(0,t.jsxs)("p",{className:"text-copy-14 text-gray-900",children:["Enter the domain"," ",(0,t.jsx)("b",{style:{overflowWrap:"anywhere"},children:G})," ","to continue:"]}),(0,t.jsx)(n.Input,{"aria-label":"Domain Name",disabled:U,pattern:`\\s*${G||""}\\s*`,required:!0})]})}),(0,t.jsx)("label",{children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[(0,t.jsxs)("p",{className:"text-copy-14 text-gray-900",children:["To verify, type ",(0,t.jsx)("b",{children:"reprotect my domain"})," below:"]}),(0,t.jsx)(n.Input,{"aria-label":"Verification Code",disabled:U,pattern:"\\s*reprotect my domain\\s*",required:!0})]})})]})}),actionTitle:"Confirm",action:ef};case!1:return null}},[$,G,W,V,eg,ex,ef,ey,em,U]);return ea?(0,t.jsx)(M,{}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(T.ProjectSettingsFieldset,{action:ed?en:void 0,description:(0,t.jsxs)("span",{className:"flex flex-col md:flex-row items-start justify-between gap-4 flex-initial",children:[(0,t.jsxs)("span",{children:["Specify pre-production domains that you want to exclude from Deployment Protection. ",(0,t.jsx)("br",{}),(0,t.jsxs)("span",{className:"text-copy-14",children:["Domains listed will become"," ",(0,t.jsx)("span",{className:"text-[14px] leading-[20px] font-medium text-inherit",children:"unprotected"})," ","and"," ",(0,t.jsx)("span",{className:"text-[14px] leading-[20px] font-medium text-inherit",children:"publicly accessible"}),"."]})]}),(0,t.jsx)(r.Button,{onClick:eh,type:"warning",children:"Add Domain"})]}),disabled:!eo,disabledForBilling:!eo||!es||!el||!ec,error:H,highlightNote:!eo,note:ep(),saveLoading:U,title:"Deployment Protection Exceptions",headerNote:(0,t.jsx)(E.MicrofrontendsHelpBadge,{childHelp:"This configuration only applies to domains belonging to this project.",parentHelp:"This configuration only applies to domains belonging to this project."}),children:K.length>0?(0,t.jsx)(v.default,{caption:"Unprotected Domains",columns:[{Header:"Unprotected Domains",accessor:"alias"},{Header:"Creator",accessor:"createdBy",Cell:D},{Header:"Age",accessor:"createdAt",Cell:R}],data:K.map(e=>{let{alias:t,protectionBypass:i}=e,{createdBy:s,createdAt:r}=(0,S.getAliasDeploymentProtectionException)(i)||{};return{alias:t,createdBy:s,createdAt:r}}),headerActions:()=>(0,t.jsx)(a.MenuItem,{onClick:eh,children:"Add domain"}),rowActions:e=>{let{row:{original:{alias:i}}}=e;return(0,t.jsx)(a.MenuItem,{onClick:()=>{J(i),B("confirm-remove")},type:"error",children:"Remove"})},selectable:!0,sortable:!0}):null}),(0,t.jsx)(o.Modal.Modal,{active:!!ej,onClickOutside:()=>B(!1),width:480,children:(0,t.jsxs)("form",{onSubmit:ej?.action,children:[(0,t.jsx)(o.Modal.Body,{children:(0,t.jsx)(o.Modal.Header,{children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:[ej?(0,t.jsx)("p",{className:"text-[20px] leading-[24px] tracking-[-0.33px] font-medium",children:ej.title}):(0,t.jsx)(c.Skeleton,{height:24,width:"100%"}),(0,t.jsx)(o.Modal.Subtitle,{children:(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:ej?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{className:"text-copy-14 text-gray-900",children:ej.description}),(0,t.jsx)("p",{className:"text-copy-14 text-gray-900",children:ej.body})]}):(0,t.jsx)(c.Skeleton,{height:80,width:"100%"})})})]})})}),(0,t.jsxs)(o.Modal.Actions,{children:[(0,t.jsx)(o.Modal.Action,{onClick:()=>B(!1),type:"secondary",children:"Cancel"}),ej?(0,t.jsx)(o.Modal.Action,{buttonType:"submit",loading:U||!ej,type:"warning",children:ej.actionTitle}):(0,t.jsx)(c.Skeleton,{height:40,width:50})]})]})})]})}function M(){return(0,t.jsx)(P.default,{height:170})}function O(){return(0,t.jsx)(i.Suspense,{fallback:(0,t.jsx)(M,{}),children:(0,t.jsx)(_,{})})}e.s(["DeploymentProtectionExceptions",()=>O],7912)},1131172,e=>{"use strict";var t=e.i(1146226),i=e.i(5169864),s=e.i(2504781),r=e.i(3500331),n=e.i(1906681),a=e.i(5468328),o=e.i(455575),l=e.i(57106),c=e.i(7957251),d=e.i(5883567),p=e.i(8042625),u=e.i(277234),h=e.i(4244280),m=e.i(7917902),x=e.i(1717203),f=e.i(7557283),y=e.i(1138941),g=e.i(6060673),j=e.i(5807088),v=e.i(185801),b=e.i(9367781),I=e.i(9722978);function w(){let e=(0,y.useProjectIdOrName)(),{data:i,mutate:s}=(0,g.useProject)(e),{team:r}=(0,m.useAccount)(),{can:n,isLoading:a}=(0,x.default)();return!i||a?(0,t.jsx)(P,{}):(0,t.jsx)(N,{can:n,project:i,revalidateProject:s,teamId:r?.id})}function P(){return(0,t.jsx)(j.default,{height:170})}function N(e){let{project:r,revalidateProject:c,teamId:m,can:x}=e,y=r.optionsAllowlist,[g,j]=(0,i.useState)(!!y),[w,P]=(0,i.useState)(y?.paths.map(e=>{let{value:t}=e;return{value:t,key:k(t)}})||[{value:"",key:k("")}]),[N,A]=(0,i.useState)(null),[T,S]=(0,i.useState)(!1),E=x(f.Action.Update,f.Resource.Project),D=x(f.Action.Update,f.Resource.OptionsAllowlist),R=x(f.Action.Read,f.Resource.OptionsAllowlist),_=!E||!D||!R,M=(0,i.useMemo)(()=>JSON.stringify({optionsAllowlist:g?{paths:w.map(e=>{let{value:t}=e;return{value:t}})}:null}),[g,w]),O=(0,i.useMemo)(()=>!!(g?M!==JSON.stringify({optionsAllowlist:y}):y),[g,M,y]),L=(0,i.useMemo)(()=>O?g&&0===w.length?"Must have at least one path":g&&w.some(e=>""===e.value)?"Cannot save empty paths":g&&w.some(e=>!e.value.startsWith("/"))?"Paths must start with a /":void 0:"No changes made",[g,w,O]),$=(0,i.useCallback)(async()=>{if(A(null),!L){S(!0);try{await (0,u.fetchAPI)(`${(0,h.API_PROJECTS_VERSION)("v5")}/${r.id}${(0,p.encode)({teamId:m})}`,{method:"PATCH",body:M,throwOnHTTPError:!0}),g||P([{value:"",key:k("")}]),o.toasts.success("OPTIONS Allowlist updated.")}catch(e){A(`Request failed: ${e.message}`)}await c(),S(!1)}},[r.id,m,c,M,g,L]),B=(0,i.useCallback)(()=>_?(0,t.jsxs)("p",{className:"text-copy-14 text-gray-900",children:["You need additional permissions to manage your project's"," ",(0,t.jsx)(l.Link,{external:!0,href:"/docs/security/deployment-protection/methods-to-bypass-deployment-protection/options-allowlist",type:"highlight",children:"OPTIONS Allowlist"}),"."]}):(0,t.jsxs)("p",{className:"text-copy-14 text-gray-900",children:["Learn more about"," ",(0,t.jsx)(l.Link,{external:!0,href:"/docs/security/deployment-protection/methods-to-bypass-deployment-protection/options-allowlist",type:"highlight",children:"OPTIONS Allowlist"})]}),[_]),V=(0,i.useMemo)(()=>w.length>=5?"Maximum number of paths reached":D?void 0:"Missing required permission",[w,D]),F=(0,i.useCallback)(()=>{A(null),P([...w,{value:"",key:k("")}])},[w]),H=(0,i.useCallback)(e=>{A(null),P(w.filter(t=>t.key!==e))},[w]),z=(0,i.useCallback)((e,t)=>{A(null),P(w.map(i=>i.key===e?{...i,value:t}:i))},[w]),U=(0,i.useCallback)(()=>{A(null),j(!g)},[g]),q={noPermission:D?null:"Missing required permission",noProtectionEnabled:r.ssoProtection||r.passwordProtection||r.trustedIps||y?null:"No protections currently enabled for the project."},W=q.noPermission||q.noProtectionEnabled;return(0,t.jsx)(v.ProjectSettingsFieldset,{description:(0,t.jsxs)(t.Fragment,{children:["Specify paths to be unprotected for ",(0,t.jsx)("code",{children:"OPTIONS"})," requests. This can be used to enable"," ",(0,t.jsx)(l.Link,{external:!0,href:"https://developer.mozilla.org/en-US/docs/Glossary/Preflight_request",variant:"highlight",children:"CORS preflight"})," ","requests to this project's protected deployments, as browsers do not send authentication on preflight requests. If an incoming request path"," ",(0,t.jsx)("span",{className:"text-[14px] leading-[20px] font-medium text-inherit",children:"starts with"})," ","one of the specified paths, and has the method ",(0,t.jsx)("code",{children:"OPTIONS"}),", the request will bypass deployment protection."]}),disabled:!E,disabledForBilling:_,error:N,highlightNote:!E,note:B(),onSave:$,saveDisabled:!!L,saveDisabledMessage:L,saveLoading:T,title:"OPTIONS Allowlist",headerNote:g?(0,t.jsx)(b.MicrofrontendsHelpBadge,{childHelp:"This configuration only applies to domains belonging to this project.",parentHelp:"This configuration applies to production and pre-production deployments for the group."}):null,children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:[(0,t.jsx)(a.Tooltip,{forceHide:!W,text:W,children:(0,t.jsx)(n.Toggle,{"aria-labelledby":"label-for-protection-bypass-automation-header",checked:g,direction:"switch-first",disabled:!!W,onChange:U,size:"large",children:(0,t.jsx)("p",{className:(0,I.default)("text-[14px] leading-[20px] font-medium",W?"text-gray-900":""),id:"label-for-protection-bypass-automation-header",children:g?"Enabled":"Disabled"})})}),g?(0,t.jsxs)(t.Fragment,{children:[w.map(e=>(0,t.jsx)(C,{canRemove:w.length>1&&D,onChange:t=>z(e.key,t),onRemove:()=>H(e.key),path:e},e.key)),(0,t.jsx)(a.Tooltip,{style:{alignSelf:"flex-start"},text:V,children:(0,t.jsx)(s.Button,{disabled:!!V,onClick:F,prefix:(0,t.jsx)(d.PlusCircle,{}),size:"small",style:{alignSelf:"flex-start"},type:"secondary",children:"Add path"})})]}):null]})})}function C(e){let{path:i,onRemove:n,canRemove:a,onChange:o}=e;return(0,t.jsxs)("div",{className:"flex flex-row items-stretch justify-start gap-2 flex-initial",children:[(0,t.jsx)(r.Input,{"aria-labelledby":"path input",defaultValue:i.value,onChange:e=>o(e.target.value),placeholder:"/api",width:"100%"}),(0,t.jsx)(s.Button,{"aria-label":"Remove",disabled:!a,onClick:n,shape:"square",svgOnly:!0,type:"secondary",children:(0,t.jsx)(c.MinusCircle,{})})]})}function k(e){return`${e}-${Math.random()}-${Date.now()}`}function A(){return(0,t.jsx)(i.Suspense,{fallback:(0,t.jsx)(P,{}),children:(0,t.jsx)(w,{})})}e.s(["OPTIONSAllowlist",()=>A])}]);

//# debugId=d75efa2e-381c-fd99-6568-601de68e92cd
//# sourceMappingURL=dfddcf5134267586.js.map